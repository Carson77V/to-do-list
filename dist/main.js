(()=>{"use strict";let t=[];localStorage.getItem("projectTitles")?t=localStorage.getItem("projectTitles").split(","):localStorage.setItem("projectTitles",[]);const e={getTitle(){return this.title},setTitle(t){this.title=t},getDescription(){return this.description},setDescription(t){this.description=t},getDate(){return this.date},setDate(t){this.date=t},getPriority(){return this.priority},setPriority(t){this.priority=t},getProject(){return this.project},setProject(t){this.project=t}};function n(t,e){const n=document.createElement("div");n.classList.add("task"),n.classList.add("task-span");const c=document.createElement("div"),s=document.createElement("div");c.classList.add("task-start"),s.classList.add("task-end");const i=document.createElement("span");i.classList.add("task-circle"),i.addEventListener("click",(t=>{!function(t){const e=t.srcElement.parentElement.parentElement,n=e.querySelector(".task-title"),c=e.querySelector(".task-date"),s=function(t,e){const n=[];for(let e=0;e<r.length;e++)r[e].getTitle()===t&&n.push(e);const c=[];for(let t=0;t<n.length;t++)r[n[t]].getDate()==e&&c.push(n[t]);if("All"==o)return c[0];for(let t=0;t<c.length;t++)if(r[c[0]].getProject()===o)return c[t]}(n.textContent,c.textContent);r.splice(s,1),e.remove()}(t)}));const l=document.createElement("div");l.classList.add("task-title"),l.textContent=t;const d=document.createElement("div");d.classList.add("task-date"),d.textContent=e;const a=document.createElement("img");return a.src="images/edit.svg",a.setAttribute("alt","edit button"),s.appendChild(d),s.appendChild(a),c.appendChild(i),c.appendChild(l),n.appendChild(c),n.appendChild(s),n}function c(t){const e=document.createElement("option");return e.textContent=t,e.setAttribute("value",t),e}let r=[];const s=document.querySelector(".add-task");function i(t){document.querySelectorAll(".task-span").forEach((t=>{t.remove()}));const e=r.filter((e=>"Today"==t?function(t){const e=new Date,n=t.split("-");return n[0]<e.getFullYear()||n[1]<e.getMonth()||n[2]<=e.getDate()}(e.getDate()):"Important"==t?1==e.getPriority():"All"==t||e.getProject()==t)),c=document.querySelector(".add-task"),s=document.querySelector("#tasks");e.forEach((t=>{const e=n(t.getTitle(),t.getDate());s.insertBefore(e,c)}))}s.addEventListener("click",(()=>{document.querySelector("#tasks").insertBefore(function(t,n,s,l){const d=document.createElement("div");d.classList.add("task-span"),d.classList.add("task-form");const a=document.createElement("form");a.setAttribute("action",""),a.setAttribute("method","post");const u=document.createElement("div");u.classList.add("top-form-task");const m=document.createElement("input");m.setAttribute("type","text"),m.setAttribute("id","title-edit"),m.setAttribute("placeholder","Title"),m.setAttribute("name","title-edit"),m.setAttribute("maxlength","20"),m.value=t;const p=document.createElement("div"),h=document.createElement("label");h.textContent="Date: ",h.setAttribute("for","date");const E=document.createElement("input");E.setAttribute("type","date"),E.setAttribute("id","date"),E.setAttribute("name","date"),E.value=n,p.appendChild(h),p.appendChild(E),u.appendChild(m),u.appendChild(p),a.appendChild(u);const C=document.createElement("div");C.classList.add("textarea-div");const v=document.createElement("textarea");v.setAttribute("placeholder","Description"),v.value=s,C.appendChild(v),a.appendChild(C);const b=document.createElement("div");b.classList.add("lower-form-task");const f=document.createElement("div"),g=document.createElement("label");g.textContent="Priority: ",g.setAttribute("for","priority");const A=document.createElement("select");A.setAttribute("name","priority"),A.setAttribute("id","priority"),A.value=l;for(let t=3;t>=1;t--)A.appendChild(c(t));f.appendChild(g),f.appendChild(A);const y=document.createElement("div"),L=document.createElement("button");L.textContent="Del",L.setAttribute("type","button");const k=document.createElement("button");return k.textContent="Save",k.setAttribute("type","button"),k.addEventListener("click",(t=>{!function(t){const n=t.srcElement.closest("form"),c=n.querySelector("#title-edit").value,s=n.querySelector("#date").value,l=n.querySelector("textarea").value,d=n.querySelector("#priority").value;r.push(((t,n,c,r,s)=>{let i=Object.create(e);return i.title=t,i.description=c,i.date=n,i.priority=r,i.project=s,i})(c,s,l,d,o)),i(o),n.parentElement.remove()}(t)})),y.appendChild(L),y.appendChild(k),b.appendChild(f),b.appendChild(y),a.appendChild(b),d.appendChild(a),d}(null,null,null,3),s)}));let o="All";document.querySelectorAll(".menu-item").forEach(m);const l=document.querySelector(".projects"),d=t;for(let t=0;t<d.length;t++)l.appendChild(a(d[t]));function a(e){const n=document.createElement("div");n.classList.add("menu-item");const c=document.createElement("div");c.textContent=e;const r=document.createElement("img");return r.setAttribute("src","./images/trash-2.svg"),r.setAttribute("alt","trash icon"),r.addEventListener("click",(e=>{!function(e){const n=t.indexOf(e);n>-1&&(t.splice(n,1),localStorage.setItem("projectTitles",t))}(e.srcElement.previousElementSibling.textContent),e.srcElement.closest(".menu-item").remove()})),n.appendChild(c),n.appendChild(r),m(n),n}function u(t){t.srcElement.closest(".menu-form").remove()}function m(t){t.addEventListener("click",(t=>{const e=document.querySelector(".menu-selected");null!=e&&e.classList.remove("menu-selected"),t.srcElement.classList.add("menu-selected"),o=t.srcElement.firstChild.textContent,i(o)}))}document.querySelector(".project-title > svg").addEventListener("click",(()=>{document.querySelector(".projects").appendChild(function(){const e=document.createElement("div");e.classList.add("menu-form");const n=document.createElement("form");n.setAttribute("action",""),n.setAttribute("method","post");const c=document.createElement("input");c.setAttribute("type","text"),c.setAttribute("id","project-title"),c.setAttribute("name","projectTitle"),c.setAttribute("maxlength","15");const r=document.createElement("div");r.classList.add("project-buttons");const s=document.createElement("button");s.classList.add("add-button"),s.setAttribute("type","button"),s.textContent="Add";const i=document.createElement("button");return i.classList.add("cancel-button"),i.setAttribute("type","button"),i.textContent="Cancel",s.addEventListener("click",(e=>{!function(e){const n=e.srcElement.closest(".menu-form"),c=n.firstChild.firstChild.value;var r;n.insertAdjacentElement("afterend",a(c)),r=c,t.push(r),localStorage.setItem("projectTitles",t),u(e)}(e)})),i.addEventListener("click",(t=>{u(t)})),r.appendChild(s),r.appendChild(i),n.appendChild(c),n.appendChild(r),e.appendChild(n),e}())}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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MEIsRUFBWUwsRUFBU0QsV0FBV0EsV0FBV2pDLE1MeEdyRCxJQUFrQnJFLEVLMEdkdUcsRUFBU00sc0JBQXNCLFdBQVlqQixFQUFlZ0IsSUwxRzVDNUcsRUs0R0w0RyxFTDNHVHBILEVBQWN5QyxLQUFLakMsR0FDbkJQLGFBQWFHLFFBQVEsZ0JBQWlCSixHSzZHdEM0RyxFQUFPNUUsRUFDWCxDQWpDUSxDQUFLQSxFQUFDLElBRVZtRixFQUFhcEYsaUJBQWlCLFNBQVVDLElBQ3BDNEUsRUFBTzVFLEVBQUMsSUFJWmlGLEVBQWUzRCxZQUFZNEQsR0FDM0JELEVBQWUzRCxZQUFZNkQsR0FHM0J6QyxFQUFLcEIsWUFBWTBELEdBQ2pCdEMsRUFBS3BCLFlBQVkyRCxHQUdqQkYsRUFBU3pELFlBQVlvQixHQUVkcUMsQ0FDWCxDQXRGd0JPLEdBQVksRyIsInNvdXJjZXMiOlsid2VicGFjazovL3RvLWRvLWxpc3QvLi9zcmMvanMtbW9kdWxlcy9wcm9qZWN0cy5qcyIsIndlYnBhY2s6Ly90by1kby1saXN0Ly4vc3JjL2pzLW1vZHVsZXMvdGFzay1vYmplY3QuanMiLCJ3ZWJwYWNrOi8vdG8tZG8tbGlzdC8uL3NyYy9qcy1tb2R1bGVzL3Rhc2stZG9tLmpzIiwid2VicGFjazovL3RvLWRvLWxpc3QvLi9zcmMvanMtbW9kdWxlcy90YXNrLWNvbnRyb2wuanMiLCJ3ZWJwYWNrOi8vdG8tZG8tbGlzdC8uL3NyYy9qcy1tb2R1bGVzL3Rhc2stZWRpdC1kb20uanMiLCJ3ZWJwYWNrOi8vdG8tZG8tbGlzdC8uL3NyYy9qcy1tb2R1bGVzL3Byb2plY3RzLWNvbnRyb2wuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gY3JlYXRlIGFycmF5IGZvciBwcm9ncmFtIHRvIHJ1biBvZmZcbmxldCBwcm9qZWN0VGl0bGVzID0gW11cblxuLy8gY2hlY2sgaWYgdGhlcmUgaXMgYW55IGxvY2Fsc3RvcmFnZSwgaWYgbm90IGNyZWF0ZSBuZXcgYXJyYXkgaW4gbG9jYWxzdG9yYWdlXG5pZiAoIWxvY2FsU3RvcmFnZS5nZXRJdGVtKCdwcm9qZWN0VGl0bGVzJykpIHtcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgncHJvamVjdFRpdGxlcycsIFtdKVxuICB9IGVsc2Uge1xuICAgIC8vIGxvYWQgbG9jYWxTdG9yYWdlIGRhdGEgaW50byBtZW1vcnlcbiAgICBwcm9qZWN0VGl0bGVzID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3Byb2plY3RUaXRsZXMnKS5zcGxpdCgnLCcpXG4gIH1cblxuZnVuY3Rpb24gYWRkVGl0bGUodGl0bGUpIHtcbiAgICBwcm9qZWN0VGl0bGVzLnB1c2godGl0bGUpXG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3Byb2plY3RUaXRsZXMnLCBwcm9qZWN0VGl0bGVzKVxufVxuXG5mdW5jdGlvbiBnZXRUaXRsZXMoKSB7XG4gICAgcmV0dXJuIHByb2plY3RUaXRsZXM7XG59XG5cbmZ1bmN0aW9uIGRlbGV0ZVRpdGxlKHRpdGxlKSB7XG4gICAgY29uc3QgaW5kZXggPSBwcm9qZWN0VGl0bGVzLmluZGV4T2YodGl0bGUpO1xuICAgIGlmIChpbmRleCA+IC0xKSB7IC8vIG9ubHkgc3BsaWNlIGFycmF5IHdoZW4gaXRlbSBpcyBmb3VuZFxuICAgICAgICBwcm9qZWN0VGl0bGVzLnNwbGljZShpbmRleCwgMSk7IC8vIDJuZCBwYXJhbWV0ZXIgbWVhbnMgcmVtb3ZlIG9uZSBpdGVtIG9ubHlcbiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3Byb2plY3RUaXRsZXMnLCBwcm9qZWN0VGl0bGVzKVxuICAgIH1cbn1cblxuZXhwb3J0IHthZGRUaXRsZSwgZ2V0VGl0bGVzLCBkZWxldGVUaXRsZX07XG4iLCIvLyBmYWN0b3J5IGZ1bmN0aW9uIHVzZWQgdG8gY29uc3RydWN0IHRhc2sgb2JqZWN0XG5leHBvcnQgY29uc3QgdGFzayA9ICh0aXRsZSwgZGF0ZSwgZGVzY3JpcHRpb24sIHByaW9yaXR5LCBwcm9qZWN0KSA9PiB7XG4gICAgbGV0IG9iaiA9IE9iamVjdC5jcmVhdGUodGFza1Byb3RvKVxuICAgIG9iai50aXRsZSA9IHRpdGxlXG4gICAgb2JqLmRlc2NyaXB0aW9uID0gZGVzY3JpcHRpb25cbiAgICBvYmouZGF0ZSA9IGRhdGVcbiAgICBvYmoucHJpb3JpdHkgPSBwcmlvcml0eVxuICAgIC8vIHZhcmlhYmxlIHVzZWQgdG8gZGV0ZXJtaW5lIHdoYXQgcHJvamVjdCB0aGUgdGFzayBpcyBpblxuICAgIG9iai5wcm9qZWN0ID0gcHJvamVjdFxuICAgIHJldHVybiBvYmpcbn1cblxuLy9HcmVhdCBwcm90b3R5cGUgZm9yIHRhc2soKSB0byBzdG9yZSBhbGwgdGhlIG1ldGhvZHMgZm9yIHByb2dyYW0gdG8gcnVuIGZhc3RlclxuY29uc3QgdGFza1Byb3RvID0ge1xuICAgIC8vIGNyZWF0ZSBhbGwgZ2V0dGVycyBhbmQgc2V0dGVycyAob25seSBmb3IgbWVtb3J5IHVzZSlcbiAgICBnZXRUaXRsZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudGl0bGVcbiAgICB9LFxuICAgIHNldFRpdGxlKHRpdGxlKSB7XG4gICAgICAgIHRoaXMudGl0bGUgPSB0aXRsZVxuICAgIH0sXG4gICAgZ2V0RGVzY3JpcHRpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRlc2NyaXB0aW9uXG4gICAgfSxcbiAgICBzZXREZXNjcmlwdGlvbihkZXNjcmlwdGlvbikge1xuICAgICAgICB0aGlzLmRlc2NyaXB0aW9uID0gZGVzY3JpcHRpb25cbiAgICB9LFxuICAgIGdldERhdGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRhdGVcbiAgICB9LFxuICAgIHNldERhdGUoZGF0ZSkge1xuICAgICAgICB0aGlzLmRhdGUgPSBkYXRlXG4gICAgfSxcbiAgICBnZXRQcmlvcml0eSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpb3JpdHlcbiAgICB9LFxuICAgIHNldFByaW9yaXR5KHByaW9yaXR5KSB7XG4gICAgICAgIHRoaXMucHJpb3JpdHkgPSBwcmlvcml0eVxuICAgIH0sXG4gICAgZ2V0UHJvamVjdCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJvamVjdFxuICAgIH0sXG4gICAgc2V0UHJvamVjdChwcm9qZWN0KSB7XG4gICAgICAgIHRoaXMucHJvamVjdCA9IHByb2plY3RcbiAgICB9XG59XG5cbiIsImltcG9ydCB7IGRlbFRhc2sgfSBmcm9tIFwiLi90YXNrLWNvbnRyb2wuanNcIlxuXG4vLyBmdW5jdGlvbiB0aGF0IHJldHVybnMgYSB0YXNrIGZvciB0aGUgRE9NXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBjcmVhdGVUYXNrICh0aXRsZSwgZGF0ZSkge1xuICAgIC8vY3JlYXRlIGRlZmF1bHQgZGl2IHRvIGhvbGQgYWxsIHRoZSBpbmZvXG4gICAgY29uc3QgdGFza0RpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG4gICAgdGFza0Rpdi5jbGFzc0xpc3QuYWRkKCd0YXNrJylcbiAgICB0YXNrRGl2LmNsYXNzTGlzdC5hZGQoJ3Rhc2stc3BhbicpXG5cbiAgICAvL2NyZWF0ZSB0d28gaGFsdmVzIGZvciB0aGUgZGl2IFxuICAgIGNvbnN0IHRhc2tTdGFydCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG4gICAgY29uc3QgdGFza0VuZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG4gICAgdGFza1N0YXJ0LmNsYXNzTGlzdC5hZGQoJ3Rhc2stc3RhcnQnKVxuICAgIHRhc2tFbmQuY2xhc3NMaXN0LmFkZCgndGFzay1lbmQnKVxuXG4gICAgLy9jcmVhdGUgYnV0dG9uIHRvIGNvbXBsZXRlIHRhc2tcbiAgICBjb25zdCBjaGVja0J1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKVxuICAgIGNoZWNrQnV0dG9uLmNsYXNzTGlzdC5hZGQoJ3Rhc2stY2lyY2xlJylcbiAgICBjaGVja0J1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7ZGVsVGFzayhlKX0pXG5cbiAgICAvL2NyZWF0ZSBkaXYgdG8gaG9sZCB0aXRsZSBvZiB0YXNrXG4gICAgY29uc3QgdGFza1RpdGxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcbiAgICB0YXNrVGl0bGUuY2xhc3NMaXN0LmFkZCgndGFzay10aXRsZScpXG4gICAgdGFza1RpdGxlLnRleHRDb250ZW50ID0gdGl0bGVcblxuICAgIC8vY3JlYXRlIGRpdiB0byBob2xkIHRoZSBkYXRlXG4gICAgY29uc3QgdGFza0RhdGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuICAgIHRhc2tEYXRlLmNsYXNzTGlzdC5hZGQoJ3Rhc2stZGF0ZScpXG4gICAgdGFza0RhdGUudGV4dENvbnRlbnQgPSBkYXRlXG5cbiAgICAvL2NyZWF0ZSB0aGUgZWRpdCBidXR0b24vaW1nXG4gICAgY29uc3QgZWRpdEJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2ltZycpXG4gICAgZWRpdEJ1dHRvbi5zcmMgPSAnaW1hZ2VzL2VkaXQuc3ZnJ1xuICAgIGVkaXRCdXR0b24uc2V0QXR0cmlidXRlKCdhbHQnLCAnZWRpdCBidXR0b24nKVxuXG4gICAgLy8gQXBwZW5kIGFsbCBlbGVtZW50cyB0b2dldGhlclxuICAgIHRhc2tFbmQuYXBwZW5kQ2hpbGQodGFza0RhdGUpXG4gICAgdGFza0VuZC5hcHBlbmRDaGlsZChlZGl0QnV0dG9uKVxuXG4gICAgdGFza1N0YXJ0LmFwcGVuZENoaWxkKGNoZWNrQnV0dG9uKVxuICAgIHRhc2tTdGFydC5hcHBlbmRDaGlsZCh0YXNrVGl0bGUpXG5cbiAgICB0YXNrRGl2LmFwcGVuZENoaWxkKHRhc2tTdGFydClcbiAgICB0YXNrRGl2LmFwcGVuZENoaWxkKHRhc2tFbmQpXG5cbiAgICByZXR1cm4gdGFza0RpdlxufSIsImltcG9ydCB7IHRhc2sgfSBmcm9tICcuL3Rhc2stb2JqZWN0LmpzJ1xuaW1wb3J0IGNyZWF0ZVRhc2sgZnJvbSAnLi90YXNrLWRvbS5qcydcbmltcG9ydCBjcmVhdGVUYXNrRWRpdCBmcm9tICcuL3Rhc2stZWRpdC1kb20uanMnXG5pbXBvcnQgeyBtZW51U2VsZWN0ZWQgYXMgbWVudVNlbGVjdGVkfSBmcm9tICcuL3Byb2plY3RzLWNvbnRyb2wuanMnXG5cbi8vIGNyZWF0ZSBhbiBhcnJheSB0byBzdG9yZSBhbGwgdGhlIHRhc2tzXG5sZXQgYWxsVGFza3MgPSBbXVxuXG4vL2FkZCBldmVudCBsaXN0ZW5lciB0byArQWRkIFRhc2sgYnV0dG9uXG5jb25zdCBhZGRUYXNrID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFkZC10YXNrJylcbmFkZFRhc2suYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgLy8gTmVlZCB0byBwdXQgYSB0YXNrLWVkaXQgYWJvdmUgK0FkZCBUYXNrXG4gICAgY29uc3QgdGFza3NEaXYgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjdGFza3MnKVxuICAgIHRhc2tzRGl2Lmluc2VydEJlZm9yZShjcmVhdGVUYXNrRWRpdChudWxsLCBudWxsLCBudWxsLCAzKSwgYWRkVGFzaylcbn0pXG5cbmV4cG9ydCBmdW5jdGlvbiByZW5kZXJUYXNrcyAobWVudVNlbGVjdGVkKSB7XG4gICAgLy8gZmlyc3QgcmVtb3ZlIHRoZSBjdXJyZW50IHRhc2tzXG4gICAgcmVtb3ZlVGFza3MoKVxuXG4gICAgLy8gY3JlYXRlIGEgbmV3IGFycmF5IHRoYXQgaG9sZHMgb25seSB0aGUgcmVxdWlyZWQgdGFza3MgZnJvbSB0aGUgcHJvamVjdFxuICAgIGNvbnN0IG5ld0FycmF5ID0gYWxsVGFza3MuZmlsdGVyKGl0ZW0gPT4ge1xuICAgICAgICBpZiAobWVudVNlbGVjdGVkID09IFwiVG9kYXlcIikge1xuICAgICAgICAgICAgcmV0dXJuIGlzRHVlVG9kYXkoaXRlbS5nZXREYXRlKCkpXG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAobWVudVNlbGVjdGVkID09IFwiSW1wb3J0YW50XCIpIHtcbiAgICAgICAgICAgIHJldHVybiBpdGVtLmdldFByaW9yaXR5KCkgPT0gMTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChtZW51U2VsZWN0ZWQgPT0gXCJBbGxcIikge3JldHVybiB0cnVlfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBpdGVtLmdldFByb2plY3QoKSA9PSBtZW51U2VsZWN0ZWQ7IFxuICAgICAgICB9XG4gICAgfSk7XG4gICAgLy8gU2VsZWN0IHRoZSBhZGQgdGFzayBcbiAgICBjb25zdCBhZGRUYXNrID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFkZC10YXNrJylcbiAgICAvLyBzZWxlY3QgdGFza3MgZGl2XG4gICAgY29uc3QgdGFza3NEaXYgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjdGFza3MnKVxuICAgIC8vbG9vcCB0aHJvdWdoIHRoZSBuZXcgYXJyYXkgYW5kIHJlbmRlciB0aGUgdGFza3NcbiAgICBuZXdBcnJheS5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICAgIC8vIGFkZCBuZXcgZWxlbWVudHMgYmVmb3JlICsgQWRkIFRhc2tcbiAgICAgICAgY29uc3QgZWxlID0gY3JlYXRlVGFzayhpdGVtLmdldFRpdGxlKCksIGl0ZW0uZ2V0RGF0ZSgpKVxuICAgICAgICB0YXNrc0Rpdi5pbnNlcnRCZWZvcmUoZWxlLCBhZGRUYXNrKVxuICAgIH0pXG59XG5cbi8vIHdoZW4gcmVuZGVyVGFza3MoKSBpcyBjYWxsZWQsIHVzZSB0aGlzIGZ1bmN0aW9uIHRvIGRlbGV0ZSB0aGUgY3VycmVudCB0YXNrc1xuZnVuY3Rpb24gcmVtb3ZlVGFza3MgKCkge1xuICAgIC8vIGNyZWF0ZSBub2RlIGxpc3RzIG9mIGFsbCBjdXJyZW50IHRhc2tzIGluIHRoZSBET01cbiAgICBjb25zdCBhbGxUYXNrcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy50YXNrLXNwYW4nKVxuICAgIC8vIHJlbW92ZSBlYWNoIHRhc2tcbiAgICBhbGxUYXNrcy5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICAgIGl0ZW0ucmVtb3ZlKClcbiAgICB9KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHNhdmUgKGUpIHtcbiAgICAvLyBnZXQgdGhlIHNyYyBlbGVtZW50IGFuZCB0aGVuIHRoZSBmb3JtIG5vZGVcbiAgICBjb25zdCBidXR0b24gPSBlLnNyY0VsZW1lbnRcbiAgICBjb25zdCBmb3JtID0gYnV0dG9uLmNsb3Nlc3QoJ2Zvcm0nKVxuICAgIC8vIGdhdGhlciBhbGwgcmVxdWlyZWQgaW5mbyB0byBidWlsZCBhIG5ldyB0YXNrIG9iamVjdFxuICAgIGNvbnN0IHRpdGxlID0gZm9ybS5xdWVyeVNlbGVjdG9yKCcjdGl0bGUtZWRpdCcpLnZhbHVlXG4gICAgY29uc3QgZGF0ZSA9IGZvcm0ucXVlcnlTZWxlY3RvcignI2RhdGUnKS52YWx1ZVxuICAgIGNvbnN0IGRlc2NyaXB0aW9uID0gZm9ybS5xdWVyeVNlbGVjdG9yKCd0ZXh0YXJlYScpLnZhbHVlXG4gICAgY29uc3QgcHJpb3JpdHkgPSBmb3JtLnF1ZXJ5U2VsZWN0b3IoJyNwcmlvcml0eScpLnZhbHVlXG4gICAgYWxsVGFza3MucHVzaCh0YXNrKHRpdGxlLCBkYXRlLCBkZXNjcmlwdGlvbiwgcHJpb3JpdHksIG1lbnVTZWxlY3RlZCkpXG4gICAgLy8gcmVuZGVyIHRoZSBuZXcgdGFza3NcbiAgICAvLyBvdGhlciB0YXNrIGZvcm0gb24gcGFnZSB3aWxsIGJlIHJlbW92ZWRcbiAgICByZW5kZXJUYXNrcyhtZW51U2VsZWN0ZWQpXG4gICAgLy8gcmVtb3ZlIHRoZSBmb3JtXG4gICAgZm9ybS5wYXJlbnRFbGVtZW50LnJlbW92ZSgpXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBkZWxUYXNrKGUpIHtcbiAgICAvLyBnZXQgdGhlIHBhcmVudCBlbGVtZW50XG4gICAgY29uc3QgcGFyZW50ID0gZS5zcmNFbGVtZW50LnBhcmVudEVsZW1lbnQucGFyZW50RWxlbWVudFxuICAgIC8vIGdldCB0aGUgdGl0bGUgYW5kIGRhdGVcbiAgICBjb25zdCB0aXRsZSA9IHBhcmVudC5xdWVyeVNlbGVjdG9yKCcudGFzay10aXRsZScpXG4gICAgY29uc3QgZGF0ZSA9IHBhcmVudC5xdWVyeVNlbGVjdG9yKCcudGFzay1kYXRlJylcbiAgICAvLyB1c2UgdGhlIGZ1bmN0aW9uIHRvIGZpbmQgdGhlIGluZGV4IG9mIHRoZSBhcnJheSB3aGVyZSB0aGUgdGFzayBpcyBzYXZlZFxuICAgIGNvbnN0IGkgPSB0YXNrU2VhcmNoKHRpdGxlLnRleHRDb250ZW50LCBkYXRlLnRleHRDb250ZW50KVxuICAgIC8vIGRlbGV0ZXMgdGhlIG9iamVjdCBmcm9tIHRoZSBhcnJheVxuICAgIGFsbFRhc2tzLnNwbGljZShpLCAxKVxuICAgIC8vIHJlbW92ZSB0aGUgZWxlbWVudCBmcm9tIHRoZSBET01cbiAgICBwYXJlbnQucmVtb3ZlKClcbn1cblxuLy8gdGhpcyBmdW5jdGlvbiB1c2VzIHRoZSB0aXRsZSBhbmQgZGF0ZSBvZiBhIHRhc2sgdG8gZmluZCBpdHMgXG4vLyBpbmRleCBpbiB0aGUgYXJyYXkgYW5kIHJldHVybnMgaXRcbmZ1bmN0aW9uIHRhc2tTZWFyY2ggKHRpdGxlLCBkYXRlKSB7XG4gICAgLy8gY3JlYXRlIGEgbmV3IGFycmF5IHRoYXQgc3RvcmVzIGFsbCBpbmRleGVzIHdpdGggc2FtZSB0aXRsZVxuICAgIGNvbnN0IGZpcnN0U29ydCA9IFtdXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhbGxUYXNrcy5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAoYWxsVGFza3NbaV0uZ2V0VGl0bGUoKSA9PT0gdGl0bGUpIHtcbiAgICAgICAgICAgIGZpcnN0U29ydC5wdXNoKGkpXG4gICAgICAgIH1cbiAgICB9XG4gICAgLy8gcmVwZWF0IHByb2Nlc3MgdG8gbmFycm93IGRvd24gaW5kZXhlcyBiYXNlZCBvZmYgb2YgZGF0ZVxuICAgIGNvbnN0IHNlY29uZFNvcnQgPSBbXVxuICAgIC8vIGhhdmUgdG8gc29ydCB0aHJvdWdoIGZpcnN0U29ydFtdIHRvIGZpbmQgYWxsIHRoZSBpbmRleGVzXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBmaXJzdFNvcnQubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKGFsbFRhc2tzW2ZpcnN0U29ydFtpXV0uZ2V0RGF0ZSgpID09IGRhdGUpIHtcbiAgICAgICAgICAgIC8vIGFwcGVuZCB0aG9zZSBpbmRleGVzIHRvIHNlY29uZFNvcnRbXVxuICAgICAgICAgICAgc2Vjb25kU29ydC5wdXNoKGZpcnN0U29ydFtpXSlcbiAgICAgICAgfVxuICAgIH1cbiAgICAvLyB1c2luZyBzZWNvbmRTb3J0IGZpbmQgdGhlIHRhc2sgd2l0aCBhIFByb2plY3QgdGhhdCBtYXRjaGVzIG1lbnUgc2VsZWN0ZWRcbiAgICAvLyByZXR1cm4gdGhlIGluZGV4XG4gICAgaWYgKG1lbnVTZWxlY3RlZCAhPSAnQWxsJykge1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNlY29uZFNvcnQubGVuZ3RoOyBpKyspe1xuICAgICAgICAgICAgaWYgKGFsbFRhc2tzW3NlY29uZFNvcnRbMF1dLmdldFByb2plY3QoKSA9PT0gbWVudVNlbGVjdGVkKXtcbiAgICAgICAgICAgICAgICByZXR1cm4gc2Vjb25kU29ydFtpXVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIC8vIGlmIHRoZXJlIGFyZSBtdWx0aXBsZXMgaW4gJ0FsbCcsIHJldHVybiB0aGUgaW5kZXggdG8gdGhlIGZpcnN0IHRhc2tcbiAgICBlbHNlIHtcbiAgICAgICAgcmV0dXJuIHNlY29uZFNvcnRbMF1cbiAgICB9XG59XG5cbi8vIGZ1bmN0aW4gcmV0dXJucyB0cnVlIGlmIHRoZSBkdWUgZGF0ZSBpcyB0b2RheSBvciBmcm9tIHRoZSBwYXN0XG5mdW5jdGlvbiBpc0R1ZVRvZGF5IChkYXRlKSB7XG4gICAgLy8gY3JlYXRlIHRvZGF5J3MgZGF0ZVxuICAgIGNvbnN0IHRvZGF5ID0gbmV3IERhdGUoKVxuICAgIC8vIHNwbGl0IHRoZSBkYXRlIGZyb20gdGhlIHRhc2sgaW50byBhIG5ldyBhcnJheVxuICAgIGNvbnN0IGN1cnJlbnREYXRlcyA9IGRhdGUuc3BsaXQoJy0nKVxuICAgIC8vIGlmIHRoZSB5ZWFyIGlzIGxlc3MgdGhhbiBjdXJyZW50IHllYXIgcmV0dXJuIHRydWVcbiAgICBpZiAoY3VycmVudERhdGVzWzBdIDwgdG9kYXkuZ2V0RnVsbFllYXIoKSkgcmV0dXJuIHRydWU7XG4gICAgLy8gaWYgbW9udGggaXMgbW9udGggaXMgbGVzcyB0aGFuIGN1cnJlbnQgcmV0dXJuIHRydWVcbiAgICBpZiAoY3VycmVudERhdGVzWzFdIDwgdG9kYXkuZ2V0TW9udGgoKSkgcmV0dXJuIHRydWU7XG4gICAgLy8gaWYgZGF5IGlzIGxlc3MgdGhhbiBvciBlcXVhbCB0byBjdXJyZW50IGRheSByZXR1cm4gdHJ1ZVxuICAgIGlmIChjdXJyZW50RGF0ZXNbMl0gPD0gdG9kYXkuZ2V0RGF0ZSgpKSByZXR1cm4gdHJ1ZTtcblxuICAgIHJldHVybiBmYWxzZVxufSIsImltcG9ydCB7IHNhdmUgfSBmcm9tICcuL3Rhc2stY29udHJvbC5qcydcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gY3JlYXRlVGFza0VkaXQgKHRpdGxlLCBkYXRlLCBkZXNjcmlwdGlvbiwgcHJpb3JpdHkpIHtcbiAgICAvL2NyZWF0ZSBkaXYgdG8gaG9sZCBhbGwgdGhlIGVsZW1lbnRzXG4gICAgY29uc3QgdGFza0Zvcm0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuICAgIHRhc2tGb3JtLmNsYXNzTGlzdC5hZGQoJ3Rhc2stc3BhbicpXG4gICAgdGFza0Zvcm0uY2xhc3NMaXN0LmFkZCgndGFzay1mb3JtJylcblxuICAgIC8vY3JlYXRlIHRoZSBmb3JtIFxuICAgIGNvbnN0IGZvcm0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdmb3JtJylcbiAgICBmb3JtLnNldEF0dHJpYnV0ZSgnYWN0aW9uJywgJycpXG4gICAgZm9ybS5zZXRBdHRyaWJ1dGUoJ21ldGhvZCcsICdwb3N0JylcblxuICAgIC8vc3RhcnQgYnkgY3JlYXRpbmcgZWxlbWVudHMgZm9yIHRoZSB0b3Agb2YgdGhlIGZvcm1cbiAgICAvL3RoZSB0aXRsZSBhbmQgZGF0ZSBhcmUgaW5sY3VkZWQgaGVyZVxuICAgIGNvbnN0IHRvcEVkaXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuICAgIHRvcEVkaXQuY2xhc3NMaXN0LmFkZCgndG9wLWZvcm0tdGFzaycpXG5cbiAgICAvL2lucHV0IGZvciB0aGUgdGl0bGVcbiAgICBjb25zdCBlZGl0VGl0bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpXG4gICAgZWRpdFRpdGxlLnNldEF0dHJpYnV0ZSgndHlwZScsICd0ZXh0JylcbiAgICBlZGl0VGl0bGUuc2V0QXR0cmlidXRlKCdpZCcsICd0aXRsZS1lZGl0JylcbiAgICBlZGl0VGl0bGUuc2V0QXR0cmlidXRlKCdwbGFjZWhvbGRlcicsICdUaXRsZScpXG4gICAgZWRpdFRpdGxlLnNldEF0dHJpYnV0ZSgnbmFtZScsICd0aXRsZS1lZGl0JylcbiAgICBlZGl0VGl0bGUuc2V0QXR0cmlidXRlKCdtYXhsZW5ndGgnLCAnMjAnKVxuICAgIGVkaXRUaXRsZS52YWx1ZSA9IHRpdGxlIC8vVE8gRE9cblxuICAgIC8vaW5wdXQgZm9yIHRoZSBkYXRlXG4gICAgY29uc3QgZGF0ZURpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG4gICAgY29uc3QgZGF0ZUxhYmVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGFiZWwnKVxuICAgIGRhdGVMYWJlbC50ZXh0Q29udGVudCA9ICdEYXRlOiAnXG4gICAgZGF0ZUxhYmVsLnNldEF0dHJpYnV0ZSgnZm9yJywgJ2RhdGUnKVxuICAgICBcbiAgICBjb25zdCBpbnB1dERhdGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpXG4gICAgaW5wdXREYXRlLnNldEF0dHJpYnV0ZSgndHlwZScsICdkYXRlJylcbiAgICBpbnB1dERhdGUuc2V0QXR0cmlidXRlKCdpZCcsICdkYXRlJylcbiAgICBpbnB1dERhdGUuc2V0QXR0cmlidXRlKCduYW1lJywgJ2RhdGUnKVxuICAgIGlucHV0RGF0ZS52YWx1ZSA9IGRhdGUgLy9UTyBET1xuXG4gICAgLy9hcHBlbmQgdGhlIHRvcCB0b2dldGhlciBhbmQgYWRkIGl0IHRvIHRoZSBmdWxsIGZvcm1cbiAgICBkYXRlRGl2LmFwcGVuZENoaWxkKGRhdGVMYWJlbClcbiAgICBkYXRlRGl2LmFwcGVuZENoaWxkKGlucHV0RGF0ZSlcblxuICAgIHRvcEVkaXQuYXBwZW5kQ2hpbGQoZWRpdFRpdGxlKVxuICAgIHRvcEVkaXQuYXBwZW5kQ2hpbGQoZGF0ZURpdilcblxuICAgIGZvcm0uYXBwZW5kQ2hpbGQodG9wRWRpdClcblxuICAgIC8vY3JlYXRlIHRoZSB0ZXh0YXJlYVxuICAgIGNvbnN0IHRleHRBcmVhRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcbiAgICB0ZXh0QXJlYURpdi5jbGFzc0xpc3QuYWRkKCd0ZXh0YXJlYS1kaXYnKVxuXG4gICAgY29uc3QgdGV4dEFyZWEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZXh0YXJlYScpXG4gICAgdGV4dEFyZWEuc2V0QXR0cmlidXRlKCdwbGFjZWhvbGRlcicsICdEZXNjcmlwdGlvbicpXG4gICAgdGV4dEFyZWEudmFsdWUgPSBkZXNjcmlwdGlvbiAvL1RPIERPIFxuXG4gICAgdGV4dEFyZWFEaXYuYXBwZW5kQ2hpbGQodGV4dEFyZWEpXG4gICAgZm9ybS5hcHBlbmRDaGlsZCh0ZXh0QXJlYURpdilcblxuICAgIC8vY3JlYXRlIHRoZSBib3R0b20gb2YgdGhlIGZvcm1cbiAgICBjb25zdCBsb3dlckRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG4gICAgbG93ZXJEaXYuY2xhc3NMaXN0LmFkZCgnbG93ZXItZm9ybS10YXNrJylcblxuICAgIGNvbnN0IGVuY29tcGFzRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcblxuICAgIGNvbnN0IHByaW9yaXR5TGFiZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsYWJlbCcpXG4gICAgcHJpb3JpdHlMYWJlbC50ZXh0Q29udGVudCA9ICdQcmlvcml0eTogJ1xuICAgIHByaW9yaXR5TGFiZWwuc2V0QXR0cmlidXRlKCdmb3InLCAncHJpb3JpdHknKVxuXG4gICAgY29uc3QgcHJpb3JpdHlTZWxlY3QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzZWxlY3QnKVxuICAgIHByaW9yaXR5U2VsZWN0LnNldEF0dHJpYnV0ZSgnbmFtZScsICdwcmlvcml0eScpXG4gICAgcHJpb3JpdHlTZWxlY3Quc2V0QXR0cmlidXRlKCdpZCcsICdwcmlvcml0eScpXG4gICAgcHJpb3JpdHlTZWxlY3QudmFsdWUgPSBwcmlvcml0eSAvL1RPIERPXG5cbiAgICAvL3VzZSBhIGxvb3AgdG8gYWRkIDMgb3B0aW9ucyB0byB0aGUgRE9NXG4gICAgZm9yIChsZXQgaSA9IDM7IGkgPj0gMTsgaS0tKSB7XG4gICAgICAgIC8vdXNlIGEgZnVuY3Rpb24gdG8gcmV0dXJuIHRoZSBET00gb3B0aW9uIGVsZW1lbnRcbiAgICAgICAgcHJpb3JpdHlTZWxlY3QuYXBwZW5kQ2hpbGQoY3JlYXRlT3B0aW9uKGkpKVxuICAgIH1cblxuICAgIC8vYXBwZW5kIHRoZSBwcmlvcml0eSBlbGVtZW50cyB0byB0aGUgZGl2XG4gICAgZW5jb21wYXNEaXYuYXBwZW5kQ2hpbGQocHJpb3JpdHlMYWJlbClcbiAgICBlbmNvbXBhc0Rpdi5hcHBlbmRDaGlsZChwcmlvcml0eVNlbGVjdClcblxuICAgIC8vIGNyZWF0ZSB0aGUgU2F2ZSBhbmQgRGVsZXRlIGJ1dHRvbnMgaW4gdGhlaXIgb3duIGRpdlxuICAgIGNvbnN0IGJ1dHRvbkRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG5cbiAgICBjb25zdCBkZWxCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKVxuICAgIGRlbEJ1dHRvbi50ZXh0Q29udGVudCA9ICdEZWwnXG4gICAgZGVsQnV0dG9uLnNldEF0dHJpYnV0ZSgndHlwZScsICdidXR0b24nKVxuXG4gICAgY29uc3Qgc2F2ZUJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpXG4gICAgc2F2ZUJ1dHRvbi50ZXh0Q29udGVudCA9ICdTYXZlJ1xuICAgIHNhdmVCdXR0b24uc2V0QXR0cmlidXRlKCd0eXBlJywgJ2J1dHRvbicpXG4gICAgc2F2ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7c2F2ZShlKX0pXG5cbiAgICBidXR0b25EaXYuYXBwZW5kQ2hpbGQoZGVsQnV0dG9uKVxuICAgIGJ1dHRvbkRpdi5hcHBlbmRDaGlsZChzYXZlQnV0dG9uKVxuXG4gICAgLy8gYXBwZW5kIHRoZSBsb3dlciBlbGVtZW50cyBcbiAgICBsb3dlckRpdi5hcHBlbmRDaGlsZChlbmNvbXBhc0RpdilcbiAgICBsb3dlckRpdi5hcHBlbmRDaGlsZChidXR0b25EaXYpXG4gICAgLy9hcHBlbmQgdGhlIGxvd2VyIGRpdiB0byB0aGUgZm9ybVxuICAgIGZvcm0uYXBwZW5kQ2hpbGQobG93ZXJEaXYpXG4gICAgLy9hcHBlbmQgZm9ybSB0byB0aGUgdGFzayBkaXZcbiAgICB0YXNrRm9ybS5hcHBlbmRDaGlsZChmb3JtKVxuXG4gICAgcmV0dXJuIHRhc2tGb3JtXG59XG5cbi8vIGNyZWF0ZXMgb3B0aW9ucyBmb3IgdGhlIHByaW9yaXR5IGVsZW1lbnRcbmZ1bmN0aW9uIGNyZWF0ZU9wdGlvbiAoaSkge1xuICAgIGNvbnN0IG9wdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ29wdGlvbicpXG4gICAgb3B0aW9uLnRleHRDb250ZW50ID0gaVxuICAgIG9wdGlvbi5zZXRBdHRyaWJ1dGUoJ3ZhbHVlJywgaSlcbiAgICByZXR1cm4gb3B0aW9uXG59XG5cbiIsImltcG9ydCB7IGFkZFRpdGxlLCBnZXRUaXRsZXMsIGRlbGV0ZVRpdGxlfSBmcm9tIFwiLi9wcm9qZWN0c1wiXG5pbXBvcnQgeyByZW5kZXJUYXNrcyB9IGZyb20gXCIuL3Rhc2stY29udHJvbC5qc1wiXG5cbi8vIHZhcmlhYmxlIHVzZWQgdG8ga2VlcCB0cmFjayBvZiB3aGljaCBtZW51IGl0ZW0gaXMgc2VsZWN0ZWRcbmV4cG9ydCBsZXQgbWVudVNlbGVjdGVkID0gJ0FsbCdcblxuLy9BZGQgZXZlbnRzIHRvIHRoZSBkZWZhdWx0IG1lbnUgb3B0aW9uc1xuY29uc3QgbWVudUl0ZW1zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLm1lbnUtaXRlbScpXG5tZW51SXRlbXMuZm9yRWFjaChhZGRNZW51SXRlbUV2ZW50KVxuXG4vLyBMb2FkIGxvY2FsU3RvcmFnZSBkYXRhIGludG8gdGhlIERPTVxuY29uc3QgbWVudVRpdGxlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9qZWN0cycpXG5jb25zdCBhcnJheSA9IGdldFRpdGxlcygpXG5mb3IgKGxldCBpID0gMDsgaSA8IGFycmF5Lmxlbmd0aDsgaSsrKSB7XG4gICAgbWVudVRpdGxlcy5hcHBlbmRDaGlsZChjcmVhdGVNZW51SXRlbShhcnJheVtpXSkpXG59XG5cbi8vIEV2ZW50IGxpc3RlbmVyIGZvciB0aGUgXCIrXCIgYnV0dG9uIGJlc2lkZSBwcm9qZWN0IHRpdGxlXG5jb25zdCBwbHVzQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2plY3QtdGl0bGUgPiBzdmcnKVxucGx1c0J1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAvL0NhbGxzIGZ1bmN0aW9uIHRvIGFkZCB0aGUgcHJvamVjdCBmb3JtIHRvIHRoZSBET01cbiAgICBjb25zdCBwcm9qZWN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2plY3RzJylcbiAgICBwcm9qZWN0LmFwcGVuZENoaWxkKGNyZWF0ZUZvcm0oKSlcblxufSlcblxuLy8gUmV0dXJucyB0aGUgRE9NIGVsZW1lbnQgb2YgYSBtZW51LWl0ZW0gXG4vLyBhIHNpbXBsZSBwcm9qZWN0IGlzIGFkZGVkIHRvIHRoZSBsaXN0IG9uIHRoZSBET01cbmZ1bmN0aW9uIGNyZWF0ZU1lbnVJdGVtKHRpdGxlKSB7XG4gICAgLy8gIGNyZWF0ZSB0aGUgbWVudS1pdGVtIGRpdiB0byBob2xkIHRoZSBlbGVtZW50c1xuICAgIGNvbnN0IGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG4gICAgZGl2LmNsYXNzTGlzdC5hZGQoJ21lbnUtaXRlbScpXG4gICAgLy8gY3JlYXRlIHRoZSB0aXRsZSBkaXZcbiAgICBjb25zdCB0aXRsZURpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG4gICAgdGl0bGVEaXYudGV4dENvbnRlbnQgPSB0aXRsZVxuICAgIC8vIGNyZWF0ZSB0aGUgdHJhc2ggYmluIGltZ1xuICAgIGNvbnN0IHRyYXNoID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW1nJylcbiAgICB0cmFzaC5zZXRBdHRyaWJ1dGUoJ3NyYycsICcuL2ltYWdlcy90cmFzaC0yLnN2ZycpXG4gICAgdHJhc2guc2V0QXR0cmlidXRlKCdhbHQnLCAndHJhc2ggaWNvbicpXG5cbiAgICAvLyBhZGQgZXZlbnRsaXN0ZW5lciB0byB0cmFzaCBpY29uXG4gICAgdHJhc2guYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xuICAgICAgICBkZWxldGVUaXRsZShlLnNyY0VsZW1lbnQucHJldmlvdXNFbGVtZW50U2libGluZy50ZXh0Q29udGVudClcbiAgICAgICAgZS5zcmNFbGVtZW50LmNsb3Nlc3QoJy5tZW51LWl0ZW0nKS5yZW1vdmUoKVxuICAgIH0pXG5cbiAgICAvLyBhcHBlbmQgdGhlIHR3byBjaGlsZHJlblxuICAgIGRpdi5hcHBlbmRDaGlsZCh0aXRsZURpdilcbiAgICBkaXYuYXBwZW5kQ2hpbGQodHJhc2gpXG5cbiAgICBhZGRNZW51SXRlbUV2ZW50KGRpdilcbiAgICBcbiAgICByZXR1cm4gZGl2XG59XG5cbi8vIHJldHVybnMgYSBmb3JtIGZvciBET00gdG8gYmUgdXNlZCB0byBjcmVhdGUgYSBuZXcgcHJvamVjdFxuZnVuY3Rpb24gY3JlYXRlRm9ybSgpIHtcbiAgICAvLyBjcmVhdGUgdGhlIGRpdiB0aGF0IGVuY29tcGFzc2VzIHRoZSBlbnRpcmUgYmxvY2tcbiAgICBjb25zdCBtZW51Rm9ybSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG4gICAgbWVudUZvcm0uY2xhc3NMaXN0LmFkZCgnbWVudS1mb3JtJylcblxuICAgIC8vIGNyZWF0ZSB0aGUgZm9ybSBhbmQgYWRkIGF0dHJpYnV0ZXNcbiAgICBjb25zdCBmb3JtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZm9ybScpXG4gICAgZm9ybS5zZXRBdHRyaWJ1dGUoJ2FjdGlvbicsIFwiXCIpXG4gICAgZm9ybS5zZXRBdHRyaWJ1dGUoJ21ldGhvZCcsICdwb3N0JylcblxuICAgIC8vIGNyZWF0ZSB0aGUgaW5wdXQgYm94IGZvciB0ZXh0XG4gICAgY29uc3QgaW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpXG4gICAgaW5wdXQuc2V0QXR0cmlidXRlKCd0eXBlJywgJ3RleHQnKVxuICAgIGlucHV0LnNldEF0dHJpYnV0ZSgnaWQnLCAncHJvamVjdC10aXRsZScpXG4gICAgaW5wdXQuc2V0QXR0cmlidXRlKCduYW1lJywgJ3Byb2plY3RUaXRsZScpXG4gICAgaW5wdXQuc2V0QXR0cmlidXRlKCdtYXhsZW5ndGgnLCAnMTUnKVxuXG4gICAgLy8gY3JlYXRlIGRpdiB0byBlbmNvbXBhc3MgYnV0dG9uc1xuICAgIGNvbnN0IHByb2plY3RCdXR0b25zID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcbiAgICBwcm9qZWN0QnV0dG9ucy5jbGFzc0xpc3QuYWRkKCdwcm9qZWN0LWJ1dHRvbnMnKVxuXG4gICAgLy9jcmVhdGUgdGhlIGJ1dHRvbnNcbiAgICBjb25zdCBhZGRCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKVxuICAgIGFkZEJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdhZGQtYnV0dG9uJylcbiAgICBhZGRCdXR0b24uc2V0QXR0cmlidXRlKCd0eXBlJywgJ2J1dHRvbicpXG4gICAgYWRkQnV0dG9uLnRleHRDb250ZW50ID0gXCJBZGRcIlxuXG4gICAgY29uc3QgY2FuY2VsQnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJylcbiAgICBjYW5jZWxCdXR0b24uY2xhc3NMaXN0LmFkZCgnY2FuY2VsLWJ1dHRvbicpXG4gICAgY2FuY2VsQnV0dG9uLnNldEF0dHJpYnV0ZSgndHlwZScsICdidXR0b24nKVxuICAgIGNhbmNlbEJ1dHRvbi50ZXh0Q29udGVudCA9IFwiQ2FuY2VsXCJcblxuICAgIC8vIGFkZCBldmVudGxpc3RlbmVyc1xuICAgIGFkZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XG4gICAgICAgIHNhdmUoZSlcbiAgICB9KVxuICAgIGNhbmNlbEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XG4gICAgICAgIGNhbmNlbChlKVxuICAgIH0pXG5cbiAgICAvLyBBcHBlbmQgdGhlIGJ1dHRvbnMgdG8gcHJvamVjdEJ1dHRvbnNcbiAgICBwcm9qZWN0QnV0dG9ucy5hcHBlbmRDaGlsZChhZGRCdXR0b24pXG4gICAgcHJvamVjdEJ1dHRvbnMuYXBwZW5kQ2hpbGQoY2FuY2VsQnV0dG9uKVxuXG4gICAgLy8gQXBwZW5kIGlucHV0IHRvIGZvcm0gdGhlbiBwcm9qZWN0QnV0dG9ucyB0byBmb3JtXG4gICAgZm9ybS5hcHBlbmRDaGlsZChpbnB1dClcbiAgICBmb3JtLmFwcGVuZENoaWxkKHByb2plY3RCdXR0b25zKVxuXG4gICAgLy8gYXBwZW5kIGZvcm0gdG8gdGhlIG1haW4gZGl2IChtZW51Rm9ybSlcbiAgICBtZW51Rm9ybS5hcHBlbmRDaGlsZChmb3JtKVxuXG4gICAgcmV0dXJuIG1lbnVGb3JtXG59XG5cbmZ1bmN0aW9uIHNhdmUoZSkge1xuICAgIC8vIHNlbGVjdCB0aGUgbWVudS1mb3JtIHBhcmVudCBub2RlXG4gICAgY29uc3QgbWVudUZvcm0gPSBlLnNyY0VsZW1lbnQuY2xvc2VzdCgnLm1lbnUtZm9ybScpXG4gICAgLy8gc2VsZWN0IHRoZSBjaGlsZCBvZiBtZW51LWZvcm0gYW5kIHRoZSBjaGlsZCBvZiB0aGF0IHRvIGFxdWlyZSB0aGUgaW5wdXQgbm9kZS5cbiAgICAvLyBUYWtlIHRoZSB2YWx1ZSBvZiB0aGUgaW5wdXQgbm9kZVxuICAgIGNvbnN0IGlucHV0VGV4dCA9IG1lbnVGb3JtLmZpcnN0Q2hpbGQuZmlyc3RDaGlsZC52YWx1ZVxuICAgIC8vIGluc2VydCBhIG5ldyBtZW51IGl0ZW0gYWZ0ZXIgdGhlIGZvcm1cbiAgICBtZW51Rm9ybS5pbnNlcnRBZGphY2VudEVsZW1lbnQoJ2FmdGVyZW5kJywgY3JlYXRlTWVudUl0ZW0oaW5wdXRUZXh0KSlcbiAgICAvLyBhZGQgdGhlIHRpdGxlIHRvIHRoZSBhcnJheSBcbiAgICBhZGRUaXRsZShpbnB1dFRleHQpXG5cbiAgICAvLyB3aGVuIGV2ZXJ5dGhpbmcgaXMgZG9uZSwgZGVsZXRlIHRoZSBmb3JtXG4gICAgY2FuY2VsKGUpXG59XG5cbi8vIGZ1bmN0aW9uIHVzZWQgdG8gZGVsZXRlIG1lbnUtZm9ybVxuZnVuY3Rpb24gY2FuY2VsKGUpIHtcbiAgICAvLyBmaW5kIHRoZSBjbG9zZXN0IG1lbnUgZm9ybSBhbmQgcmVtb3ZlIGl0XG4gICAgZS5zcmNFbGVtZW50LmNsb3Nlc3QoJy5tZW51LWZvcm0nKS5yZW1vdmUoKVxufVxuXG4vLyBhZGQgZXZlbnQgbGlzdGVuZXIgZm9yIGEgbWVudS1pdGVtXG5mdW5jdGlvbiBhZGRNZW51SXRlbUV2ZW50IChpdGVtKSB7XG4gICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XG4gICAgICAgIC8vIHJlbW92ZXMgdGhlIGNsYXNzIHRoYXQgaXMgaGlnaGxpZ2h0aW5nIHRoZSBjdXJyZW50bHkgc2VsZWN0ZWQgaXRlbVxuICAgICAgICBjb25zdCBjdXJyZW50U2VsZWN0ZWQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubWVudS1zZWxlY3RlZCcpXG4gICAgICAgIC8vIG1ha2Ugc3VyZSBjdXJyZW50U2VsZWN0ZWQgaXNuJ3QgbnVsbCB0byBwcmV2ZW50IGFuIGVycm9yXG4gICAgICAgIC8vIGN1cnJlbnRTZWxlY3RlZCB3aWxsIGJlIG51bGwgd2hlbiB0aGUgdHJhc2ggaWNvbiBpcyBjbGlja2VkIHRvIGRlbGV0ZVxuICAgICAgICBpZiAoY3VycmVudFNlbGVjdGVkICE9IG51bGwpe1xuICAgICAgICAgICAgY3VycmVudFNlbGVjdGVkLmNsYXNzTGlzdC5yZW1vdmUoJ21lbnUtc2VsZWN0ZWQnKVxuICAgICAgICB9XG4gICAgICAgIC8vYWRkIHRoZSBtZW51LXNlbGVjdGVkIGNsYXNzIHRvIHRoZSBpdGVtIHRoYXQgd2FzIHNlbGVjdGVkXG4gICAgICAgIGUuc3JjRWxlbWVudC5jbGFzc0xpc3QuYWRkKCdtZW51LXNlbGVjdGVkJylcbiAgICAgICAgLy8gY2FsbCBmdW5jdGlvbiB0byByZW5kZXIgdGhlIHRhc2tzXG4gICAgICAgIG1lbnVTZWxlY3RlZCA9IGUuc3JjRWxlbWVudC5maXJzdENoaWxkLnRleHRDb250ZW50XG4gICAgICAgIHJlbmRlclRhc2tzKG1lbnVTZWxlY3RlZClcbiAgICB9KVxufVxuIl0sIm5hbWVzIjpbInByb2plY3RUaXRsZXMiLCJsb2NhbFN0b3JhZ2UiLCJnZXRJdGVtIiwic3BsaXQiLCJzZXRJdGVtIiwidGFza1Byb3RvIiwiZ2V0VGl0bGUiLCJ0aGlzIiwidGl0bGUiLCJzZXRUaXRsZSIsImdldERlc2NyaXB0aW9uIiwiZGVzY3JpcHRpb24iLCJzZXREZXNjcmlwdGlvbiIsImdldERhdGUiLCJkYXRlIiwic2V0RGF0ZSIsImdldFByaW9yaXR5IiwicHJpb3JpdHkiLCJzZXRQcmlvcml0eSIsImdldFByb2plY3QiLCJwcm9qZWN0Iiwic2V0UHJvamVjdCIsImNyZWF0ZVRhc2siLCJ0YXNrRGl2IiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50IiwiY2xhc3NMaXN0IiwiYWRkIiwidGFza1N0YXJ0IiwidGFza0VuZCIsImNoZWNrQnV0dG9uIiwiYWRkRXZlbnRMaXN0ZW5lciIsImUiLCJwYXJlbnQiLCJzcmNFbGVtZW50IiwicGFyZW50RWxlbWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJpIiwiZmlyc3RTb3J0IiwiYWxsVGFza3MiLCJsZW5ndGgiLCJwdXNoIiwic2Vjb25kU29ydCIsIm1lbnVTZWxlY3RlZCIsInRhc2tTZWFyY2giLCJ0ZXh0Q29udGVudCIsInNwbGljZSIsInJlbW92ZSIsImRlbFRhc2siLCJ0YXNrVGl0bGUiLCJ0YXNrRGF0ZSIsImVkaXRCdXR0b24iLCJzcmMiLCJzZXRBdHRyaWJ1dGUiLCJhcHBlbmRDaGlsZCIsImNyZWF0ZU9wdGlvbiIsIm9wdGlvbiIsImFkZFRhc2siLCJyZW5kZXJUYXNrcyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwiaXRlbSIsIm5ld0FycmF5IiwiZmlsdGVyIiwidG9kYXkiLCJEYXRlIiwiY3VycmVudERhdGVzIiwiZ2V0RnVsbFllYXIiLCJnZXRNb250aCIsImlzRHVlVG9kYXkiLCJ0YXNrc0RpdiIsImVsZSIsImluc2VydEJlZm9yZSIsInRhc2tGb3JtIiwiZm9ybSIsInRvcEVkaXQiLCJlZGl0VGl0bGUiLCJ2YWx1ZSIsImRhdGVEaXYiLCJkYXRlTGFiZWwiLCJpbnB1dERhdGUiLCJ0ZXh0QXJlYURpdiIsInRleHRBcmVhIiwibG93ZXJEaXYiLCJlbmNvbXBhc0RpdiIsInByaW9yaXR5TGFiZWwiLCJwcmlvcml0eVNlbGVjdCIsImJ1dHRvbkRpdiIsImRlbEJ1dHRvbiIsInNhdmVCdXR0b24iLCJjbG9zZXN0Iiwib2JqIiwiT2JqZWN0IiwiY3JlYXRlIiwidGFzayIsInNhdmUiLCJjcmVhdGVUYXNrRWRpdCIsImFkZE1lbnVJdGVtRXZlbnQiLCJtZW51VGl0bGVzIiwiYXJyYXkiLCJjcmVhdGVNZW51SXRlbSIsImRpdiIsInRpdGxlRGl2IiwidHJhc2giLCJpbmRleCIsImluZGV4T2YiLCJkZWxldGVUaXRsZSIsInByZXZpb3VzRWxlbWVudFNpYmxpbmciLCJjYW5jZWwiLCJjdXJyZW50U2VsZWN0ZWQiLCJmaXJzdENoaWxkIiwibWVudUZvcm0iLCJpbnB1dCIsInByb2plY3RCdXR0b25zIiwiYWRkQnV0dG9uIiwiY2FuY2VsQnV0dG9uIiwiaW5wdXRUZXh0IiwiaW5zZXJ0QWRqYWNlbnRFbGVtZW50IiwiY3JlYXRlRm9ybSJdLCJzb3VyY2VSb290IjoiIn0=