(()=>{"use strict";let t=[];localStorage.getItem("projectTitles")?t=localStorage.getItem("projectTitles").split(","):localStorage.setItem("projectTitles",[]);const e={getTitle(){return this.title},setTitle(t){this.title=t},getDescription(){return this.description},setDescription(t){this.description=t},getDate(){return this.date},setDate(t){this.date=t},getPriority(){return this.priority},setPriority(t){this.priority=t},getProject(){return this.project},setProject(t){this.project=t},getId(){return this.id},setId(t){this.id=t}};function n(t,n,s,d,l){const a=document.createElement("div");a.classList.add("task-span"),a.classList.add("task-form"),a.id=l;const u=document.createElement("form");u.setAttribute("action",""),u.setAttribute("method","post");const m=document.createElement("div");m.classList.add("top-form-task");const p=document.createElement("input");p.setAttribute("type","text"),p.setAttribute("id","title-edit"),p.setAttribute("placeholder","Title"),p.setAttribute("name","title-edit"),p.setAttribute("maxlength","20"),p.value=t;const h=document.createElement("div"),E=document.createElement("label");E.textContent="Date: ",E.setAttribute("for","date");const v=document.createElement("input");v.setAttribute("type","date"),v.setAttribute("id","date"),v.setAttribute("name","date"),v.value=n,h.appendChild(E),h.appendChild(v),m.appendChild(p),m.appendChild(h),u.appendChild(m);const C=document.createElement("div");C.classList.add("textarea-div");const b=document.createElement("textarea");b.setAttribute("placeholder","Description"),b.value=s,C.appendChild(b),u.appendChild(C);const g=document.createElement("div");g.classList.add("lower-form-task");const f=document.createElement("div"),A=document.createElement("label");A.textContent="Priority: ",A.setAttribute("for","priority");const y=document.createElement("select");y.setAttribute("name","priority"),y.setAttribute("id","priority");for(let t=3;t>=1;t--)y.appendChild(i(t));y.value=d,f.appendChild(A),f.appendChild(y);const L=document.createElement("div"),k=document.createElement("button");k.textContent="Del",k.setAttribute("type","button");const S=document.createElement("button");return S.textContent="Save",S.setAttribute("type","button"),S.addEventListener("click",(t=>{!function(t){const n=t.srcElement.closest(".task-form"),i=n.querySelector("#title-edit").value,s=n.querySelector("#date").value,d=n.querySelector("textarea").value,l=n.querySelector("#priority").value;let a=n.id;"null"==n.id?(console.log(a),a=c.length,c.push(((t,n,i,c,s,r)=>{let o=Object.create(e);return o.title=t,o.description=i,o.date=n,o.priority=c,o.project=s,o.id=r,o})(i,s,d,l,o,a))):(c[+a].setTitle(i),c[+a].setDate(s),c[+a].setDescription(d),c[+a].setPriority(l)),r(o),n.remove()}(t)})),L.appendChild(k),L.appendChild(S),g.appendChild(f),g.appendChild(L),u.appendChild(g),a.appendChild(u),a}function i(t){const e=document.createElement("option");return e.textContent=t,e.setAttribute("value",t),e}let c=[];const s=document.querySelector(".add-task");function r(t){document.querySelectorAll(".task-span").forEach((t=>{t.remove()}));const e=c.filter((e=>"Today"==t?function(t){const e=new Date,n=t.split("-");return n[0]<e.getFullYear()||n[1]<e.getMonth()||n[2]<=e.getDate()}(e.getDate()):"Important"==t?1==e.getPriority():"All"==t||e.getProject()==t)),i=document.querySelector(".add-task"),s=document.querySelector("#tasks");e.forEach((t=>{const e=function(t,e,i){const s=document.createElement("div");s.classList.add("task"),s.classList.add("task-span"),s.id=i;const r=document.createElement("div"),o=document.createElement("div");r.classList.add("task-start"),o.classList.add("task-end");const d=document.createElement("span");d.classList.add("task-circle"),d.addEventListener("click",(t=>{!function(t){const e=t.srcElement.parentElement.parentElement,n=taskSearch(e);c.splice(n,1),e.remove()}(t)}));const l=document.createElement("div");l.classList.add("task-title"),l.textContent=t;const a=document.createElement("div");a.classList.add("task-date"),a.textContent=e;const u=document.createElement("img");return u.src="images/edit.svg",u.setAttribute("alt","edit button"),u.addEventListener("click",(t=>{!function(t){const e=t.srcElement.parentElement.parentElement,i=+e.id;console.log(i),e.insertAdjacentElement("afterend",n(c[i].getTitle(),c[i].getDate(),c[i].getDescription(),c[i].getPriority(),c[i].getId())),e.remove()}(t)})),o.appendChild(a),o.appendChild(u),r.appendChild(d),r.appendChild(l),s.appendChild(r),s.appendChild(o),s}(t.getTitle(),t.getDate(),t.getId());s.insertBefore(e,i)}))}s.addEventListener("click",(()=>{document.querySelector("#tasks").insertBefore(n(null,null,null,3,"null"),s)}));let o="All";document.querySelectorAll(".menu-item").forEach(m);const d=document.querySelector(".projects"),l=t;for(let t=0;t<l.length;t++)d.appendChild(a(l[t]));function a(e){const n=document.createElement("div");n.classList.add("menu-item");const i=document.createElement("div");i.textContent=e;const c=document.createElement("img");return c.setAttribute("src","./images/trash-2.svg"),c.setAttribute("alt","trash icon"),c.addEventListener("click",(e=>{!function(e){const n=t.indexOf(e);n>-1&&(t.splice(n,1),localStorage.setItem("projectTitles",t))}(e.srcElement.previousElementSibling.textContent),e.srcElement.closest(".menu-item").remove()})),n.appendChild(i),n.appendChild(c),m(n),n}function u(t){t.srcElement.closest(".menu-form").remove()}function m(t){t.addEventListener("click",(t=>{const e=document.querySelector(".menu-selected");null!=e&&e.classList.remove("menu-selected"),t.srcElement.classList.add("menu-selected"),o=t.srcElement.firstChild.textContent,r(o)}))}document.querySelector(".project-title > svg").addEventListener("click",(()=>{document.querySelector(".projects").appendChild(function(){const e=document.createElement("div");e.classList.add("menu-form");const n=document.createElement("form");n.setAttribute("action",""),n.setAttribute("method","post");const i=document.createElement("input");i.setAttribute("type","text"),i.setAttribute("id","project-title"),i.setAttribute("name","projectTitle"),i.setAttribute("maxlength","15");const c=document.createElement("div");c.classList.add("project-buttons");const s=document.createElement("button");s.classList.add("add-button"),s.setAttribute("type","button"),s.textContent="Add";const r=document.createElement("button");return r.classList.add("cancel-button"),r.setAttribute("type","button"),r.textContent="Cancel",s.addEventListener("click",(e=>{!function(e){const n=e.srcElement.closest(".menu-form"),i=n.firstChild.firstChild.value;var c;n.insertAdjacentElement("afterend",a(i)),c=i,t.push(c),localStorage.setItem("projectTitles",t),u(e)}(e)})),r.addEventListener("click",(t=>{u(t)})),c.appendChild(s),c.appendChild(r),n.appendChild(i),n.appendChild(c),e.appendChild(n),e}())}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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bEN3RixFQUFhbEYsWUFBYyxTQUczQmlGLEVBQVVuRSxpQkFBaUIsU0FBVUMsS0FxQnpDLFNBQWNBLEdBRVYsTUFBTStELEVBQVcvRCxFQUFFQyxXQUFXQyxRQUFRLGNBR2hDa0UsRUFBWUwsRUFBU0QsV0FBV0EsV0FBV2hGLE1MeEdyRCxJQUFrQjNCLEVLMEdkNEcsRUFBU2xCLHNCQUFzQixXQUFZTyxFQUFlZ0IsSUwxRzVDakgsRUs0R0xpSCxFTDNHVHpILEVBQWM2RCxLQUFLckQsR0FDbkJQLGFBQWFHLFFBQVEsZ0JBQWlCSixHSzZHdENpSCxFQUFPNUQsRUFDWCxDQWpDUSxDQUFLQSxFQUFDLElBRVZtRSxFQUFhcEUsaUJBQWlCLFNBQVVDLElBQ3BDNEQsRUFBTzVELEVBQUMsSUFJWmlFLEVBQWU5RSxZQUFZK0UsR0FDM0JELEVBQWU5RSxZQUFZZ0YsR0FHM0J6RixFQUFLUyxZQUFZNkUsR0FDakJ0RixFQUFLUyxZQUFZOEUsR0FHakJGLEVBQVM1RSxZQUFZVCxHQUVkcUYsQ0FDWCxDQXRGd0JNLEdBQVksRyIsInNvdXJjZXMiOlsid2VicGFjazovL3RvLWRvLWxpc3QvLi9zcmMvanMtbW9kdWxlcy9wcm9qZWN0cy5qcyIsIndlYnBhY2s6Ly90by1kby1saXN0Ly4vc3JjL2pzLW1vZHVsZXMvdGFzay1vYmplY3QuanMiLCJ3ZWJwYWNrOi8vdG8tZG8tbGlzdC8uL3NyYy9qcy1tb2R1bGVzL3Rhc2stZWRpdC1kb20uanMiLCJ3ZWJwYWNrOi8vdG8tZG8tbGlzdC8uL3NyYy9qcy1tb2R1bGVzL3Rhc2stY29udHJvbC5qcyIsIndlYnBhY2s6Ly90by1kby1saXN0Ly4vc3JjL2pzLW1vZHVsZXMvdGFzay1kb20uanMiLCJ3ZWJwYWNrOi8vdG8tZG8tbGlzdC8uL3NyYy9qcy1tb2R1bGVzL3Byb2plY3RzLWNvbnRyb2wuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gY3JlYXRlIGFycmF5IGZvciBwcm9ncmFtIHRvIHJ1biBvZmZcbmxldCBwcm9qZWN0VGl0bGVzID0gW11cblxuLy8gY2hlY2sgaWYgdGhlcmUgaXMgYW55IGxvY2Fsc3RvcmFnZSwgaWYgbm90IGNyZWF0ZSBuZXcgYXJyYXkgaW4gbG9jYWxzdG9yYWdlXG5pZiAoIWxvY2FsU3RvcmFnZS5nZXRJdGVtKCdwcm9qZWN0VGl0bGVzJykpIHtcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgncHJvamVjdFRpdGxlcycsIFtdKVxuICB9IGVsc2Uge1xuICAgIC8vIGxvYWQgbG9jYWxTdG9yYWdlIGRhdGEgaW50byBtZW1vcnlcbiAgICBwcm9qZWN0VGl0bGVzID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3Byb2plY3RUaXRsZXMnKS5zcGxpdCgnLCcpXG4gIH1cblxuZnVuY3Rpb24gYWRkVGl0bGUodGl0bGUpIHtcbiAgICBwcm9qZWN0VGl0bGVzLnB1c2godGl0bGUpXG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3Byb2plY3RUaXRsZXMnLCBwcm9qZWN0VGl0bGVzKVxufVxuXG5mdW5jdGlvbiBnZXRUaXRsZXMoKSB7XG4gICAgcmV0dXJuIHByb2plY3RUaXRsZXM7XG59XG5cbmZ1bmN0aW9uIGRlbGV0ZVRpdGxlKHRpdGxlKSB7XG4gICAgY29uc3QgaW5kZXggPSBwcm9qZWN0VGl0bGVzLmluZGV4T2YodGl0bGUpO1xuICAgIGlmIChpbmRleCA+IC0xKSB7IC8vIG9ubHkgc3BsaWNlIGFycmF5IHdoZW4gaXRlbSBpcyBmb3VuZFxuICAgICAgICBwcm9qZWN0VGl0bGVzLnNwbGljZShpbmRleCwgMSk7IC8vIDJuZCBwYXJhbWV0ZXIgbWVhbnMgcmVtb3ZlIG9uZSBpdGVtIG9ubHlcbiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3Byb2plY3RUaXRsZXMnLCBwcm9qZWN0VGl0bGVzKVxuICAgIH1cbn1cblxuZXhwb3J0IHthZGRUaXRsZSwgZ2V0VGl0bGVzLCBkZWxldGVUaXRsZX07XG4iLCIvLyBmYWN0b3J5IGZ1bmN0aW9uIHVzZWQgdG8gY29uc3RydWN0IHRhc2sgb2JqZWN0XG5leHBvcnQgY29uc3QgdGFzayA9ICh0aXRsZSwgZGF0ZSwgZGVzY3JpcHRpb24sIHByaW9yaXR5LCBwcm9qZWN0LCBpZCkgPT4ge1xuICAgIGxldCBvYmogPSBPYmplY3QuY3JlYXRlKHRhc2tQcm90bylcbiAgICBvYmoudGl0bGUgPSB0aXRsZVxuICAgIG9iai5kZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uXG4gICAgb2JqLmRhdGUgPSBkYXRlXG4gICAgb2JqLnByaW9yaXR5ID0gcHJpb3JpdHlcbiAgICAvLyB2YXJpYWJsZSB1c2VkIHRvIGRldGVybWluZSB3aGF0IHByb2plY3QgdGhlIHRhc2sgaXMgaW5cbiAgICBvYmoucHJvamVjdCA9IHByb2plY3RcbiAgICBvYmouaWQgPSBpZFxuICAgIHJldHVybiBvYmpcbn1cblxuLy9HcmVhdCBwcm90b3R5cGUgZm9yIHRhc2soKSB0byBzdG9yZSBhbGwgdGhlIG1ldGhvZHMgZm9yIHByb2dyYW0gdG8gcnVuIGZhc3RlclxuY29uc3QgdGFza1Byb3RvID0ge1xuICAgIC8vIGNyZWF0ZSBhbGwgZ2V0dGVycyBhbmQgc2V0dGVycyAob25seSBmb3IgbWVtb3J5IHVzZSlcbiAgICBnZXRUaXRsZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudGl0bGVcbiAgICB9LFxuICAgIHNldFRpdGxlKHRpdGxlKSB7XG4gICAgICAgIHRoaXMudGl0bGUgPSB0aXRsZVxuICAgIH0sXG4gICAgZ2V0RGVzY3JpcHRpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRlc2NyaXB0aW9uXG4gICAgfSxcbiAgICBzZXREZXNjcmlwdGlvbihkZXNjcmlwdGlvbikge1xuICAgICAgICB0aGlzLmRlc2NyaXB0aW9uID0gZGVzY3JpcHRpb25cbiAgICB9LFxuICAgIGdldERhdGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRhdGVcbiAgICB9LFxuICAgIHNldERhdGUoZGF0ZSkge1xuICAgICAgICB0aGlzLmRhdGUgPSBkYXRlXG4gICAgfSxcbiAgICBnZXRQcmlvcml0eSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpb3JpdHlcbiAgICB9LFxuICAgIHNldFByaW9yaXR5KHByaW9yaXR5KSB7XG4gICAgICAgIHRoaXMucHJpb3JpdHkgPSBwcmlvcml0eVxuICAgIH0sXG4gICAgZ2V0UHJvamVjdCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJvamVjdFxuICAgIH0sXG4gICAgc2V0UHJvamVjdChwcm9qZWN0KSB7XG4gICAgICAgIHRoaXMucHJvamVjdCA9IHByb2plY3RcbiAgICB9LFxuICAgIGdldElkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5pZFxuICAgIH0sXG4gICAgc2V0SWQoaWQpIHtcbiAgICAgICAgdGhpcy5pZCA9IGlkXG4gICAgfSxcbn1cblxuIiwiaW1wb3J0IHsgc2F2ZSB9IGZyb20gJy4vdGFzay1jb250cm9sLmpzJ1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBjcmVhdGVUYXNrRWRpdCAodGl0bGUsIGRhdGUsIGRlc2NyaXB0aW9uLCBwcmlvcml0eSwgaWQpIHtcbiAgICAvL2NyZWF0ZSBkaXYgdG8gaG9sZCBhbGwgdGhlIGVsZW1lbnRzXG4gICAgY29uc3QgdGFza0Zvcm0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuICAgIHRhc2tGb3JtLmNsYXNzTGlzdC5hZGQoJ3Rhc2stc3BhbicpXG4gICAgdGFza0Zvcm0uY2xhc3NMaXN0LmFkZCgndGFzay1mb3JtJylcbiAgICB0YXNrRm9ybS5pZCA9IGlkXG5cbiAgICAvL2NyZWF0ZSB0aGUgZm9ybSBcbiAgICBjb25zdCBmb3JtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZm9ybScpXG4gICAgZm9ybS5zZXRBdHRyaWJ1dGUoJ2FjdGlvbicsICcnKVxuICAgIGZvcm0uc2V0QXR0cmlidXRlKCdtZXRob2QnLCAncG9zdCcpXG5cbiAgICAvL3N0YXJ0IGJ5IGNyZWF0aW5nIGVsZW1lbnRzIGZvciB0aGUgdG9wIG9mIHRoZSBmb3JtXG4gICAgLy90aGUgdGl0bGUgYW5kIGRhdGUgYXJlIGlubGN1ZGVkIGhlcmVcbiAgICBjb25zdCB0b3BFZGl0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcbiAgICB0b3BFZGl0LmNsYXNzTGlzdC5hZGQoJ3RvcC1mb3JtLXRhc2snKVxuXG4gICAgLy9pbnB1dCBmb3IgdGhlIHRpdGxlXG4gICAgY29uc3QgZWRpdFRpdGxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKVxuICAgIGVkaXRUaXRsZS5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCAndGV4dCcpXG4gICAgZWRpdFRpdGxlLnNldEF0dHJpYnV0ZSgnaWQnLCAndGl0bGUtZWRpdCcpXG4gICAgZWRpdFRpdGxlLnNldEF0dHJpYnV0ZSgncGxhY2Vob2xkZXInLCAnVGl0bGUnKVxuICAgIGVkaXRUaXRsZS5zZXRBdHRyaWJ1dGUoJ25hbWUnLCAndGl0bGUtZWRpdCcpXG4gICAgZWRpdFRpdGxlLnNldEF0dHJpYnV0ZSgnbWF4bGVuZ3RoJywgJzIwJylcbiAgICBlZGl0VGl0bGUudmFsdWUgPSB0aXRsZSBcblxuICAgIC8vaW5wdXQgZm9yIHRoZSBkYXRlXG4gICAgY29uc3QgZGF0ZURpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG4gICAgY29uc3QgZGF0ZUxhYmVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGFiZWwnKVxuICAgIGRhdGVMYWJlbC50ZXh0Q29udGVudCA9ICdEYXRlOiAnXG4gICAgZGF0ZUxhYmVsLnNldEF0dHJpYnV0ZSgnZm9yJywgJ2RhdGUnKVxuICAgICBcbiAgICBjb25zdCBpbnB1dERhdGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpXG4gICAgaW5wdXREYXRlLnNldEF0dHJpYnV0ZSgndHlwZScsICdkYXRlJylcbiAgICBpbnB1dERhdGUuc2V0QXR0cmlidXRlKCdpZCcsICdkYXRlJylcbiAgICBpbnB1dERhdGUuc2V0QXR0cmlidXRlKCduYW1lJywgJ2RhdGUnKVxuICAgIGlucHV0RGF0ZS52YWx1ZSA9IGRhdGUgXG5cbiAgICAvL2FwcGVuZCB0aGUgdG9wIHRvZ2V0aGVyIGFuZCBhZGQgaXQgdG8gdGhlIGZ1bGwgZm9ybVxuICAgIGRhdGVEaXYuYXBwZW5kQ2hpbGQoZGF0ZUxhYmVsKVxuICAgIGRhdGVEaXYuYXBwZW5kQ2hpbGQoaW5wdXREYXRlKVxuXG4gICAgdG9wRWRpdC5hcHBlbmRDaGlsZChlZGl0VGl0bGUpXG4gICAgdG9wRWRpdC5hcHBlbmRDaGlsZChkYXRlRGl2KVxuXG4gICAgZm9ybS5hcHBlbmRDaGlsZCh0b3BFZGl0KVxuXG4gICAgLy9jcmVhdGUgdGhlIHRleHRhcmVhXG4gICAgY29uc3QgdGV4dEFyZWFEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuICAgIHRleHRBcmVhRGl2LmNsYXNzTGlzdC5hZGQoJ3RleHRhcmVhLWRpdicpXG5cbiAgICBjb25zdCB0ZXh0QXJlYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RleHRhcmVhJylcbiAgICB0ZXh0QXJlYS5zZXRBdHRyaWJ1dGUoJ3BsYWNlaG9sZGVyJywgJ0Rlc2NyaXB0aW9uJylcbiAgICB0ZXh0QXJlYS52YWx1ZSA9IGRlc2NyaXB0aW9uIFxuXG4gICAgdGV4dEFyZWFEaXYuYXBwZW5kQ2hpbGQodGV4dEFyZWEpXG4gICAgZm9ybS5hcHBlbmRDaGlsZCh0ZXh0QXJlYURpdilcblxuICAgIC8vY3JlYXRlIHRoZSBib3R0b20gb2YgdGhlIGZvcm1cbiAgICBjb25zdCBsb3dlckRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG4gICAgbG93ZXJEaXYuY2xhc3NMaXN0LmFkZCgnbG93ZXItZm9ybS10YXNrJylcblxuICAgIGNvbnN0IGVuY29tcGFzRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcblxuICAgIGNvbnN0IHByaW9yaXR5TGFiZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsYWJlbCcpXG4gICAgcHJpb3JpdHlMYWJlbC50ZXh0Q29udGVudCA9ICdQcmlvcml0eTogJ1xuICAgIHByaW9yaXR5TGFiZWwuc2V0QXR0cmlidXRlKCdmb3InLCAncHJpb3JpdHknKVxuXG4gICAgY29uc3QgcHJpb3JpdHlTZWxlY3QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzZWxlY3QnKVxuICAgIHByaW9yaXR5U2VsZWN0LnNldEF0dHJpYnV0ZSgnbmFtZScsICdwcmlvcml0eScpXG4gICAgcHJpb3JpdHlTZWxlY3Quc2V0QXR0cmlidXRlKCdpZCcsICdwcmlvcml0eScpXG5cbiAgICAvL3VzZSBhIGxvb3AgdG8gYWRkIDMgb3B0aW9ucyB0byB0aGUgRE9NXG4gICAgZm9yIChsZXQgaSA9IDM7IGkgPj0gMTsgaS0tKSB7XG4gICAgICAgIC8vdXNlIGEgZnVuY3Rpb24gdG8gcmV0dXJuIHRoZSBET00gb3B0aW9uIGVsZW1lbnRcbiAgICAgICAgcHJpb3JpdHlTZWxlY3QuYXBwZW5kQ2hpbGQoY3JlYXRlT3B0aW9uKGkpKVxuICAgIH1cbiAgICAvLyBhZnRlciBjcmVhdGluZyBvcHRpb25zLCBnaXZlIHZhbHVlIHRvIHByaW9yaXR5U2VsZWN0XG4gICAgcHJpb3JpdHlTZWxlY3QudmFsdWUgPSBwcmlvcml0eSBcblxuICAgIC8vYXBwZW5kIHRoZSBwcmlvcml0eSBlbGVtZW50cyB0byB0aGUgZGl2XG4gICAgZW5jb21wYXNEaXYuYXBwZW5kQ2hpbGQocHJpb3JpdHlMYWJlbClcbiAgICBlbmNvbXBhc0Rpdi5hcHBlbmRDaGlsZChwcmlvcml0eVNlbGVjdClcblxuICAgIC8vIGNyZWF0ZSB0aGUgU2F2ZSBhbmQgRGVsZXRlIGJ1dHRvbnMgaW4gdGhlaXIgb3duIGRpdlxuICAgIGNvbnN0IGJ1dHRvbkRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG5cbiAgICBjb25zdCBkZWxCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKVxuICAgIGRlbEJ1dHRvbi50ZXh0Q29udGVudCA9ICdEZWwnXG4gICAgZGVsQnV0dG9uLnNldEF0dHJpYnV0ZSgndHlwZScsICdidXR0b24nKVxuXG4gICAgY29uc3Qgc2F2ZUJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpXG4gICAgc2F2ZUJ1dHRvbi50ZXh0Q29udGVudCA9ICdTYXZlJ1xuICAgIHNhdmVCdXR0b24uc2V0QXR0cmlidXRlKCd0eXBlJywgJ2J1dHRvbicpXG4gICAgc2F2ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7c2F2ZShlKX0pXG5cbiAgICBidXR0b25EaXYuYXBwZW5kQ2hpbGQoZGVsQnV0dG9uKVxuICAgIGJ1dHRvbkRpdi5hcHBlbmRDaGlsZChzYXZlQnV0dG9uKVxuXG4gICAgLy8gYXBwZW5kIHRoZSBsb3dlciBlbGVtZW50cyBcbiAgICBsb3dlckRpdi5hcHBlbmRDaGlsZChlbmNvbXBhc0RpdilcbiAgICBsb3dlckRpdi5hcHBlbmRDaGlsZChidXR0b25EaXYpXG4gICAgLy9hcHBlbmQgdGhlIGxvd2VyIGRpdiB0byB0aGUgZm9ybVxuICAgIGZvcm0uYXBwZW5kQ2hpbGQobG93ZXJEaXYpXG4gICAgLy9hcHBlbmQgZm9ybSB0byB0aGUgdGFzayBkaXZcbiAgICB0YXNrRm9ybS5hcHBlbmRDaGlsZChmb3JtKVxuXG4gICAgcmV0dXJuIHRhc2tGb3JtXG59XG5cbi8vIGNyZWF0ZXMgb3B0aW9ucyBmb3IgdGhlIHByaW9yaXR5IGVsZW1lbnRcbmZ1bmN0aW9uIGNyZWF0ZU9wdGlvbiAoaSkge1xuICAgIGNvbnN0IG9wdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ29wdGlvbicpXG4gICAgb3B0aW9uLnRleHRDb250ZW50ID0gaVxuICAgIG9wdGlvbi5zZXRBdHRyaWJ1dGUoJ3ZhbHVlJywgaSlcbiAgICByZXR1cm4gb3B0aW9uXG59XG5cbiIsImltcG9ydCB7IHRhc2sgfSBmcm9tICcuL3Rhc2stb2JqZWN0LmpzJ1xuaW1wb3J0IGNyZWF0ZVRhc2sgZnJvbSAnLi90YXNrLWRvbS5qcydcbmltcG9ydCBjcmVhdGVUYXNrRWRpdCBmcm9tICcuL3Rhc2stZWRpdC1kb20uanMnXG5pbXBvcnQgeyBtZW51U2VsZWN0ZWQgYXMgbWVudVNlbGVjdGVkfSBmcm9tICcuL3Byb2plY3RzLWNvbnRyb2wuanMnXG5cbi8vIGNyZWF0ZSBhbiBhcnJheSB0byBzdG9yZSBhbGwgdGhlIHRhc2tzXG5sZXQgYWxsVGFza3MgPSBbXVxuXG4vL2FkZCBldmVudCBsaXN0ZW5lciB0byArQWRkIFRhc2sgYnV0dG9uXG5jb25zdCBhZGRUYXNrID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFkZC10YXNrJylcbmFkZFRhc2suYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgLy8gTmVlZCB0byBwdXQgYSB0YXNrLWVkaXQgYWJvdmUgK0FkZCBUYXNrXG4gICAgY29uc3QgdGFza3NEaXYgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjdGFza3MnKVxuICAgIHRhc2tzRGl2Lmluc2VydEJlZm9yZShjcmVhdGVUYXNrRWRpdChudWxsLCBudWxsLCBudWxsLCAzLCAnbnVsbCcpLCBhZGRUYXNrKVxufSlcblxuZXhwb3J0IGZ1bmN0aW9uIHJlbmRlclRhc2tzIChtZW51U2VsZWN0ZWQpIHtcbiAgICAvLyBmaXJzdCByZW1vdmUgdGhlIGN1cnJlbnQgdGFza3NcbiAgICByZW1vdmVUYXNrcygpXG5cbiAgICAvLyBjcmVhdGUgYSBuZXcgYXJyYXkgdGhhdCBob2xkcyBvbmx5IHRoZSByZXF1aXJlZCB0YXNrcyBmcm9tIHRoZSBwcm9qZWN0XG4gICAgY29uc3QgbmV3QXJyYXkgPSBhbGxUYXNrcy5maWx0ZXIoaXRlbSA9PiB7XG4gICAgICAgIGlmIChtZW51U2VsZWN0ZWQgPT0gXCJUb2RheVwiKSB7XG4gICAgICAgICAgICByZXR1cm4gaXNEdWVUb2RheShpdGVtLmdldERhdGUoKSlcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChtZW51U2VsZWN0ZWQgPT0gXCJJbXBvcnRhbnRcIikge1xuICAgICAgICAgICAgcmV0dXJuIGl0ZW0uZ2V0UHJpb3JpdHkoKSA9PSAxO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKG1lbnVTZWxlY3RlZCA9PSBcIkFsbFwiKSB7cmV0dXJuIHRydWV9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGl0ZW0uZ2V0UHJvamVjdCgpID09IG1lbnVTZWxlY3RlZDsgXG4gICAgICAgIH1cbiAgICB9KTtcbiAgICAvLyBTZWxlY3QgdGhlIGFkZCB0YXNrIFxuICAgIGNvbnN0IGFkZFRhc2sgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYWRkLXRhc2snKVxuICAgIC8vIHNlbGVjdCB0YXNrcyBkaXZcbiAgICBjb25zdCB0YXNrc0RpdiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyN0YXNrcycpXG4gICAgLy9sb29wIHRocm91Z2ggdGhlIG5ldyBhcnJheSBhbmQgcmVuZGVyIHRoZSB0YXNrc1xuICAgIG5ld0FycmF5LmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgICAgLy8gYWRkIG5ldyBlbGVtZW50cyBiZWZvcmUgKyBBZGQgVGFza1xuICAgICAgICBjb25zdCBlbGUgPSBjcmVhdGVUYXNrKGl0ZW0uZ2V0VGl0bGUoKSwgaXRlbS5nZXREYXRlKCksIGl0ZW0uZ2V0SWQoKSlcbiAgICAgICAgdGFza3NEaXYuaW5zZXJ0QmVmb3JlKGVsZSwgYWRkVGFzaylcbiAgICB9KVxufVxuXG4vLyB3aGVuIHJlbmRlclRhc2tzKCkgaXMgY2FsbGVkLCB1c2UgdGhpcyBmdW5jdGlvbiB0byBkZWxldGUgdGhlIGN1cnJlbnQgdGFza3NcbmZ1bmN0aW9uIHJlbW92ZVRhc2tzICgpIHtcbiAgICAvLyBjcmVhdGUgbm9kZSBsaXN0cyBvZiBhbGwgY3VycmVudCB0YXNrcyBpbiB0aGUgRE9NXG4gICAgY29uc3QgYWxsVGFza3MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcudGFzay1zcGFuJylcbiAgICAvLyByZW1vdmUgZWFjaCB0YXNrXG4gICAgYWxsVGFza3MuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgICAgICBpdGVtLnJlbW92ZSgpXG4gICAgfSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzYXZlIChlKSB7XG4gICAgLy8gZ2V0IHRoZSBzcmMgZWxlbWVudCBhbmQgdGhlbiB0aGUgZGl2IGNvbnRhaW5pbmcgaW5mb1xuICAgIGNvbnN0IGJ1dHRvbiA9IGUuc3JjRWxlbWVudFxuICAgIGNvbnN0IGZvcm0gPSBidXR0b24uY2xvc2VzdCgnLnRhc2stZm9ybScpXG4gICAgLy8gZ2F0aGVyIGFsbCByZXF1aXJlZCBpbmZvIHRvIGJ1aWxkIGEgbmV3IHRhc2sgb2JqZWN0XG4gICAgY29uc3QgdGl0bGUgPSBmb3JtLnF1ZXJ5U2VsZWN0b3IoJyN0aXRsZS1lZGl0JykudmFsdWVcbiAgICBjb25zdCBkYXRlID0gZm9ybS5xdWVyeVNlbGVjdG9yKCcjZGF0ZScpLnZhbHVlXG4gICAgY29uc3QgZGVzY3JpcHRpb24gPSBmb3JtLnF1ZXJ5U2VsZWN0b3IoJ3RleHRhcmVhJykudmFsdWVcbiAgICBjb25zdCBwcmlvcml0eSA9IGZvcm0ucXVlcnlTZWxlY3RvcignI3ByaW9yaXR5JykudmFsdWVcbiAgICAvLyBnZXQgaWQgaW5kZXggb2YgZm9ybVxuICAgIGxldCBpZCA9IGZvcm0uaWRcbiAgICBpZiAoZm9ybS5pZCA9PSAnbnVsbCcpIHtcbiAgICAgICAgY29uc29sZS5sb2coaWQpXG4gICAgICAgIGlkID0gYWxsVGFza3MubGVuZ3RoXG4gICAgICAgIGFsbFRhc2tzLnB1c2godGFzayh0aXRsZSwgZGF0ZSwgZGVzY3JpcHRpb24sIHByaW9yaXR5LCBtZW51U2VsZWN0ZWQsIGlkKSlcbiAgICB9XG4gICAgLy8gaWYgbm90IGEgbmV3IHRhc2ssIG1ha2UgY2hhbmdlcyB0byBkYXRhXG4gICAgZWxzZSB7XG4gICAgICAgIGFsbFRhc2tzWytpZF0uc2V0VGl0bGUodGl0bGUpXG4gICAgICAgIGFsbFRhc2tzWytpZF0uc2V0RGF0ZShkYXRlKVxuICAgICAgICBhbGxUYXNrc1sraWRdLnNldERlc2NyaXB0aW9uKGRlc2NyaXB0aW9uKVxuICAgICAgICBhbGxUYXNrc1sraWRdLnNldFByaW9yaXR5KHByaW9yaXR5KVxuICAgIH1cbiAgICAvLyByZW5kZXIgdGhlIG5ldyB0YXNrc1xuICAgIC8vIG90aGVyIHRhc2sgZm9ybSBvbiBwYWdlIHdpbGwgYmUgcmVtb3ZlZFxuICAgIHJlbmRlclRhc2tzKG1lbnVTZWxlY3RlZClcbiAgICAvLyByZW1vdmUgdGhlIGZvcm1cbiAgICBmb3JtLnJlbW92ZSgpXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBkZWxUYXNrKGUpIHtcbiAgICAvLyBnZXQgdGhlIHBhcmVudCBlbGVtZW50XG4gICAgY29uc3QgcGFyZW50ID0gZS5zcmNFbGVtZW50LnBhcmVudEVsZW1lbnQucGFyZW50RWxlbWVudFxuICAgIC8vIHVzZSB0aGUgZnVuY3Rpb24gdG8gZmluZCB0aGUgaW5kZXggb2YgdGhlIGFycmF5IHdoZXJlIHRoZSB0YXNrIGlzIHNhdmVkXG4gICAgY29uc3QgaSA9IHRhc2tTZWFyY2gocGFyZW50KVxuICAgIC8vIGRlbGV0ZXMgdGhlIG9iamVjdCBmcm9tIHRoZSBhcnJheVxuICAgIGFsbFRhc2tzLnNwbGljZShpLCAxKVxuICAgIC8vIHJlbW92ZSB0aGUgZWxlbWVudCBmcm9tIHRoZSBET01cbiAgICBwYXJlbnQucmVtb3ZlKClcbn1cblxuLy8gd2lsbCBvcGVuIGFuIGVkaXQgZm9ybSBmb3IgdGhlIHRhc2tcbmV4cG9ydCBmdW5jdGlvbiBlZGl0VGFzayhlKSB7XG4gICAgLy8gZ2V0IHRoZSBwYXJlbnQgZWxlbWVudFxuICAgIGNvbnN0IHBhcmVudCA9IGUuc3JjRWxlbWVudC5wYXJlbnRFbGVtZW50LnBhcmVudEVsZW1lbnRcbiAgICAvLyBmaW5kIHRoZSB0YXNrIGluIHRoZSBhbGxUYXNrcyBhcnJheVxuICAgIGNvbnN0IGkgPSArKHBhcmVudC5pZClcbiAgICBjb25zb2xlLmxvZyhpKVxuICAgIC8vIG9wZW4gdGhlIGVkaXQgd2luZG93IGJlbG93IHRoZSB0YXNrcyB0aGVuIGRlbGV0ZSB0aGUgdGFza1xuICAgIC8vIGxlYXZlIGVkaXQgbWVudSBvcGVuXG4gICAgcGFyZW50Lmluc2VydEFkamFjZW50RWxlbWVudCgnYWZ0ZXJlbmQnLCBcbiAgICBjcmVhdGVUYXNrRWRpdChhbGxUYXNrc1tpXS5nZXRUaXRsZSgpLCBhbGxUYXNrc1tpXS5nZXREYXRlKCksIFxuICAgIGFsbFRhc2tzW2ldLmdldERlc2NyaXB0aW9uKCksIGFsbFRhc2tzW2ldLmdldFByaW9yaXR5KCksIGFsbFRhc2tzW2ldLmdldElkKCkpKVxuICAgIHBhcmVudC5yZW1vdmUoKVxufVxuXG4vLyB0aGlzIGZ1bmN0aW9uIHVzZXMgdGhlIHRpdGxlIGFuZCBkYXRlIG9mIGEgdGFzayB0byBmaW5kIGl0cyBcbi8vIGluZGV4IGluIHRoZSBhcnJheSBhbmQgcmV0dXJucyBpdFxuLy8gZnVuY3Rpb24gdGFza1NlYXJjaCAocGFyZW50KSB7XG4vLyAgICAgLy8gc2F2ZSB0aGUgdGl0bGUgYW5kIGRhdGUgYnkgc3BsaXR0aW5nIHRoZSByZXR1cm5lZCBzdHJpbmdcbi8vICAgICBjb25zdCB2YXJpYWJsZXMgPSBnZXRUYXNrVmFycyhwYXJlbnQpLnNwbGl0KCcuJylcbi8vICAgICBjb25zb2xlLmxvZyhwYXJlbnQuaWQpXG5cbi8vICAgICAvLyBjcmVhdGUgYSBuZXcgYXJyYXkgdGhhdCBzdG9yZXMgYWxsIGluZGV4ZXMgd2l0aCBzYW1lIHRpdGxlXG4vLyAgICAgY29uc3QgZmlyc3RTb3J0ID0gW11cbi8vICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGFsbFRhc2tzLmxlbmd0aDsgaSsrKSB7XG4vLyAgICAgICAgIGlmIChhbGxUYXNrc1tpXS5nZXRUaXRsZSgpID09PSB2YXJpYWJsZXNbMF0pIHtcbi8vICAgICAgICAgICAgIGZpcnN0U29ydC5wdXNoKGkpXG4vLyAgICAgICAgIH1cbi8vICAgICB9XG4vLyAgICAgLy8gcmVwZWF0IHByb2Nlc3MgdG8gbmFycm93IGRvd24gaW5kZXhlcyBiYXNlZCBvZmYgb2YgZGF0ZVxuLy8gICAgIGNvbnN0IHNlY29uZFNvcnQgPSBbXVxuLy8gICAgIC8vIGhhdmUgdG8gc29ydCB0aHJvdWdoIGZpcnN0U29ydFtdIHRvIGZpbmQgYWxsIHRoZSBpbmRleGVzXG4vLyAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBmaXJzdFNvcnQubGVuZ3RoOyBpKyspIHtcbi8vICAgICAgICAgaWYgKGFsbFRhc2tzW2ZpcnN0U29ydFtpXV0uZ2V0RGF0ZSgpID09IHZhcmlhYmxlc1sxXSkge1xuLy8gICAgICAgICAgICAgLy8gYXBwZW5kIHRob3NlIGluZGV4ZXMgdG8gc2Vjb25kU29ydFtdXG4vLyAgICAgICAgICAgICBzZWNvbmRTb3J0LnB1c2goZmlyc3RTb3J0W2ldKVxuLy8gICAgICAgICB9XG4vLyAgICAgfVxuLy8gICAgIC8vIHVzaW5nIHNlY29uZFNvcnQgZmluZCB0aGUgdGFzayB3aXRoIGEgUHJvamVjdCB0aGF0IG1hdGNoZXMgbWVudSBzZWxlY3RlZFxuLy8gICAgIC8vIHJldHVybiB0aGUgaW5kZXhcbi8vICAgICBpZiAobWVudVNlbGVjdGVkICE9ICdBbGwnKSB7XG4vLyAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2Vjb25kU29ydC5sZW5ndGg7IGkrKyl7XG4vLyAgICAgICAgICAgICBpZiAoYWxsVGFza3Nbc2Vjb25kU29ydFswXV0uZ2V0UHJvamVjdCgpID09PSBtZW51U2VsZWN0ZWQpe1xuLy8gICAgICAgICAgICAgICAgIHJldHVybiBzZWNvbmRTb3J0W2ldXG4vLyAgICAgICAgICAgICB9XG4vLyAgICAgICAgIH1cbi8vICAgICB9XG4vLyAgICAgLy8gaWYgdGhlcmUgYXJlIG11bHRpcGxlcyBpbiAnQWxsJywgcmV0dXJuIHRoZSBpbmRleCB0byB0aGUgZmlyc3QgdGFza1xuLy8gICAgIGVsc2Uge1xuLy8gICAgICAgICByZXR1cm4gc2Vjb25kU29ydFswXVxuLy8gICAgIH1cbi8vIH1cblxuLy8gZnVuY3RpbiByZXR1cm5zIHRydWUgaWYgdGhlIGR1ZSBkYXRlIGlzIHRvZGF5IG9yIGZyb20gdGhlIHBhc3RcbmZ1bmN0aW9uIGlzRHVlVG9kYXkgKGRhdGUpIHtcbiAgICAvLyBjcmVhdGUgdG9kYXkncyBkYXRlXG4gICAgY29uc3QgdG9kYXkgPSBuZXcgRGF0ZSgpXG4gICAgLy8gc3BsaXQgdGhlIGRhdGUgZnJvbSB0aGUgdGFzayBpbnRvIGEgbmV3IGFycmF5XG4gICAgY29uc3QgY3VycmVudERhdGVzID0gZGF0ZS5zcGxpdCgnLScpXG4gICAgLy8gaWYgdGhlIHllYXIgaXMgbGVzcyB0aGFuIGN1cnJlbnQgeWVhciByZXR1cm4gdHJ1ZVxuICAgIGlmIChjdXJyZW50RGF0ZXNbMF0gPCB0b2RheS5nZXRGdWxsWWVhcigpKSByZXR1cm4gdHJ1ZTtcbiAgICAvLyBpZiBtb250aCBpcyBtb250aCBpcyBsZXNzIHRoYW4gY3VycmVudCByZXR1cm4gdHJ1ZVxuICAgIGlmIChjdXJyZW50RGF0ZXNbMV0gPCB0b2RheS5nZXRNb250aCgpKSByZXR1cm4gdHJ1ZTtcbiAgICAvLyBpZiBkYXkgaXMgbGVzcyB0aGFuIG9yIGVxdWFsIHRvIGN1cnJlbnQgZGF5IHJldHVybiB0cnVlXG4gICAgaWYgKGN1cnJlbnREYXRlc1syXSA8PSB0b2RheS5nZXREYXRlKCkpIHJldHVybiB0cnVlO1xuXG4gICAgcmV0dXJuIGZhbHNlXG59XG5cbmZ1bmN0aW9uIGdldFRhc2tWYXJzIChwYXJlbnQpIHtcbiAgICAvLyBnZXQgdGhlIHRpdGxlIGFuZCBkYXRlXG4gICAgY29uc3QgdGl0bGUgPSBwYXJlbnQucXVlcnlTZWxlY3RvcignLnRhc2stdGl0bGUnKS50ZXh0Q29udGVudFxuICAgIGNvbnN0IGRhdGUgPSBwYXJlbnQucXVlcnlTZWxlY3RvcignLnRhc2stZGF0ZScpLnRleHRDb250ZW50XG5cbiAgICAvLyByZXR1cm4gdGl0bGUgYW5kIGRhdGUgYXMgYSBzdHJpbmdcbiAgICByZXR1cm4gdGl0bGUgKyAnLicgKyBkYXRlXG59IiwiaW1wb3J0IHsgZGVsVGFzaywgZWRpdFRhc2sgfSBmcm9tIFwiLi90YXNrLWNvbnRyb2wuanNcIlxuXG4vLyBmdW5jdGlvbiB0aGF0IHJldHVybnMgYSB0YXNrIGZvciB0aGUgRE9NXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBjcmVhdGVUYXNrICh0aXRsZSwgZGF0ZSwgaWQpIHtcbiAgICAvL2NyZWF0ZSBkZWZhdWx0IGRpdiB0byBob2xkIGFsbCB0aGUgaW5mb1xuICAgIGNvbnN0IHRhc2tEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuICAgIHRhc2tEaXYuY2xhc3NMaXN0LmFkZCgndGFzaycpXG4gICAgdGFza0Rpdi5jbGFzc0xpc3QuYWRkKCd0YXNrLXNwYW4nKVxuICAgIHRhc2tEaXYuaWQgPSBpZFxuXG4gICAgLy9jcmVhdGUgdHdvIGhhbHZlcyBmb3IgdGhlIGRpdiBcbiAgICBjb25zdCB0YXNrU3RhcnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuICAgIGNvbnN0IHRhc2tFbmQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuICAgIHRhc2tTdGFydC5jbGFzc0xpc3QuYWRkKCd0YXNrLXN0YXJ0JylcbiAgICB0YXNrRW5kLmNsYXNzTGlzdC5hZGQoJ3Rhc2stZW5kJylcblxuICAgIC8vY3JlYXRlIGJ1dHRvbiB0byBjb21wbGV0ZSB0YXNrXG4gICAgY29uc3QgY2hlY2tCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJylcbiAgICBjaGVja0J1dHRvbi5jbGFzc0xpc3QuYWRkKCd0YXNrLWNpcmNsZScpXG4gICAgY2hlY2tCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge2RlbFRhc2soZSl9KVxuXG4gICAgLy9jcmVhdGUgZGl2IHRvIGhvbGQgdGl0bGUgb2YgdGFza1xuICAgIGNvbnN0IHRhc2tUaXRsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG4gICAgdGFza1RpdGxlLmNsYXNzTGlzdC5hZGQoJ3Rhc2stdGl0bGUnKVxuICAgIHRhc2tUaXRsZS50ZXh0Q29udGVudCA9IHRpdGxlXG5cbiAgICAvL2NyZWF0ZSBkaXYgdG8gaG9sZCB0aGUgZGF0ZVxuICAgIGNvbnN0IHRhc2tEYXRlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcbiAgICB0YXNrRGF0ZS5jbGFzc0xpc3QuYWRkKCd0YXNrLWRhdGUnKVxuICAgIHRhc2tEYXRlLnRleHRDb250ZW50ID0gZGF0ZVxuXG4gICAgLy9jcmVhdGUgdGhlIGVkaXQgYnV0dG9uL2ltZ1xuICAgIGNvbnN0IGVkaXRCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbWcnKVxuICAgIGVkaXRCdXR0b24uc3JjID0gJ2ltYWdlcy9lZGl0LnN2ZydcbiAgICBlZGl0QnV0dG9uLnNldEF0dHJpYnV0ZSgnYWx0JywgJ2VkaXQgYnV0dG9uJylcbiAgICBlZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtlZGl0VGFzayhlKX0pXG5cbiAgICAvLyBBcHBlbmQgYWxsIGVsZW1lbnRzIHRvZ2V0aGVyXG4gICAgdGFza0VuZC5hcHBlbmRDaGlsZCh0YXNrRGF0ZSlcbiAgICB0YXNrRW5kLmFwcGVuZENoaWxkKGVkaXRCdXR0b24pXG5cbiAgICB0YXNrU3RhcnQuYXBwZW5kQ2hpbGQoY2hlY2tCdXR0b24pXG4gICAgdGFza1N0YXJ0LmFwcGVuZENoaWxkKHRhc2tUaXRsZSlcblxuICAgIHRhc2tEaXYuYXBwZW5kQ2hpbGQodGFza1N0YXJ0KVxuICAgIHRhc2tEaXYuYXBwZW5kQ2hpbGQodGFza0VuZClcblxuICAgIHJldHVybiB0YXNrRGl2XG59IiwiaW1wb3J0IHsgYWRkVGl0bGUsIGdldFRpdGxlcywgZGVsZXRlVGl0bGV9IGZyb20gXCIuL3Byb2plY3RzXCJcbmltcG9ydCB7IHJlbmRlclRhc2tzIH0gZnJvbSBcIi4vdGFzay1jb250cm9sLmpzXCJcblxuLy8gdmFyaWFibGUgdXNlZCB0byBrZWVwIHRyYWNrIG9mIHdoaWNoIG1lbnUgaXRlbSBpcyBzZWxlY3RlZFxuZXhwb3J0IGxldCBtZW51U2VsZWN0ZWQgPSAnQWxsJ1xuXG4vL0FkZCBldmVudHMgdG8gdGhlIGRlZmF1bHQgbWVudSBvcHRpb25zXG5jb25zdCBtZW51SXRlbXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcubWVudS1pdGVtJylcbm1lbnVJdGVtcy5mb3JFYWNoKGFkZE1lbnVJdGVtRXZlbnQpXG5cbi8vIExvYWQgbG9jYWxTdG9yYWdlIGRhdGEgaW50byB0aGUgRE9NXG5jb25zdCBtZW51VGl0bGVzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2plY3RzJylcbmNvbnN0IGFycmF5ID0gZ2V0VGl0bGVzKClcbmZvciAobGV0IGkgPSAwOyBpIDwgYXJyYXkubGVuZ3RoOyBpKyspIHtcbiAgICBtZW51VGl0bGVzLmFwcGVuZENoaWxkKGNyZWF0ZU1lbnVJdGVtKGFycmF5W2ldKSlcbn1cblxuLy8gRXZlbnQgbGlzdGVuZXIgZm9yIHRoZSBcIitcIiBidXR0b24gYmVzaWRlIHByb2plY3QgdGl0bGVcbmNvbnN0IHBsdXNCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvamVjdC10aXRsZSA+IHN2ZycpXG5wbHVzQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgIC8vQ2FsbHMgZnVuY3Rpb24gdG8gYWRkIHRoZSBwcm9qZWN0IGZvcm0gdG8gdGhlIERPTVxuICAgIGNvbnN0IHByb2plY3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvamVjdHMnKVxuICAgIHByb2plY3QuYXBwZW5kQ2hpbGQoY3JlYXRlRm9ybSgpKVxuXG59KVxuXG4vLyBSZXR1cm5zIHRoZSBET00gZWxlbWVudCBvZiBhIG1lbnUtaXRlbSBcbi8vIGEgc2ltcGxlIHByb2plY3QgaXMgYWRkZWQgdG8gdGhlIGxpc3Qgb24gdGhlIERPTVxuZnVuY3Rpb24gY3JlYXRlTWVudUl0ZW0odGl0bGUpIHtcbiAgICAvLyAgY3JlYXRlIHRoZSBtZW51LWl0ZW0gZGl2IHRvIGhvbGQgdGhlIGVsZW1lbnRzXG4gICAgY29uc3QgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcbiAgICBkaXYuY2xhc3NMaXN0LmFkZCgnbWVudS1pdGVtJylcbiAgICAvLyBjcmVhdGUgdGhlIHRpdGxlIGRpdlxuICAgIGNvbnN0IHRpdGxlRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcbiAgICB0aXRsZURpdi50ZXh0Q29udGVudCA9IHRpdGxlXG4gICAgLy8gY3JlYXRlIHRoZSB0cmFzaCBiaW4gaW1nXG4gICAgY29uc3QgdHJhc2ggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbWcnKVxuICAgIHRyYXNoLnNldEF0dHJpYnV0ZSgnc3JjJywgJy4vaW1hZ2VzL3RyYXNoLTIuc3ZnJylcbiAgICB0cmFzaC5zZXRBdHRyaWJ1dGUoJ2FsdCcsICd0cmFzaCBpY29uJylcblxuICAgIC8vIGFkZCBldmVudGxpc3RlbmVyIHRvIHRyYXNoIGljb25cbiAgICB0cmFzaC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XG4gICAgICAgIGRlbGV0ZVRpdGxlKGUuc3JjRWxlbWVudC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nLnRleHRDb250ZW50KVxuICAgICAgICBlLnNyY0VsZW1lbnQuY2xvc2VzdCgnLm1lbnUtaXRlbScpLnJlbW92ZSgpXG4gICAgfSlcblxuICAgIC8vIGFwcGVuZCB0aGUgdHdvIGNoaWxkcmVuXG4gICAgZGl2LmFwcGVuZENoaWxkKHRpdGxlRGl2KVxuICAgIGRpdi5hcHBlbmRDaGlsZCh0cmFzaClcblxuICAgIGFkZE1lbnVJdGVtRXZlbnQoZGl2KVxuICAgIFxuICAgIHJldHVybiBkaXZcbn1cblxuLy8gcmV0dXJucyBhIGZvcm0gZm9yIERPTSB0byBiZSB1c2VkIHRvIGNyZWF0ZSBhIG5ldyBwcm9qZWN0XG5mdW5jdGlvbiBjcmVhdGVGb3JtKCkge1xuICAgIC8vIGNyZWF0ZSB0aGUgZGl2IHRoYXQgZW5jb21wYXNzZXMgdGhlIGVudGlyZSBibG9ja1xuICAgIGNvbnN0IG1lbnVGb3JtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcbiAgICBtZW51Rm9ybS5jbGFzc0xpc3QuYWRkKCdtZW51LWZvcm0nKVxuXG4gICAgLy8gY3JlYXRlIHRoZSBmb3JtIGFuZCBhZGQgYXR0cmlidXRlc1xuICAgIGNvbnN0IGZvcm0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdmb3JtJylcbiAgICBmb3JtLnNldEF0dHJpYnV0ZSgnYWN0aW9uJywgXCJcIilcbiAgICBmb3JtLnNldEF0dHJpYnV0ZSgnbWV0aG9kJywgJ3Bvc3QnKVxuXG4gICAgLy8gY3JlYXRlIHRoZSBpbnB1dCBib3ggZm9yIHRleHRcbiAgICBjb25zdCBpbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0JylcbiAgICBpbnB1dC5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCAndGV4dCcpXG4gICAgaW5wdXQuc2V0QXR0cmlidXRlKCdpZCcsICdwcm9qZWN0LXRpdGxlJylcbiAgICBpbnB1dC5zZXRBdHRyaWJ1dGUoJ25hbWUnLCAncHJvamVjdFRpdGxlJylcbiAgICBpbnB1dC5zZXRBdHRyaWJ1dGUoJ21heGxlbmd0aCcsICcxNScpXG5cbiAgICAvLyBjcmVhdGUgZGl2IHRvIGVuY29tcGFzcyBidXR0b25zXG4gICAgY29uc3QgcHJvamVjdEJ1dHRvbnMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuICAgIHByb2plY3RCdXR0b25zLmNsYXNzTGlzdC5hZGQoJ3Byb2plY3QtYnV0dG9ucycpXG5cbiAgICAvL2NyZWF0ZSB0aGUgYnV0dG9uc1xuICAgIGNvbnN0IGFkZEJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpXG4gICAgYWRkQnV0dG9uLmNsYXNzTGlzdC5hZGQoJ2FkZC1idXR0b24nKVxuICAgIGFkZEJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCAnYnV0dG9uJylcbiAgICBhZGRCdXR0b24udGV4dENvbnRlbnQgPSBcIkFkZFwiXG5cbiAgICBjb25zdCBjYW5jZWxCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKVxuICAgIGNhbmNlbEJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdjYW5jZWwtYnV0dG9uJylcbiAgICBjYW5jZWxCdXR0b24uc2V0QXR0cmlidXRlKCd0eXBlJywgJ2J1dHRvbicpXG4gICAgY2FuY2VsQnV0dG9uLnRleHRDb250ZW50ID0gXCJDYW5jZWxcIlxuXG4gICAgLy8gYWRkIGV2ZW50bGlzdGVuZXJzXG4gICAgYWRkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcbiAgICAgICAgc2F2ZShlKVxuICAgIH0pXG4gICAgY2FuY2VsQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcbiAgICAgICAgY2FuY2VsKGUpXG4gICAgfSlcblxuICAgIC8vIEFwcGVuZCB0aGUgYnV0dG9ucyB0byBwcm9qZWN0QnV0dG9uc1xuICAgIHByb2plY3RCdXR0b25zLmFwcGVuZENoaWxkKGFkZEJ1dHRvbilcbiAgICBwcm9qZWN0QnV0dG9ucy5hcHBlbmRDaGlsZChjYW5jZWxCdXR0b24pXG5cbiAgICAvLyBBcHBlbmQgaW5wdXQgdG8gZm9ybSB0aGVuIHByb2plY3RCdXR0b25zIHRvIGZvcm1cbiAgICBmb3JtLmFwcGVuZENoaWxkKGlucHV0KVxuICAgIGZvcm0uYXBwZW5kQ2hpbGQocHJvamVjdEJ1dHRvbnMpXG5cbiAgICAvLyBhcHBlbmQgZm9ybSB0byB0aGUgbWFpbiBkaXYgKG1lbnVGb3JtKVxuICAgIG1lbnVGb3JtLmFwcGVuZENoaWxkKGZvcm0pXG5cbiAgICByZXR1cm4gbWVudUZvcm1cbn1cblxuZnVuY3Rpb24gc2F2ZShlKSB7XG4gICAgLy8gc2VsZWN0IHRoZSBtZW51LWZvcm0gcGFyZW50IG5vZGVcbiAgICBjb25zdCBtZW51Rm9ybSA9IGUuc3JjRWxlbWVudC5jbG9zZXN0KCcubWVudS1mb3JtJylcbiAgICAvLyBzZWxlY3QgdGhlIGNoaWxkIG9mIG1lbnUtZm9ybSBhbmQgdGhlIGNoaWxkIG9mIHRoYXQgdG8gYXF1aXJlIHRoZSBpbnB1dCBub2RlLlxuICAgIC8vIFRha2UgdGhlIHZhbHVlIG9mIHRoZSBpbnB1dCBub2RlXG4gICAgY29uc3QgaW5wdXRUZXh0ID0gbWVudUZvcm0uZmlyc3RDaGlsZC5maXJzdENoaWxkLnZhbHVlXG4gICAgLy8gaW5zZXJ0IGEgbmV3IG1lbnUgaXRlbSBhZnRlciB0aGUgZm9ybVxuICAgIG1lbnVGb3JtLmluc2VydEFkamFjZW50RWxlbWVudCgnYWZ0ZXJlbmQnLCBjcmVhdGVNZW51SXRlbShpbnB1dFRleHQpKVxuICAgIC8vIGFkZCB0aGUgdGl0bGUgdG8gdGhlIGFycmF5IFxuICAgIGFkZFRpdGxlKGlucHV0VGV4dClcblxuICAgIC8vIHdoZW4gZXZlcnl0aGluZyBpcyBkb25lLCBkZWxldGUgdGhlIGZvcm1cbiAgICBjYW5jZWwoZSlcbn1cblxuLy8gZnVuY3Rpb24gdXNlZCB0byBkZWxldGUgbWVudS1mb3JtXG5mdW5jdGlvbiBjYW5jZWwoZSkge1xuICAgIC8vIGZpbmQgdGhlIGNsb3Nlc3QgbWVudSBmb3JtIGFuZCByZW1vdmUgaXRcbiAgICBlLnNyY0VsZW1lbnQuY2xvc2VzdCgnLm1lbnUtZm9ybScpLnJlbW92ZSgpXG59XG5cbi8vIGFkZCBldmVudCBsaXN0ZW5lciBmb3IgYSBtZW51LWl0ZW1cbmZ1bmN0aW9uIGFkZE1lbnVJdGVtRXZlbnQgKGl0ZW0pIHtcbiAgICBpdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcbiAgICAgICAgLy8gcmVtb3ZlcyB0aGUgY2xhc3MgdGhhdCBpcyBoaWdobGlnaHRpbmcgdGhlIGN1cnJlbnRseSBzZWxlY3RlZCBpdGVtXG4gICAgICAgIGNvbnN0IGN1cnJlbnRTZWxlY3RlZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tZW51LXNlbGVjdGVkJylcbiAgICAgICAgLy8gbWFrZSBzdXJlIGN1cnJlbnRTZWxlY3RlZCBpc24ndCBudWxsIHRvIHByZXZlbnQgYW4gZXJyb3JcbiAgICAgICAgLy8gY3VycmVudFNlbGVjdGVkIHdpbGwgYmUgbnVsbCB3aGVuIHRoZSB0cmFzaCBpY29uIGlzIGNsaWNrZWQgdG8gZGVsZXRlXG4gICAgICAgIGlmIChjdXJyZW50U2VsZWN0ZWQgIT0gbnVsbCl7XG4gICAgICAgICAgICBjdXJyZW50U2VsZWN0ZWQuY2xhc3NMaXN0LnJlbW92ZSgnbWVudS1zZWxlY3RlZCcpXG4gICAgICAgIH1cbiAgICAgICAgLy9hZGQgdGhlIG1lbnUtc2VsZWN0ZWQgY2xhc3MgdG8gdGhlIGl0ZW0gdGhhdCB3YXMgc2VsZWN0ZWRcbiAgICAgICAgZS5zcmNFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ21lbnUtc2VsZWN0ZWQnKVxuICAgICAgICAvLyBjYWxsIGZ1bmN0aW9uIHRvIHJlbmRlciB0aGUgdGFza3NcbiAgICAgICAgbWVudVNlbGVjdGVkID0gZS5zcmNFbGVtZW50LmZpcnN0Q2hpbGQudGV4dENvbnRlbnRcbiAgICAgICAgcmVuZGVyVGFza3MobWVudVNlbGVjdGVkKVxuICAgIH0pXG59XG4iXSwibmFtZXMiOlsicHJvamVjdFRpdGxlcyIsImxvY2FsU3RvcmFnZSIsImdldEl0ZW0iLCJzcGxpdCIsInNldEl0ZW0iLCJ0YXNrUHJvdG8iLCJnZXRUaXRsZSIsInRoaXMiLCJ0aXRsZSIsInNldFRpdGxlIiwiZ2V0RGVzY3JpcHRpb24iLCJkZXNjcmlwdGlvbiIsInNldERlc2NyaXB0aW9uIiwiZ2V0RGF0ZSIsImRhdGUiLCJzZXREYXRlIiwiZ2V0UHJpb3JpdHkiLCJwcmlvcml0eSIsInNldFByaW9yaXR5IiwiZ2V0UHJvamVjdCIsInByb2plY3QiLCJzZXRQcm9qZWN0IiwiZ2V0SWQiLCJpZCIsInNldElkIiwiY3JlYXRlVGFza0VkaXQiLCJ0YXNrRm9ybSIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsImNsYXNzTGlzdCIsImFkZCIsImZvcm0iLCJzZXRBdHRyaWJ1dGUiLCJ0b3BFZGl0IiwiZWRpdFRpdGxlIiwidmFsdWUiLCJkYXRlRGl2IiwiZGF0ZUxhYmVsIiwidGV4dENvbnRlbnQiLCJpbnB1dERhdGUiLCJhcHBlbmRDaGlsZCIsInRleHRBcmVhRGl2IiwidGV4dEFyZWEiLCJsb3dlckRpdiIsImVuY29tcGFzRGl2IiwicHJpb3JpdHlMYWJlbCIsInByaW9yaXR5U2VsZWN0IiwiaSIsImNyZWF0ZU9wdGlvbiIsImJ1dHRvbkRpdiIsImRlbEJ1dHRvbiIsInNhdmVCdXR0b24iLCJhZGRFdmVudExpc3RlbmVyIiwiZSIsInNyY0VsZW1lbnQiLCJjbG9zZXN0IiwicXVlcnlTZWxlY3RvciIsImNvbnNvbGUiLCJsb2ciLCJhbGxUYXNrcyIsImxlbmd0aCIsInB1c2giLCJvYmoiLCJPYmplY3QiLCJjcmVhdGUiLCJ0YXNrIiwibWVudVNlbGVjdGVkIiwicmVuZGVyVGFza3MiLCJyZW1vdmUiLCJzYXZlIiwib3B0aW9uIiwiYWRkVGFzayIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwiaXRlbSIsIm5ld0FycmF5IiwiZmlsdGVyIiwidG9kYXkiLCJEYXRlIiwiY3VycmVudERhdGVzIiwiZ2V0RnVsbFllYXIiLCJnZXRNb250aCIsImlzRHVlVG9kYXkiLCJ0YXNrc0RpdiIsImVsZSIsInRhc2tEaXYiLCJ0YXNrU3RhcnQiLCJ0YXNrRW5kIiwiY2hlY2tCdXR0b24iLCJwYXJlbnQiLCJwYXJlbnRFbGVtZW50IiwidGFza1NlYXJjaCIsInNwbGljZSIsImRlbFRhc2siLCJ0YXNrVGl0bGUiLCJ0YXNrRGF0ZSIsImVkaXRCdXR0b24iLCJzcmMiLCJpbnNlcnRBZGphY2VudEVsZW1lbnQiLCJlZGl0VGFzayIsImNyZWF0ZVRhc2siLCJpbnNlcnRCZWZvcmUiLCJhZGRNZW51SXRlbUV2ZW50IiwibWVudVRpdGxlcyIsImFycmF5IiwiY3JlYXRlTWVudUl0ZW0iLCJkaXYiLCJ0aXRsZURpdiIsInRyYXNoIiwiaW5kZXgiLCJpbmRleE9mIiwiZGVsZXRlVGl0bGUiLCJwcmV2aW91c0VsZW1lbnRTaWJsaW5nIiwiY2FuY2VsIiwiY3VycmVudFNlbGVjdGVkIiwiZmlyc3RDaGlsZCIsIm1lbnVGb3JtIiwiaW5wdXQiLCJwcm9qZWN0QnV0dG9ucyIsImFkZEJ1dHRvbiIsImNhbmNlbEJ1dHRvbiIsImlucHV0VGV4dCIsImNyZWF0ZUZvcm0iXSwic291cmNlUm9vdCI6IiJ9