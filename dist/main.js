(()=>{"use strict";let t=[];localStorage.getItem("projectTitles")?t=localStorage.getItem("projectTitles").split(","):localStorage.setItem("projectTitles",[]);const e=(t,e,s,i,r,c)=>{let l=Object.create(n);return l.title=t,l.description=s,l.date=e,l.priority=i,l.project=r,l.id=c,l},n={getTitle(){return this.title},setTitle(t){this.title=t},getDescription(){return this.description},setDescription(t){this.description=t},getDate(){return this.date},setDate(t){this.date=t},getPriority(){return this.priority},setPriority(t){this.priority=t},getProject(){return this.project},setProject(t){this.project=t},getId(){return this.id},setId(t){this.id=t}};function s(t,n,s,c,o){const u=document.createElement("div");u.classList.add("task-span"),u.classList.add("task-form"),u.id=o;const m=document.createElement("form");m.setAttribute("action",""),m.setAttribute("method","post");const p=document.createElement("div");p.classList.add("top-form-task");const h=document.createElement("input");h.setAttribute("type","text"),h.setAttribute("id","title-edit"),h.setAttribute("placeholder","Title"),h.setAttribute("name","title-edit"),h.setAttribute("maxlength","20"),h.value=t;const E=document.createElement("div"),g=document.createElement("label");g.textContent="Date: ",g.setAttribute("for","date");const v=document.createElement("input");v.setAttribute("type","date"),v.setAttribute("id","date"),v.setAttribute("name","date"),v.value=n,E.appendChild(g),E.appendChild(v),p.appendChild(h),p.appendChild(E),m.appendChild(p);const b=document.createElement("div");b.classList.add("textarea-div");const C=document.createElement("textarea");C.setAttribute("placeholder","Description"),C.value=s,b.appendChild(C),m.appendChild(b);const f=document.createElement("div");f.classList.add("lower-form-task");const y=document.createElement("div"),A=document.createElement("label");A.textContent="Priority: ",A.setAttribute("for","priority");const k=document.createElement("select");k.setAttribute("name","priority"),k.setAttribute("id","priority");for(let t=3;t>=1;t--)k.appendChild(i(t));k.value=c,y.appendChild(A),y.appendChild(k);const L=document.createElement("div"),S=document.createElement("button");S.textContent="Del",S.setAttribute("type","button"),S.addEventListener("click",(t=>{d(t)}));const x=document.createElement("button");return x.textContent="Save",x.setAttribute("type","button"),x.addEventListener("click",(t=>{!function(t){const n=t.srcElement.closest(".task-form"),s=n.querySelector("#title-edit").value,i=n.querySelector("#date").value,c=n.querySelector("textarea").value,o=n.querySelector("#priority").value;let d=n.id;"null"==n.id?(d=r.length,r.push(e(s,i,c,o,a,d))):(r[+d].setTitle(s),r[+d].setDate(i),r[+d].setDescription(c),r[+d].setPriority(o)),l(a),n.remove(),localStorage.setItem("allTasks",JSON.stringify(r)),console.log(localStorage.getItem("allTasks"))}(t)})),L.appendChild(S),L.appendChild(x),f.appendChild(y),f.appendChild(L),m.appendChild(f),u.appendChild(m),u}function i(t){const e=document.createElement("option");return e.textContent=t,e.setAttribute("value",t),e}let r=[];null!=JSON.parse(localStorage.getItem("allTasks"))&&(r=JSON.parse(localStorage.getItem("allTasks")),r.forEach(((t,n)=>{r[n]=e(t.title,t.date,t.description,t.priority,t.project,t.id)})));const c=document.querySelector(".add-task");function l(t){o();const e=r.filter((e=>"Today"==t?function(t){const e=new Date,n=t.split("-");return n[0]<e.getFullYear()||n[1]<e.getMonth()||n[2]<=e.getDate()}(e.getDate()):"Important"==t?1==e.getPriority():"All"==t||e.getProject()==t)),n=document.querySelector(".add-task"),i=document.querySelector("#tasks");e.forEach((t=>{const e=function(t,e,n,i){const c=document.createElement("div");c.classList.add("task"),c.classList.add("task-span"),c.id=n;const l=document.createElement("div"),o=document.createElement("div");l.classList.add("task-start"),o.classList.add("task-end");const a=document.createElement("span");a.classList.add("task-circle"),1==i?a.style.cssText="box-shadow: 0 0 5px rgb(255, 60, 20), inset 0 0 5px rgb(255, 60, 20)":2==i&&(a.style.cssText="box-Shadow: 0 0 5px #C9B400, inset 0 0 5px #C9B400"),a.addEventListener("click",(t=>{d(t)}));const u=document.createElement("div");u.classList.add("task-title"),u.textContent=t;const m=document.createElement("div");m.classList.add("task-date"),m.textContent=e;const p=document.createElement("img");return p.src="images/edit.svg",p.setAttribute("alt","edit button"),p.addEventListener("click",(t=>{!function(t){const e=t.srcElement.parentElement.parentElement,n=+e.id;e.insertAdjacentElement("afterend",s(r[n].getTitle(),r[n].getDate(),r[n].getDescription(),r[n].getPriority(),r[n].getId())),e.remove()}(t)})),o.appendChild(m),o.appendChild(p),l.appendChild(a),l.appendChild(u),c.appendChild(l),c.appendChild(o),c}(t.getTitle(),t.getDate(),t.getId(),t.getPriority());i.insertBefore(e,n)}))}function o(){document.querySelectorAll(".task-span").forEach((t=>{t.remove()}))}function d(t){const e=t.srcElement.parentElement.parentElement,n=+e.id;r.splice(n,1),e.remove();for(let t=0;t<r.length;t++)r[t].setId(t);o(),l(a)}c.addEventListener("click",(()=>{document.querySelector("#tasks").insertBefore(s(null,null,null,3,"null"),c)}));let a="All";document.querySelectorAll(".menu-item").forEach(E);const u=document.querySelector(".projects"),m=t;for(let t=0;t<m.length;t++)u.appendChild(p(m[t]));function p(e){const n=document.createElement("div");n.classList.add("menu-item");const s=document.createElement("div");s.textContent=e;const i=document.createElement("img");return i.setAttribute("src","./images/trash-2.svg"),i.setAttribute("alt","trash icon"),i.addEventListener("click",(e=>{!function(e){const n=t.indexOf(e);n>-1&&(t.splice(n,1),localStorage.setItem("projectTitles",t))}(e.srcElement.previousElementSibling.textContent),e.srcElement.closest(".menu-item").remove()})),n.appendChild(s),n.appendChild(i),E(n),n}function h(t){t.srcElement.closest(".menu-form").remove()}function E(t){t.addEventListener("click",(t=>{const e=document.querySelector(".menu-selected");null!=e&&e.classList.remove("menu-selected"),t.srcElement.classList.add("menu-selected"),a=t.srcElement.firstChild.textContent,l(a)}))}document.querySelector(".project-title > svg").addEventListener("click",(()=>{document.querySelector(".projects").appendChild(function(){const e=document.createElement("div");e.classList.add("menu-form");const n=document.createElement("form");n.setAttribute("action",""),n.setAttribute("method","post");const s=document.createElement("input");s.setAttribute("type","text"),s.setAttribute("id","project-title"),s.setAttribute("name","projectTitle"),s.setAttribute("maxlength","15");const i=document.createElement("div");i.classList.add("project-buttons");const r=document.createElement("button");r.classList.add("add-button"),r.setAttribute("type","button"),r.textContent="Add";const c=document.createElement("button");return c.classList.add("cancel-button"),c.setAttribute("type","button"),c.textContent="Cancel",r.addEventListener("click",(e=>{!function(e){const n=e.srcElement.closest(".menu-form"),s=n.firstChild.firstChild.value;var i;n.insertAdjacentElement("afterend",p(s)),i=s,t.push(i),localStorage.setItem("projectTitles",t),h(e)}(e)})),c.addEventListener("click",(t=>{h(t)})),i.appendChild(r),i.appendChild(c),n.appendChild(s),n.appendChild(i),e.appendChild(n),e}())}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LEVBQUtTLFlBQVkrRSxHQUdqQkYsRUFBUzdFLFlBQVlULEdBRWRzRixDQUNYLENBdEZ3Qk0sR0FBWSxHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdG8tZG8tbGlzdC8uL3NyYy9qcy1tb2R1bGVzL3Byb2plY3RzLmpzIiwid2VicGFjazovL3RvLWRvLWxpc3QvLi9zcmMvanMtbW9kdWxlcy90YXNrLW9iamVjdC5qcyIsIndlYnBhY2s6Ly90by1kby1saXN0Ly4vc3JjL2pzLW1vZHVsZXMvdGFzay1lZGl0LWRvbS5qcyIsIndlYnBhY2s6Ly90by1kby1saXN0Ly4vc3JjL2pzLW1vZHVsZXMvdGFzay1jb250cm9sLmpzIiwid2VicGFjazovL3RvLWRvLWxpc3QvLi9zcmMvanMtbW9kdWxlcy90YXNrLWRvbS5qcyIsIndlYnBhY2s6Ly90by1kby1saXN0Ly4vc3JjL2pzLW1vZHVsZXMvcHJvamVjdHMtY29udHJvbC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBjcmVhdGUgYXJyYXkgZm9yIHByb2dyYW0gdG8gcnVuIG9mZlxubGV0IHByb2plY3RUaXRsZXMgPSBbXVxuXG4vLyBjaGVjayBpZiB0aGVyZSBpcyBhbnkgbG9jYWxzdG9yYWdlLCBpZiBub3QgY3JlYXRlIG5ldyBhcnJheSBpbiBsb2NhbHN0b3JhZ2VcbmlmICghbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3Byb2plY3RUaXRsZXMnKSkge1xuICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdwcm9qZWN0VGl0bGVzJywgW10pXG4gIH0gZWxzZSB7XG4gICAgLy8gbG9hZCBsb2NhbFN0b3JhZ2UgZGF0YSBpbnRvIG1lbW9yeVxuICAgIHByb2plY3RUaXRsZXMgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgncHJvamVjdFRpdGxlcycpLnNwbGl0KCcsJylcbiAgfVxuXG5mdW5jdGlvbiBhZGRUaXRsZSh0aXRsZSkge1xuICAgIHByb2plY3RUaXRsZXMucHVzaCh0aXRsZSlcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgncHJvamVjdFRpdGxlcycsIHByb2plY3RUaXRsZXMpXG59XG5cbmZ1bmN0aW9uIGdldFRpdGxlcygpIHtcbiAgICByZXR1cm4gcHJvamVjdFRpdGxlcztcbn1cblxuZnVuY3Rpb24gZGVsZXRlVGl0bGUodGl0bGUpIHtcbiAgICBjb25zdCBpbmRleCA9IHByb2plY3RUaXRsZXMuaW5kZXhPZih0aXRsZSk7XG4gICAgaWYgKGluZGV4ID4gLTEpIHsgLy8gb25seSBzcGxpY2UgYXJyYXkgd2hlbiBpdGVtIGlzIGZvdW5kXG4gICAgICAgIHByb2plY3RUaXRsZXMuc3BsaWNlKGluZGV4LCAxKTsgLy8gMm5kIHBhcmFtZXRlciBtZWFucyByZW1vdmUgb25lIGl0ZW0gb25seVxuICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgncHJvamVjdFRpdGxlcycsIHByb2plY3RUaXRsZXMpXG4gICAgfVxufVxuXG5leHBvcnQge2FkZFRpdGxlLCBnZXRUaXRsZXMsIGRlbGV0ZVRpdGxlfTtcbiIsIi8vIGZhY3RvcnkgZnVuY3Rpb24gdXNlZCB0byBjb25zdHJ1Y3QgdGFzayBvYmplY3RcbmV4cG9ydCBjb25zdCB0YXNrID0gKHRpdGxlLCBkYXRlLCBkZXNjcmlwdGlvbiwgcHJpb3JpdHksIHByb2plY3QsIGlkKSA9PiB7XG4gICAgbGV0IG9iaiA9IE9iamVjdC5jcmVhdGUodGFza1Byb3RvKVxuICAgIG9iai50aXRsZSA9IHRpdGxlXG4gICAgb2JqLmRlc2NyaXB0aW9uID0gZGVzY3JpcHRpb25cbiAgICBvYmouZGF0ZSA9IGRhdGVcbiAgICBvYmoucHJpb3JpdHkgPSBwcmlvcml0eVxuICAgIC8vIHZhcmlhYmxlIHVzZWQgdG8gZGV0ZXJtaW5lIHdoYXQgcHJvamVjdCB0aGUgdGFzayBpcyBpblxuICAgIG9iai5wcm9qZWN0ID0gcHJvamVjdFxuICAgIG9iai5pZCA9IGlkXG4gICAgcmV0dXJuIG9ialxufVxuXG4vL0dyZWF0IHByb3RvdHlwZSBmb3IgdGFzaygpIHRvIHN0b3JlIGFsbCB0aGUgbWV0aG9kcyBmb3IgcHJvZ3JhbSB0byBydW4gZmFzdGVyXG5jb25zdCB0YXNrUHJvdG8gPSB7XG4gICAgLy8gY3JlYXRlIGFsbCBnZXR0ZXJzIGFuZCBzZXR0ZXJzIChvbmx5IGZvciBtZW1vcnkgdXNlKVxuICAgIGdldFRpdGxlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy50aXRsZVxuICAgIH0sXG4gICAgc2V0VGl0bGUodGl0bGUpIHtcbiAgICAgICAgdGhpcy50aXRsZSA9IHRpdGxlXG4gICAgfSxcbiAgICBnZXREZXNjcmlwdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGVzY3JpcHRpb25cbiAgICB9LFxuICAgIHNldERlc2NyaXB0aW9uKGRlc2NyaXB0aW9uKSB7XG4gICAgICAgIHRoaXMuZGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvblxuICAgIH0sXG4gICAgZ2V0RGF0ZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGF0ZVxuICAgIH0sXG4gICAgc2V0RGF0ZShkYXRlKSB7XG4gICAgICAgIHRoaXMuZGF0ZSA9IGRhdGVcbiAgICB9LFxuICAgIGdldFByaW9yaXR5KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcmlvcml0eVxuICAgIH0sXG4gICAgc2V0UHJpb3JpdHkocHJpb3JpdHkpIHtcbiAgICAgICAgdGhpcy5wcmlvcml0eSA9IHByaW9yaXR5XG4gICAgfSxcbiAgICBnZXRQcm9qZWN0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcm9qZWN0XG4gICAgfSxcbiAgICBzZXRQcm9qZWN0KHByb2plY3QpIHtcbiAgICAgICAgdGhpcy5wcm9qZWN0ID0gcHJvamVjdFxuICAgIH0sXG4gICAgZ2V0SWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmlkXG4gICAgfSxcbiAgICBzZXRJZChpZCkge1xuICAgICAgICB0aGlzLmlkID0gaWRcbiAgICB9LFxufVxuXG4iLCJpbXBvcnQgeyBzYXZlIH0gZnJvbSAnLi90YXNrLWNvbnRyb2wuanMnXG5pbXBvcnQgeyBkZWxUYXNrIH0gZnJvbSAnLi90YXNrLWNvbnRyb2wuanMnXG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGNyZWF0ZVRhc2tFZGl0ICh0aXRsZSwgZGF0ZSwgZGVzY3JpcHRpb24sIHByaW9yaXR5LCBpZCkge1xuICAgIC8vY3JlYXRlIGRpdiB0byBob2xkIGFsbCB0aGUgZWxlbWVudHNcbiAgICBjb25zdCB0YXNrRm9ybSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG4gICAgdGFza0Zvcm0uY2xhc3NMaXN0LmFkZCgndGFzay1zcGFuJylcbiAgICB0YXNrRm9ybS5jbGFzc0xpc3QuYWRkKCd0YXNrLWZvcm0nKVxuICAgIHRhc2tGb3JtLmlkID0gaWRcblxuICAgIC8vY3JlYXRlIHRoZSBmb3JtIFxuICAgIGNvbnN0IGZvcm0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdmb3JtJylcbiAgICBmb3JtLnNldEF0dHJpYnV0ZSgnYWN0aW9uJywgJycpXG4gICAgZm9ybS5zZXRBdHRyaWJ1dGUoJ21ldGhvZCcsICdwb3N0JylcblxuICAgIC8vc3RhcnQgYnkgY3JlYXRpbmcgZWxlbWVudHMgZm9yIHRoZSB0b3Agb2YgdGhlIGZvcm1cbiAgICAvL3RoZSB0aXRsZSBhbmQgZGF0ZSBhcmUgaW5sY3VkZWQgaGVyZVxuICAgIGNvbnN0IHRvcEVkaXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuICAgIHRvcEVkaXQuY2xhc3NMaXN0LmFkZCgndG9wLWZvcm0tdGFzaycpXG5cbiAgICAvL2lucHV0IGZvciB0aGUgdGl0bGVcbiAgICBjb25zdCBlZGl0VGl0bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpXG4gICAgZWRpdFRpdGxlLnNldEF0dHJpYnV0ZSgndHlwZScsICd0ZXh0JylcbiAgICBlZGl0VGl0bGUuc2V0QXR0cmlidXRlKCdpZCcsICd0aXRsZS1lZGl0JylcbiAgICBlZGl0VGl0bGUuc2V0QXR0cmlidXRlKCdwbGFjZWhvbGRlcicsICdUaXRsZScpXG4gICAgZWRpdFRpdGxlLnNldEF0dHJpYnV0ZSgnbmFtZScsICd0aXRsZS1lZGl0JylcbiAgICBlZGl0VGl0bGUuc2V0QXR0cmlidXRlKCdtYXhsZW5ndGgnLCAnMjAnKVxuICAgIGVkaXRUaXRsZS52YWx1ZSA9IHRpdGxlIFxuXG4gICAgLy9pbnB1dCBmb3IgdGhlIGRhdGVcbiAgICBjb25zdCBkYXRlRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcbiAgICBjb25zdCBkYXRlTGFiZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsYWJlbCcpXG4gICAgZGF0ZUxhYmVsLnRleHRDb250ZW50ID0gJ0RhdGU6ICdcbiAgICBkYXRlTGFiZWwuc2V0QXR0cmlidXRlKCdmb3InLCAnZGF0ZScpXG4gICAgIFxuICAgIGNvbnN0IGlucHV0RGF0ZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0JylcbiAgICBpbnB1dERhdGUuc2V0QXR0cmlidXRlKCd0eXBlJywgJ2RhdGUnKVxuICAgIGlucHV0RGF0ZS5zZXRBdHRyaWJ1dGUoJ2lkJywgJ2RhdGUnKVxuICAgIGlucHV0RGF0ZS5zZXRBdHRyaWJ1dGUoJ25hbWUnLCAnZGF0ZScpXG4gICAgaW5wdXREYXRlLnZhbHVlID0gZGF0ZSBcblxuICAgIC8vYXBwZW5kIHRoZSB0b3AgdG9nZXRoZXIgYW5kIGFkZCBpdCB0byB0aGUgZnVsbCBmb3JtXG4gICAgZGF0ZURpdi5hcHBlbmRDaGlsZChkYXRlTGFiZWwpXG4gICAgZGF0ZURpdi5hcHBlbmRDaGlsZChpbnB1dERhdGUpXG5cbiAgICB0b3BFZGl0LmFwcGVuZENoaWxkKGVkaXRUaXRsZSlcbiAgICB0b3BFZGl0LmFwcGVuZENoaWxkKGRhdGVEaXYpXG5cbiAgICBmb3JtLmFwcGVuZENoaWxkKHRvcEVkaXQpXG5cbiAgICAvL2NyZWF0ZSB0aGUgdGV4dGFyZWFcbiAgICBjb25zdCB0ZXh0QXJlYURpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG4gICAgdGV4dEFyZWFEaXYuY2xhc3NMaXN0LmFkZCgndGV4dGFyZWEtZGl2JylcblxuICAgIGNvbnN0IHRleHRBcmVhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGV4dGFyZWEnKVxuICAgIHRleHRBcmVhLnNldEF0dHJpYnV0ZSgncGxhY2Vob2xkZXInLCAnRGVzY3JpcHRpb24nKVxuICAgIHRleHRBcmVhLnZhbHVlID0gZGVzY3JpcHRpb24gXG5cbiAgICB0ZXh0QXJlYURpdi5hcHBlbmRDaGlsZCh0ZXh0QXJlYSlcbiAgICBmb3JtLmFwcGVuZENoaWxkKHRleHRBcmVhRGl2KVxuXG4gICAgLy9jcmVhdGUgdGhlIGJvdHRvbSBvZiB0aGUgZm9ybVxuICAgIGNvbnN0IGxvd2VyRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcbiAgICBsb3dlckRpdi5jbGFzc0xpc3QuYWRkKCdsb3dlci1mb3JtLXRhc2snKVxuXG4gICAgY29uc3QgZW5jb21wYXNEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuXG4gICAgY29uc3QgcHJpb3JpdHlMYWJlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xhYmVsJylcbiAgICBwcmlvcml0eUxhYmVsLnRleHRDb250ZW50ID0gJ1ByaW9yaXR5OiAnXG4gICAgcHJpb3JpdHlMYWJlbC5zZXRBdHRyaWJ1dGUoJ2ZvcicsICdwcmlvcml0eScpXG5cbiAgICBjb25zdCBwcmlvcml0eVNlbGVjdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NlbGVjdCcpXG4gICAgcHJpb3JpdHlTZWxlY3Quc2V0QXR0cmlidXRlKCduYW1lJywgJ3ByaW9yaXR5JylcbiAgICBwcmlvcml0eVNlbGVjdC5zZXRBdHRyaWJ1dGUoJ2lkJywgJ3ByaW9yaXR5JylcblxuICAgIC8vdXNlIGEgbG9vcCB0byBhZGQgMyBvcHRpb25zIHRvIHRoZSBET01cbiAgICBmb3IgKGxldCBpID0gMzsgaSA+PSAxOyBpLS0pIHtcbiAgICAgICAgLy91c2UgYSBmdW5jdGlvbiB0byByZXR1cm4gdGhlIERPTSBvcHRpb24gZWxlbWVudFxuICAgICAgICBwcmlvcml0eVNlbGVjdC5hcHBlbmRDaGlsZChjcmVhdGVPcHRpb24oaSkpXG4gICAgfVxuICAgIC8vIGFmdGVyIGNyZWF0aW5nIG9wdGlvbnMsIGdpdmUgdmFsdWUgdG8gcHJpb3JpdHlTZWxlY3RcbiAgICBwcmlvcml0eVNlbGVjdC52YWx1ZSA9IHByaW9yaXR5IFxuXG4gICAgLy9hcHBlbmQgdGhlIHByaW9yaXR5IGVsZW1lbnRzIHRvIHRoZSBkaXZcbiAgICBlbmNvbXBhc0Rpdi5hcHBlbmRDaGlsZChwcmlvcml0eUxhYmVsKVxuICAgIGVuY29tcGFzRGl2LmFwcGVuZENoaWxkKHByaW9yaXR5U2VsZWN0KVxuXG4gICAgLy8gY3JlYXRlIHRoZSBTYXZlIGFuZCBEZWxldGUgYnV0dG9ucyBpbiB0aGVpciBvd24gZGl2XG4gICAgY29uc3QgYnV0dG9uRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcblxuICAgIGNvbnN0IGRlbEJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpXG4gICAgZGVsQnV0dG9uLnRleHRDb250ZW50ID0gJ0RlbCdcbiAgICBkZWxCdXR0b24uc2V0QXR0cmlidXRlKCd0eXBlJywgJ2J1dHRvbicpXG4gICAgZGVsQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtkZWxUYXNrKGUpfSlcblxuICAgIGNvbnN0IHNhdmVCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKVxuICAgIHNhdmVCdXR0b24udGV4dENvbnRlbnQgPSAnU2F2ZSdcbiAgICBzYXZlQnV0dG9uLnNldEF0dHJpYnV0ZSgndHlwZScsICdidXR0b24nKVxuICAgIHNhdmVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge3NhdmUoZSl9KVxuXG4gICAgYnV0dG9uRGl2LmFwcGVuZENoaWxkKGRlbEJ1dHRvbilcbiAgICBidXR0b25EaXYuYXBwZW5kQ2hpbGQoc2F2ZUJ1dHRvbilcblxuICAgIC8vIGFwcGVuZCB0aGUgbG93ZXIgZWxlbWVudHMgXG4gICAgbG93ZXJEaXYuYXBwZW5kQ2hpbGQoZW5jb21wYXNEaXYpXG4gICAgbG93ZXJEaXYuYXBwZW5kQ2hpbGQoYnV0dG9uRGl2KVxuICAgIC8vYXBwZW5kIHRoZSBsb3dlciBkaXYgdG8gdGhlIGZvcm1cbiAgICBmb3JtLmFwcGVuZENoaWxkKGxvd2VyRGl2KVxuICAgIC8vYXBwZW5kIGZvcm0gdG8gdGhlIHRhc2sgZGl2XG4gICAgdGFza0Zvcm0uYXBwZW5kQ2hpbGQoZm9ybSlcblxuICAgIHJldHVybiB0YXNrRm9ybVxufVxuXG4vLyBjcmVhdGVzIG9wdGlvbnMgZm9yIHRoZSBwcmlvcml0eSBlbGVtZW50XG5mdW5jdGlvbiBjcmVhdGVPcHRpb24gKGkpIHtcbiAgICBjb25zdCBvcHRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvcHRpb24nKVxuICAgIG9wdGlvbi50ZXh0Q29udGVudCA9IGlcbiAgICBvcHRpb24uc2V0QXR0cmlidXRlKCd2YWx1ZScsIGkpXG4gICAgcmV0dXJuIG9wdGlvblxufVxuXG4iLCJpbXBvcnQgeyB0YXNrIH0gZnJvbSAnLi90YXNrLW9iamVjdC5qcydcbmltcG9ydCBjcmVhdGVUYXNrIGZyb20gJy4vdGFzay1kb20uanMnXG5pbXBvcnQgY3JlYXRlVGFza0VkaXQgZnJvbSAnLi90YXNrLWVkaXQtZG9tLmpzJ1xuaW1wb3J0IHsgbWVudVNlbGVjdGVkIGFzIG1lbnVTZWxlY3RlZH0gZnJvbSAnLi9wcm9qZWN0cy1jb250cm9sLmpzJ1xuXG4vLyBjcmVhdGUgYW4gYXJyYXkgdG8gc3RvcmUgYWxsIHRoZSB0YXNrc1xubGV0IGFsbFRhc2tzID0gW11cbi8vY29uc3QgdHByb3RvID0gT2JqZWN0LmFzc2lnbih7fSwgdGFza1Byb3RvKVxuaWYgKEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2FsbFRhc2tzJykpICE9IG51bGwpIHtcbiAgICBhbGxUYXNrcyA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2FsbFRhc2tzJykpXG4gICAgLy8gYXNzaWduIHRoZSBwcm90b3R5cGUgYmVjYXVzZSBpdCBpc24ndCBzYXZlZCB3aXRoIGxvY2FsU3RvcmFnZVxuICAgIGFsbFRhc2tzLmZvckVhY2goKGl0ZW0sIGluZGV4KSA9PiB7XG4gICAgICAgIGFsbFRhc2tzW2luZGV4XSA9IHRhc2soaXRlbS50aXRsZSwgaXRlbS5kYXRlLCBpdGVtLmRlc2NyaXB0aW9uLCBpdGVtLnByaW9yaXR5LCBpdGVtLnByb2plY3QsIGl0ZW0uaWQpXG4gICAgfSlcbn1cblxuLy9hZGQgZXZlbnQgbGlzdGVuZXIgdG8gK0FkZCBUYXNrIGJ1dHRvblxuY29uc3QgYWRkVGFzayA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hZGQtdGFzaycpXG5hZGRUYXNrLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgIC8vIE5lZWQgdG8gcHV0IGEgdGFzay1lZGl0IGFib3ZlICtBZGQgVGFza1xuICAgIGNvbnN0IHRhc2tzRGl2ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3Rhc2tzJylcbiAgICB0YXNrc0Rpdi5pbnNlcnRCZWZvcmUoY3JlYXRlVGFza0VkaXQobnVsbCwgbnVsbCwgbnVsbCwgMywgJ251bGwnKSwgYWRkVGFzaylcbn0pXG5cbmV4cG9ydCBmdW5jdGlvbiByZW5kZXJUYXNrcyAobWVudVNlbGVjdGVkKSB7XG4gICAgLy8gZmlyc3QgcmVtb3ZlIHRoZSBjdXJyZW50IHRhc2tzXG4gICAgcmVtb3ZlVGFza3MoKVxuXG4gICAgLy8gY3JlYXRlIGEgbmV3IGFycmF5IHRoYXQgaG9sZHMgb25seSB0aGUgcmVxdWlyZWQgdGFza3MgZnJvbSB0aGUgcHJvamVjdFxuICAgIGNvbnN0IG5ld0FycmF5ID0gYWxsVGFza3MuZmlsdGVyKGl0ZW0gPT4ge1xuICAgICAgICBpZiAobWVudVNlbGVjdGVkID09IFwiVG9kYXlcIikge1xuICAgICAgICAgICAgcmV0dXJuIGlzRHVlVG9kYXkoaXRlbS5nZXREYXRlKCkpXG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAobWVudVNlbGVjdGVkID09IFwiSW1wb3J0YW50XCIpIHtcbiAgICAgICAgICAgIHJldHVybiBpdGVtLmdldFByaW9yaXR5KCkgPT0gMTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChtZW51U2VsZWN0ZWQgPT0gXCJBbGxcIikge3JldHVybiB0cnVlfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBpdGVtLmdldFByb2plY3QoKSA9PSBtZW51U2VsZWN0ZWQ7IFxuICAgICAgICB9XG4gICAgfSk7XG4gICAgLy8gU2VsZWN0IHRoZSBhZGQgdGFzayBcbiAgICBjb25zdCBhZGRUYXNrID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFkZC10YXNrJylcbiAgICAvLyBzZWxlY3QgdGFza3MgZGl2XG4gICAgY29uc3QgdGFza3NEaXYgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjdGFza3MnKVxuICAgIC8vbG9vcCB0aHJvdWdoIHRoZSBuZXcgYXJyYXkgYW5kIHJlbmRlciB0aGUgdGFza3NcbiAgICBuZXdBcnJheS5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICAgIC8vIGFkZCBuZXcgZWxlbWVudHMgYmVmb3JlICsgQWRkIFRhc2tcbiAgICAgICAgY29uc3QgZWxlID0gY3JlYXRlVGFzayhpdGVtLmdldFRpdGxlKCksIGl0ZW0uZ2V0RGF0ZSgpLCBpdGVtLmdldElkKCksIGl0ZW0uZ2V0UHJpb3JpdHkoKSlcbiAgICAgICAgdGFza3NEaXYuaW5zZXJ0QmVmb3JlKGVsZSwgYWRkVGFzaylcbiAgICB9KVxufVxuXG4vLyB3aGVuIHJlbmRlclRhc2tzKCkgaXMgY2FsbGVkLCB1c2UgdGhpcyBmdW5jdGlvbiB0byBkZWxldGUgdGhlIGN1cnJlbnQgdGFza3NcbmZ1bmN0aW9uIHJlbW92ZVRhc2tzICgpIHtcbiAgICAvLyBjcmVhdGUgbm9kZSBsaXN0cyBvZiBhbGwgY3VycmVudCB0YXNrcyBpbiB0aGUgRE9NXG4gICAgY29uc3QgYWxsVGFza3MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcudGFzay1zcGFuJylcbiAgICAvLyByZW1vdmUgZWFjaCB0YXNrXG4gICAgYWxsVGFza3MuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgICAgICBpdGVtLnJlbW92ZSgpXG4gICAgfSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzYXZlIChlKSB7XG4gICAgLy8gZ2V0IHRoZSBzcmMgZWxlbWVudCBhbmQgdGhlbiB0aGUgZGl2IGNvbnRhaW5pbmcgaW5mb1xuICAgIGNvbnN0IGJ1dHRvbiA9IGUuc3JjRWxlbWVudFxuICAgIGNvbnN0IGZvcm0gPSBidXR0b24uY2xvc2VzdCgnLnRhc2stZm9ybScpXG4gICAgLy8gZ2F0aGVyIGFsbCByZXF1aXJlZCBpbmZvIHRvIGJ1aWxkIGEgbmV3IHRhc2sgb2JqZWN0XG4gICAgY29uc3QgdGl0bGUgPSBmb3JtLnF1ZXJ5U2VsZWN0b3IoJyN0aXRsZS1lZGl0JykudmFsdWVcbiAgICBjb25zdCBkYXRlID0gZm9ybS5xdWVyeVNlbGVjdG9yKCcjZGF0ZScpLnZhbHVlXG4gICAgY29uc3QgZGVzY3JpcHRpb24gPSBmb3JtLnF1ZXJ5U2VsZWN0b3IoJ3RleHRhcmVhJykudmFsdWVcbiAgICBjb25zdCBwcmlvcml0eSA9IGZvcm0ucXVlcnlTZWxlY3RvcignI3ByaW9yaXR5JykudmFsdWVcbiAgICAvLyBnZXQgaWQgaW5kZXggb2YgZm9ybVxuICAgIGxldCBpZCA9IGZvcm0uaWRcbiAgICBpZiAoZm9ybS5pZCA9PSAnbnVsbCcpIHtcbiAgICAgICAgaWQgPSBhbGxUYXNrcy5sZW5ndGhcbiAgICAgICAgYWxsVGFza3MucHVzaCh0YXNrKHRpdGxlLCBkYXRlLCBkZXNjcmlwdGlvbiwgcHJpb3JpdHksIG1lbnVTZWxlY3RlZCwgaWQpKVxuICAgIH1cbiAgICAvLyBpZiBub3QgYSBuZXcgdGFzaywgbWFrZSBjaGFuZ2VzIHRvIGRhdGFcbiAgICBlbHNlIHtcbiAgICAgICAgYWxsVGFza3NbK2lkXS5zZXRUaXRsZSh0aXRsZSlcbiAgICAgICAgYWxsVGFza3NbK2lkXS5zZXREYXRlKGRhdGUpXG4gICAgICAgIGFsbFRhc2tzWytpZF0uc2V0RGVzY3JpcHRpb24oZGVzY3JpcHRpb24pXG4gICAgICAgIGFsbFRhc2tzWytpZF0uc2V0UHJpb3JpdHkocHJpb3JpdHkpXG4gICAgfVxuICAgIC8vIHJlbmRlciB0aGUgbmV3IHRhc2tzXG4gICAgLy8gb3RoZXIgdGFzayBmb3JtIG9uIHBhZ2Ugd2lsbCBiZSByZW1vdmVkXG4gICAgcmVuZGVyVGFza3MobWVudVNlbGVjdGVkKVxuICAgIC8vIHJlbW92ZSB0aGUgZm9ybVxuICAgIGZvcm0ucmVtb3ZlKClcbiAgICAvLyBzYXZlIHRoZSBkYXRhIHRvIGxvY2FsU3RvcmFnZVxuICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdhbGxUYXNrcycsIEpTT04uc3RyaW5naWZ5KGFsbFRhc2tzKSlcbiAgICBjb25zb2xlLmxvZyhsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnYWxsVGFza3MnKSlcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGRlbFRhc2soZSkge1xuICAgIC8vIGdldCB0aGUgcGFyZW50IGVsZW1lbnRcbiAgICBjb25zdCBwYXJlbnQgPSBlLnNyY0VsZW1lbnQucGFyZW50RWxlbWVudC5wYXJlbnRFbGVtZW50XG4gICAgLy8gdXNlIHRoZSBmdW5jdGlvbiB0byBmaW5kIHRoZSBpbmRleCBvZiB0aGUgYXJyYXkgd2hlcmUgdGhlIHRhc2sgaXMgc2F2ZWRcbiAgICBjb25zdCBpID0gKyhwYXJlbnQuaWQpXG4gICAgLy8gZGVsZXRlcyB0aGUgb2JqZWN0IGZyb20gdGhlIGFycmF5XG4gICAgYWxsVGFza3Muc3BsaWNlKGksIDEpXG4gICAgLy8gcmVtb3ZlIHRoZSBlbGVtZW50IGZyb20gdGhlIERPTVxuICAgIHBhcmVudC5yZW1vdmUoKVxuICAgIC8vIHJlLWFzc2lnbiB0aGUgaWQncyBmb3IgZWFjaCB0YXNrXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhbGxUYXNrcy5sZW5ndGg7IGkrKykge1xuICAgICAgICBhbGxUYXNrc1tpXS5zZXRJZChpKVxuICAgIH1cbiAgICByZW1vdmVUYXNrcygpXG4gICAgcmVuZGVyVGFza3MobWVudVNlbGVjdGVkKVxufVxuXG4vLyB3aWxsIG9wZW4gYW4gZWRpdCBmb3JtIGZvciB0aGUgdGFza1xuZXhwb3J0IGZ1bmN0aW9uIGVkaXRUYXNrKGUpIHtcbiAgICAvLyBnZXQgdGhlIHBhcmVudCBlbGVtZW50XG4gICAgY29uc3QgcGFyZW50ID0gZS5zcmNFbGVtZW50LnBhcmVudEVsZW1lbnQucGFyZW50RWxlbWVudFxuICAgIC8vIGZpbmQgdGhlIHRhc2sgaW4gdGhlIGFsbFRhc2tzIGFycmF5XG4gICAgY29uc3QgaSA9ICsocGFyZW50LmlkKVxuICAgIC8vIG9wZW4gdGhlIGVkaXQgd2luZG93IGJlbG93IHRoZSB0YXNrcyB0aGVuIGRlbGV0ZSB0aGUgdGFza1xuICAgIC8vIGxlYXZlIGVkaXQgbWVudSBvcGVuXG4gICAgcGFyZW50Lmluc2VydEFkamFjZW50RWxlbWVudCgnYWZ0ZXJlbmQnLCBcbiAgICBjcmVhdGVUYXNrRWRpdChhbGxUYXNrc1tpXS5nZXRUaXRsZSgpLCBhbGxUYXNrc1tpXS5nZXREYXRlKCksIFxuICAgIGFsbFRhc2tzW2ldLmdldERlc2NyaXB0aW9uKCksIGFsbFRhc2tzW2ldLmdldFByaW9yaXR5KCksIGFsbFRhc2tzW2ldLmdldElkKCkpKVxuICAgIHBhcmVudC5yZW1vdmUoKVxufVxuXG4vLyBmdW5jdGluIHJldHVybnMgdHJ1ZSBpZiB0aGUgZHVlIGRhdGUgaXMgdG9kYXkgb3IgZnJvbSB0aGUgcGFzdFxuZnVuY3Rpb24gaXNEdWVUb2RheSAoZGF0ZSkge1xuICAgIC8vIGNyZWF0ZSB0b2RheSdzIGRhdGVcbiAgICBjb25zdCB0b2RheSA9IG5ldyBEYXRlKClcbiAgICAvLyBzcGxpdCB0aGUgZGF0ZSBmcm9tIHRoZSB0YXNrIGludG8gYSBuZXcgYXJyYXlcbiAgICBjb25zdCBjdXJyZW50RGF0ZXMgPSBkYXRlLnNwbGl0KCctJylcbiAgICAvLyBpZiB0aGUgeWVhciBpcyBsZXNzIHRoYW4gY3VycmVudCB5ZWFyIHJldHVybiB0cnVlXG4gICAgaWYgKGN1cnJlbnREYXRlc1swXSA8IHRvZGF5LmdldEZ1bGxZZWFyKCkpIHJldHVybiB0cnVlO1xuICAgIC8vIGlmIG1vbnRoIGlzIG1vbnRoIGlzIGxlc3MgdGhhbiBjdXJyZW50IHJldHVybiB0cnVlXG4gICAgaWYgKGN1cnJlbnREYXRlc1sxXSA8IHRvZGF5LmdldE1vbnRoKCkpIHJldHVybiB0cnVlO1xuICAgIC8vIGlmIGRheSBpcyBsZXNzIHRoYW4gb3IgZXF1YWwgdG8gY3VycmVudCBkYXkgcmV0dXJuIHRydWVcbiAgICBpZiAoY3VycmVudERhdGVzWzJdIDw9IHRvZGF5LmdldERhdGUoKSkgcmV0dXJuIHRydWU7XG5cbiAgICByZXR1cm4gZmFsc2Vcbn1cblxuLy8gZnVuY3Rpb24gZ2V0VGFza1ZhcnMgKHBhcmVudCkge1xuLy8gICAgIC8vIGdldCB0aGUgdGl0bGUgYW5kIGRhdGVcbi8vICAgICBjb25zdCB0aXRsZSA9IHBhcmVudC5xdWVyeVNlbGVjdG9yKCcudGFzay10aXRsZScpLnRleHRDb250ZW50XG4vLyAgICAgY29uc3QgZGF0ZSA9IHBhcmVudC5xdWVyeVNlbGVjdG9yKCcudGFzay1kYXRlJykudGV4dENvbnRlbnRcblxuLy8gICAgIC8vIHJldHVybiB0aXRsZSBhbmQgZGF0ZSBhcyBhIHN0cmluZ1xuLy8gICAgIHJldHVybiB0aXRsZSArICcuJyArIGRhdGVcbi8vIH0iLCJpbXBvcnQgeyBkZWxUYXNrLCBlZGl0VGFzayB9IGZyb20gXCIuL3Rhc2stY29udHJvbC5qc1wiXG5cbi8vIGZ1bmN0aW9uIHRoYXQgcmV0dXJucyBhIHRhc2sgZm9yIHRoZSBET01cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGNyZWF0ZVRhc2sgKHRpdGxlLCBkYXRlLCBpZCwgcHJpb3JpdHkpIHtcbiAgICAvL2NyZWF0ZSBkZWZhdWx0IGRpdiB0byBob2xkIGFsbCB0aGUgaW5mb1xuICAgIGNvbnN0IHRhc2tEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuICAgIHRhc2tEaXYuY2xhc3NMaXN0LmFkZCgndGFzaycpXG4gICAgdGFza0Rpdi5jbGFzc0xpc3QuYWRkKCd0YXNrLXNwYW4nKVxuICAgIHRhc2tEaXYuaWQgPSBpZFxuXG4gICAgLy9jcmVhdGUgdHdvIGhhbHZlcyBmb3IgdGhlIGRpdiBcbiAgICBjb25zdCB0YXNrU3RhcnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuICAgIGNvbnN0IHRhc2tFbmQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuICAgIHRhc2tTdGFydC5jbGFzc0xpc3QuYWRkKCd0YXNrLXN0YXJ0JylcbiAgICB0YXNrRW5kLmNsYXNzTGlzdC5hZGQoJ3Rhc2stZW5kJylcblxuICAgIC8vY3JlYXRlIGJ1dHRvbiB0byBjb21wbGV0ZSB0YXNrXG4gICAgY29uc3QgY2hlY2tCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJylcbiAgICBjaGVja0J1dHRvbi5jbGFzc0xpc3QuYWRkKCd0YXNrLWNpcmNsZScpXG4gICAgaWYgKHByaW9yaXR5ID09IDEpe1xuICAgICAgICBjaGVja0J1dHRvbi5zdHlsZS5jc3NUZXh0ID0gJ2JveC1zaGFkb3c6IDAgMCA1cHggcmdiKDI1NSwgNjAsIDIwKSwgaW5zZXQgMCAwIDVweCByZ2IoMjU1LCA2MCwgMjApJ1xuICAgIH1cbiAgICBlbHNlIGlmIChwcmlvcml0eSA9PSAyKXtcbiAgICAgICAgY2hlY2tCdXR0b24uc3R5bGUuY3NzVGV4dCA9ICdib3gtU2hhZG93OiAwIDAgNXB4ICNDOUI0MDAsIGluc2V0IDAgMCA1cHggI0M5QjQwMCdcbiAgICB9XG4gICAgY2hlY2tCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge2RlbFRhc2soZSl9KVxuXG4gICAgLy9jcmVhdGUgZGl2IHRvIGhvbGQgdGl0bGUgb2YgdGFza1xuICAgIGNvbnN0IHRhc2tUaXRsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG4gICAgdGFza1RpdGxlLmNsYXNzTGlzdC5hZGQoJ3Rhc2stdGl0bGUnKVxuICAgIHRhc2tUaXRsZS50ZXh0Q29udGVudCA9IHRpdGxlXG5cbiAgICAvL2NyZWF0ZSBkaXYgdG8gaG9sZCB0aGUgZGF0ZVxuICAgIGNvbnN0IHRhc2tEYXRlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcbiAgICB0YXNrRGF0ZS5jbGFzc0xpc3QuYWRkKCd0YXNrLWRhdGUnKVxuICAgIHRhc2tEYXRlLnRleHRDb250ZW50ID0gZGF0ZVxuXG4gICAgLy9jcmVhdGUgdGhlIGVkaXQgYnV0dG9uL2ltZ1xuICAgIGNvbnN0IGVkaXRCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbWcnKVxuICAgIGVkaXRCdXR0b24uc3JjID0gJ2ltYWdlcy9lZGl0LnN2ZydcbiAgICBlZGl0QnV0dG9uLnNldEF0dHJpYnV0ZSgnYWx0JywgJ2VkaXQgYnV0dG9uJylcbiAgICBlZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtlZGl0VGFzayhlKX0pXG5cbiAgICAvLyBBcHBlbmQgYWxsIGVsZW1lbnRzIHRvZ2V0aGVyXG4gICAgdGFza0VuZC5hcHBlbmRDaGlsZCh0YXNrRGF0ZSlcbiAgICB0YXNrRW5kLmFwcGVuZENoaWxkKGVkaXRCdXR0b24pXG5cbiAgICB0YXNrU3RhcnQuYXBwZW5kQ2hpbGQoY2hlY2tCdXR0b24pXG4gICAgdGFza1N0YXJ0LmFwcGVuZENoaWxkKHRhc2tUaXRsZSlcblxuICAgIHRhc2tEaXYuYXBwZW5kQ2hpbGQodGFza1N0YXJ0KVxuICAgIHRhc2tEaXYuYXBwZW5kQ2hpbGQodGFza0VuZClcblxuICAgIHJldHVybiB0YXNrRGl2XG59IiwiaW1wb3J0IHsgYWRkVGl0bGUsIGdldFRpdGxlcywgZGVsZXRlVGl0bGV9IGZyb20gXCIuL3Byb2plY3RzXCJcbmltcG9ydCB7IHJlbmRlclRhc2tzIH0gZnJvbSBcIi4vdGFzay1jb250cm9sLmpzXCJcblxuLy8gdmFyaWFibGUgdXNlZCB0byBrZWVwIHRyYWNrIG9mIHdoaWNoIG1lbnUgaXRlbSBpcyBzZWxlY3RlZFxuZXhwb3J0IGxldCBtZW51U2VsZWN0ZWQgPSAnQWxsJ1xuXG4vL0FkZCBldmVudHMgdG8gdGhlIGRlZmF1bHQgbWVudSBvcHRpb25zXG5jb25zdCBtZW51SXRlbXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcubWVudS1pdGVtJylcbm1lbnVJdGVtcy5mb3JFYWNoKGFkZE1lbnVJdGVtRXZlbnQpXG5cbi8vIExvYWQgbG9jYWxTdG9yYWdlIGRhdGEgaW50byB0aGUgRE9NXG5jb25zdCBtZW51VGl0bGVzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2plY3RzJylcbmNvbnN0IGFycmF5ID0gZ2V0VGl0bGVzKClcbmZvciAobGV0IGkgPSAwOyBpIDwgYXJyYXkubGVuZ3RoOyBpKyspIHtcbiAgICBtZW51VGl0bGVzLmFwcGVuZENoaWxkKGNyZWF0ZU1lbnVJdGVtKGFycmF5W2ldKSlcbn1cblxuLy8gRXZlbnQgbGlzdGVuZXIgZm9yIHRoZSBcIitcIiBidXR0b24gYmVzaWRlIHByb2plY3QgdGl0bGVcbmNvbnN0IHBsdXNCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvamVjdC10aXRsZSA+IHN2ZycpXG5wbHVzQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgIC8vQ2FsbHMgZnVuY3Rpb24gdG8gYWRkIHRoZSBwcm9qZWN0IGZvcm0gdG8gdGhlIERPTVxuICAgIGNvbnN0IHByb2plY3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvamVjdHMnKVxuICAgIHByb2plY3QuYXBwZW5kQ2hpbGQoY3JlYXRlRm9ybSgpKVxuXG59KVxuXG4vLyBSZXR1cm5zIHRoZSBET00gZWxlbWVudCBvZiBhIG1lbnUtaXRlbSBcbi8vIGEgc2ltcGxlIHByb2plY3QgaXMgYWRkZWQgdG8gdGhlIGxpc3Qgb24gdGhlIERPTVxuZnVuY3Rpb24gY3JlYXRlTWVudUl0ZW0odGl0bGUpIHtcbiAgICAvLyAgY3JlYXRlIHRoZSBtZW51LWl0ZW0gZGl2IHRvIGhvbGQgdGhlIGVsZW1lbnRzXG4gICAgY29uc3QgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcbiAgICBkaXYuY2xhc3NMaXN0LmFkZCgnbWVudS1pdGVtJylcbiAgICAvLyBjcmVhdGUgdGhlIHRpdGxlIGRpdlxuICAgIGNvbnN0IHRpdGxlRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcbiAgICB0aXRsZURpdi50ZXh0Q29udGVudCA9IHRpdGxlXG4gICAgLy8gY3JlYXRlIHRoZSB0cmFzaCBiaW4gaW1nXG4gICAgY29uc3QgdHJhc2ggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbWcnKVxuICAgIHRyYXNoLnNldEF0dHJpYnV0ZSgnc3JjJywgJy4vaW1hZ2VzL3RyYXNoLTIuc3ZnJylcbiAgICB0cmFzaC5zZXRBdHRyaWJ1dGUoJ2FsdCcsICd0cmFzaCBpY29uJylcblxuICAgIC8vIGFkZCBldmVudGxpc3RlbmVyIHRvIHRyYXNoIGljb25cbiAgICB0cmFzaC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XG4gICAgICAgIGRlbGV0ZVRpdGxlKGUuc3JjRWxlbWVudC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nLnRleHRDb250ZW50KVxuICAgICAgICBlLnNyY0VsZW1lbnQuY2xvc2VzdCgnLm1lbnUtaXRlbScpLnJlbW92ZSgpXG4gICAgfSlcblxuICAgIC8vIGFwcGVuZCB0aGUgdHdvIGNoaWxkcmVuXG4gICAgZGl2LmFwcGVuZENoaWxkKHRpdGxlRGl2KVxuICAgIGRpdi5hcHBlbmRDaGlsZCh0cmFzaClcblxuICAgIGFkZE1lbnVJdGVtRXZlbnQoZGl2KVxuICAgIFxuICAgIHJldHVybiBkaXZcbn1cblxuLy8gcmV0dXJucyBhIGZvcm0gZm9yIERPTSB0byBiZSB1c2VkIHRvIGNyZWF0ZSBhIG5ldyBwcm9qZWN0XG5mdW5jdGlvbiBjcmVhdGVGb3JtKCkge1xuICAgIC8vIGNyZWF0ZSB0aGUgZGl2IHRoYXQgZW5jb21wYXNzZXMgdGhlIGVudGlyZSBibG9ja1xuICAgIGNvbnN0IG1lbnVGb3JtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcbiAgICBtZW51Rm9ybS5jbGFzc0xpc3QuYWRkKCdtZW51LWZvcm0nKVxuXG4gICAgLy8gY3JlYXRlIHRoZSBmb3JtIGFuZCBhZGQgYXR0cmlidXRlc1xuICAgIGNvbnN0IGZvcm0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdmb3JtJylcbiAgICBmb3JtLnNldEF0dHJpYnV0ZSgnYWN0aW9uJywgXCJcIilcbiAgICBmb3JtLnNldEF0dHJpYnV0ZSgnbWV0aG9kJywgJ3Bvc3QnKVxuXG4gICAgLy8gY3JlYXRlIHRoZSBpbnB1dCBib3ggZm9yIHRleHRcbiAgICBjb25zdCBpbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0JylcbiAgICBpbnB1dC5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCAndGV4dCcpXG4gICAgaW5wdXQuc2V0QXR0cmlidXRlKCdpZCcsICdwcm9qZWN0LXRpdGxlJylcbiAgICBpbnB1dC5zZXRBdHRyaWJ1dGUoJ25hbWUnLCAncHJvamVjdFRpdGxlJylcbiAgICBpbnB1dC5zZXRBdHRyaWJ1dGUoJ21heGxlbmd0aCcsICcxNScpXG5cbiAgICAvLyBjcmVhdGUgZGl2IHRvIGVuY29tcGFzcyBidXR0b25zXG4gICAgY29uc3QgcHJvamVjdEJ1dHRvbnMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuICAgIHByb2plY3RCdXR0b25zLmNsYXNzTGlzdC5hZGQoJ3Byb2plY3QtYnV0dG9ucycpXG5cbiAgICAvL2NyZWF0ZSB0aGUgYnV0dG9uc1xuICAgIGNvbnN0IGFkZEJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpXG4gICAgYWRkQnV0dG9uLmNsYXNzTGlzdC5hZGQoJ2FkZC1idXR0b24nKVxuICAgIGFkZEJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCAnYnV0dG9uJylcbiAgICBhZGRCdXR0b24udGV4dENvbnRlbnQgPSBcIkFkZFwiXG5cbiAgICBjb25zdCBjYW5jZWxCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKVxuICAgIGNhbmNlbEJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdjYW5jZWwtYnV0dG9uJylcbiAgICBjYW5jZWxCdXR0b24uc2V0QXR0cmlidXRlKCd0eXBlJywgJ2J1dHRvbicpXG4gICAgY2FuY2VsQnV0dG9uLnRleHRDb250ZW50ID0gXCJDYW5jZWxcIlxuXG4gICAgLy8gYWRkIGV2ZW50bGlzdGVuZXJzXG4gICAgYWRkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcbiAgICAgICAgc2F2ZShlKVxuICAgIH0pXG4gICAgY2FuY2VsQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcbiAgICAgICAgY2FuY2VsKGUpXG4gICAgfSlcblxuICAgIC8vIEFwcGVuZCB0aGUgYnV0dG9ucyB0byBwcm9qZWN0QnV0dG9uc1xuICAgIHByb2plY3RCdXR0b25zLmFwcGVuZENoaWxkKGFkZEJ1dHRvbilcbiAgICBwcm9qZWN0QnV0dG9ucy5hcHBlbmRDaGlsZChjYW5jZWxCdXR0b24pXG5cbiAgICAvLyBBcHBlbmQgaW5wdXQgdG8gZm9ybSB0aGVuIHByb2plY3RCdXR0b25zIHRvIGZvcm1cbiAgICBmb3JtLmFwcGVuZENoaWxkKGlucHV0KVxuICAgIGZvcm0uYXBwZW5kQ2hpbGQocHJvamVjdEJ1dHRvbnMpXG5cbiAgICAvLyBhcHBlbmQgZm9ybSB0byB0aGUgbWFpbiBkaXYgKG1lbnVGb3JtKVxuICAgIG1lbnVGb3JtLmFwcGVuZENoaWxkKGZvcm0pXG5cbiAgICByZXR1cm4gbWVudUZvcm1cbn1cblxuZnVuY3Rpb24gc2F2ZShlKSB7XG4gICAgLy8gc2VsZWN0IHRoZSBtZW51LWZvcm0gcGFyZW50IG5vZGVcbiAgICBjb25zdCBtZW51Rm9ybSA9IGUuc3JjRWxlbWVudC5jbG9zZXN0KCcubWVudS1mb3JtJylcbiAgICAvLyBzZWxlY3QgdGhlIGNoaWxkIG9mIG1lbnUtZm9ybSBhbmQgdGhlIGNoaWxkIG9mIHRoYXQgdG8gYXF1aXJlIHRoZSBpbnB1dCBub2RlLlxuICAgIC8vIFRha2UgdGhlIHZhbHVlIG9mIHRoZSBpbnB1dCBub2RlXG4gICAgY29uc3QgaW5wdXRUZXh0ID0gbWVudUZvcm0uZmlyc3RDaGlsZC5maXJzdENoaWxkLnZhbHVlXG4gICAgLy8gaW5zZXJ0IGEgbmV3IG1lbnUgaXRlbSBhZnRlciB0aGUgZm9ybVxuICAgIG1lbnVGb3JtLmluc2VydEFkamFjZW50RWxlbWVudCgnYWZ0ZXJlbmQnLCBjcmVhdGVNZW51SXRlbShpbnB1dFRleHQpKVxuICAgIC8vIGFkZCB0aGUgdGl0bGUgdG8gdGhlIGFycmF5IFxuICAgIGFkZFRpdGxlKGlucHV0VGV4dClcblxuICAgIC8vIHdoZW4gZXZlcnl0aGluZyBpcyBkb25lLCBkZWxldGUgdGhlIGZvcm1cbiAgICBjYW5jZWwoZSlcbn1cblxuLy8gZnVuY3Rpb24gdXNlZCB0byBkZWxldGUgbWVudS1mb3JtXG5mdW5jdGlvbiBjYW5jZWwoZSkge1xuICAgIC8vIGZpbmQgdGhlIGNsb3Nlc3QgbWVudSBmb3JtIGFuZCByZW1vdmUgaXRcbiAgICBlLnNyY0VsZW1lbnQuY2xvc2VzdCgnLm1lbnUtZm9ybScpLnJlbW92ZSgpXG59XG5cbi8vIGFkZCBldmVudCBsaXN0ZW5lciBmb3IgYSBtZW51LWl0ZW1cbmZ1bmN0aW9uIGFkZE1lbnVJdGVtRXZlbnQgKGl0ZW0pIHtcbiAgICBpdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcbiAgICAgICAgLy8gcmVtb3ZlcyB0aGUgY2xhc3MgdGhhdCBpcyBoaWdobGlnaHRpbmcgdGhlIGN1cnJlbnRseSBzZWxlY3RlZCBpdGVtXG4gICAgICAgIGNvbnN0IGN1cnJlbnRTZWxlY3RlZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tZW51LXNlbGVjdGVkJylcbiAgICAgICAgLy8gbWFrZSBzdXJlIGN1cnJlbnRTZWxlY3RlZCBpc24ndCBudWxsIHRvIHByZXZlbnQgYW4gZXJyb3JcbiAgICAgICAgLy8gY3VycmVudFNlbGVjdGVkIHdpbGwgYmUgbnVsbCB3aGVuIHRoZSB0cmFzaCBpY29uIGlzIGNsaWNrZWQgdG8gZGVsZXRlXG4gICAgICAgIGlmIChjdXJyZW50U2VsZWN0ZWQgIT0gbnVsbCl7XG4gICAgICAgICAgICBjdXJyZW50U2VsZWN0ZWQuY2xhc3NMaXN0LnJlbW92ZSgnbWVudS1zZWxlY3RlZCcpXG4gICAgICAgIH1cbiAgICAgICAgLy9hZGQgdGhlIG1lbnUtc2VsZWN0ZWQgY2xhc3MgdG8gdGhlIGl0ZW0gdGhhdCB3YXMgc2VsZWN0ZWRcbiAgICAgICAgZS5zcmNFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ21lbnUtc2VsZWN0ZWQnKVxuICAgICAgICAvLyBjYWxsIGZ1bmN0aW9uIHRvIHJlbmRlciB0aGUgdGFza3NcbiAgICAgICAgbWVudVNlbGVjdGVkID0gZS5zcmNFbGVtZW50LmZpcnN0Q2hpbGQudGV4dENvbnRlbnRcbiAgICAgICAgcmVuZGVyVGFza3MobWVudVNlbGVjdGVkKVxuICAgIH0pXG59XG4iXSwibmFtZXMiOlsicHJvamVjdFRpdGxlcyIsImxvY2FsU3RvcmFnZSIsImdldEl0ZW0iLCJzcGxpdCIsInNldEl0ZW0iLCJ0YXNrIiwidGl0bGUiLCJkYXRlIiwiZGVzY3JpcHRpb24iLCJwcmlvcml0eSIsInByb2plY3QiLCJpZCIsIm9iaiIsIk9iamVjdCIsImNyZWF0ZSIsInRhc2tQcm90byIsImdldFRpdGxlIiwidGhpcyIsInNldFRpdGxlIiwiZ2V0RGVzY3JpcHRpb24iLCJzZXREZXNjcmlwdGlvbiIsImdldERhdGUiLCJzZXREYXRlIiwiZ2V0UHJpb3JpdHkiLCJzZXRQcmlvcml0eSIsImdldFByb2plY3QiLCJzZXRQcm9qZWN0IiwiZ2V0SWQiLCJzZXRJZCIsImNyZWF0ZVRhc2tFZGl0IiwidGFza0Zvcm0iLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJjbGFzc0xpc3QiLCJhZGQiLCJmb3JtIiwic2V0QXR0cmlidXRlIiwidG9wRWRpdCIsImVkaXRUaXRsZSIsInZhbHVlIiwiZGF0ZURpdiIsImRhdGVMYWJlbCIsInRleHRDb250ZW50IiwiaW5wdXREYXRlIiwiYXBwZW5kQ2hpbGQiLCJ0ZXh0QXJlYURpdiIsInRleHRBcmVhIiwibG93ZXJEaXYiLCJlbmNvbXBhc0RpdiIsInByaW9yaXR5TGFiZWwiLCJwcmlvcml0eVNlbGVjdCIsImkiLCJjcmVhdGVPcHRpb24iLCJidXR0b25EaXYiLCJkZWxCdXR0b24iLCJhZGRFdmVudExpc3RlbmVyIiwiZSIsImRlbFRhc2siLCJzYXZlQnV0dG9uIiwic3JjRWxlbWVudCIsImNsb3Nlc3QiLCJxdWVyeVNlbGVjdG9yIiwiYWxsVGFza3MiLCJsZW5ndGgiLCJwdXNoIiwibWVudVNlbGVjdGVkIiwicmVuZGVyVGFza3MiLCJyZW1vdmUiLCJKU09OIiwic3RyaW5naWZ5IiwiY29uc29sZSIsImxvZyIsInNhdmUiLCJvcHRpb24iLCJwYXJzZSIsImZvckVhY2giLCJpdGVtIiwiaW5kZXgiLCJhZGRUYXNrIiwicmVtb3ZlVGFza3MiLCJuZXdBcnJheSIsImZpbHRlciIsInRvZGF5IiwiRGF0ZSIsImN1cnJlbnREYXRlcyIsImdldEZ1bGxZZWFyIiwiZ2V0TW9udGgiLCJpc0R1ZVRvZGF5IiwidGFza3NEaXYiLCJlbGUiLCJ0YXNrRGl2IiwidGFza1N0YXJ0IiwidGFza0VuZCIsImNoZWNrQnV0dG9uIiwic3R5bGUiLCJjc3NUZXh0IiwidGFza1RpdGxlIiwidGFza0RhdGUiLCJlZGl0QnV0dG9uIiwic3JjIiwicGFyZW50IiwicGFyZW50RWxlbWVudCIsImluc2VydEFkamFjZW50RWxlbWVudCIsImVkaXRUYXNrIiwiY3JlYXRlVGFzayIsImluc2VydEJlZm9yZSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJzcGxpY2UiLCJhZGRNZW51SXRlbUV2ZW50IiwibWVudVRpdGxlcyIsImFycmF5IiwiY3JlYXRlTWVudUl0ZW0iLCJkaXYiLCJ0aXRsZURpdiIsInRyYXNoIiwiaW5kZXhPZiIsImRlbGV0ZVRpdGxlIiwicHJldmlvdXNFbGVtZW50U2libGluZyIsImNhbmNlbCIsImN1cnJlbnRTZWxlY3RlZCIsImZpcnN0Q2hpbGQiLCJtZW51Rm9ybSIsImlucHV0IiwicHJvamVjdEJ1dHRvbnMiLCJhZGRCdXR0b24iLCJjYW5jZWxCdXR0b24iLCJpbnB1dFRleHQiLCJjcmVhdGVGb3JtIl0sInNvdXJjZVJvb3QiOiIifQ==