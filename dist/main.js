(()=>{"use strict";let t=[];localStorage.getItem("projectTitles")?t=localStorage.getItem("projectTitles").split(","):localStorage.setItem("projectTitles",[]);const e=(t,e,s,r,i,c)=>{let l=Object.create(n);return l.title=t,l.description=s,l.date=e,l.priority=r,l.project=i,l.id=c,l},n={getTitle(){return this.title},setTitle(t){this.title=t},getDescription(){return this.description},setDescription(t){this.description=t},getDate(){return this.date},setDate(t){this.date=t},getPriority(){return this.priority},setPriority(t){this.priority=t},getProject(){return this.project},setProject(t){this.project=t},getId(){return this.id},setId(t){this.id=t}};function s(t,n,s,c,o){const u=document.createElement("div");u.classList.add("task-span"),u.classList.add("task-form"),u.id=o;const m=document.createElement("form");m.setAttribute("action",""),m.setAttribute("method","post");const p=document.createElement("div");p.classList.add("top-form-task");const h=document.createElement("input");h.setAttribute("type","text"),h.setAttribute("id","title-edit"),h.setAttribute("placeholder","Title"),h.setAttribute("name","title-edit"),h.setAttribute("maxlength","20"),h.value=t;const E=document.createElement("div"),g=document.createElement("label");g.textContent="Date: ",g.setAttribute("for","date");const v=document.createElement("input");v.setAttribute("type","date"),v.setAttribute("id","date"),v.setAttribute("name","date"),v.value=n,E.appendChild(g),E.appendChild(v),p.appendChild(h),p.appendChild(E),m.appendChild(p);const f=document.createElement("div");f.classList.add("textarea-div");const b=document.createElement("textarea");b.setAttribute("placeholder","Description"),b.value=s,f.appendChild(b),m.appendChild(f);const C=document.createElement("div");C.classList.add("lower-form-task");const y=document.createElement("div"),A=document.createElement("label");A.textContent="Priority: ",A.setAttribute("for","priority");const k=document.createElement("select");k.setAttribute("name","priority"),k.setAttribute("id","priority");for(let t=3;t>=1;t--)k.appendChild(r(t));k.value=c,y.appendChild(A),y.appendChild(k);const L=document.createElement("div"),S=document.createElement("button");S.textContent="Del",S.setAttribute("type","button"),S.addEventListener("click",(t=>{a(t)}));const x=document.createElement("button");return x.textContent="Save",x.setAttribute("type","button"),x.addEventListener("click",(t=>{!function(t){const n=t.srcElement.closest(".task-form"),s=n.querySelector("#title-edit").value,r=n.querySelector("#date").value,c=n.querySelector("textarea").value,o=n.querySelector("#priority").value;let a=n.id;"null"==n.id?(a=i.length,i.push(e(s,r,c,o,d,a))):(i[+a].setTitle(s),i[+a].setDate(r),i[+a].setDescription(c),i[+a].setPriority(o)),l(d),n.remove(),localStorage.setItem("allTasks",JSON.stringify(i))}(t)})),L.appendChild(S),L.appendChild(x),C.appendChild(y),C.appendChild(L),m.appendChild(C),u.appendChild(m),u}function r(t){const e=document.createElement("option");return e.textContent=t,e.setAttribute("value",t),e}let i=[];null!=JSON.parse(localStorage.getItem("allTasks"))&&(i=JSON.parse(localStorage.getItem("allTasks")),i.forEach(((t,n)=>{i[n]=e(t.title,t.date,t.description,t.priority,t.project,t.id)}))),l("All");const c=document.querySelector(".add-task");function l(t){o();const e=i.filter((e=>"Today"==t?function(t){if(""==t)return!1;let e=new Date;const n=t.split("-");if(n[0]<e.getFullYear())return!0;if(n[0]==e.getFullYear()){if(n[1]<e.getMonth()+1)return!0;if(+n[1]==e.getMonth()+1&&n[2]<=e.getDate())return!0}return!1}(e.getDate()):"Important"==t?1==e.getPriority():"All"==t||e.getProject()==t)),n=document.querySelector(".add-task"),r=document.querySelector("#tasks");e.forEach((t=>{const e=function(t,e,n,r){const c=document.createElement("div");c.classList.add("task"),c.classList.add("task-span"),c.id=n;const l=document.createElement("div"),o=document.createElement("div");l.classList.add("task-start"),o.classList.add("task-end");const d=document.createElement("span");d.classList.add("task-circle"),1==r?d.style.cssText="box-shadow: 0 0 5px rgb(255, 60, 20), inset 0 0 5px rgb(255, 60, 20)":2==r&&(d.style.cssText="box-Shadow: 0 0 5px #C9B400, inset 0 0 5px #C9B400"),d.addEventListener("click",(t=>{a(t)}));const u=document.createElement("div");u.classList.add("task-title"),u.textContent=t;const m=document.createElement("div");m.classList.add("task-date"),m.textContent=e;const p=document.createElement("img");return p.src="images/edit.svg",p.setAttribute("alt","edit button"),p.addEventListener("click",(t=>{!function(t){const e=t.srcElement.parentElement.parentElement,n=+e.id;e.insertAdjacentElement("afterend",s(i[n].getTitle(),i[n].getDate(),i[n].getDescription(),i[n].getPriority(),i[n].getId())),e.remove()}(t)})),o.appendChild(m),o.appendChild(p),l.appendChild(d),l.appendChild(u),c.appendChild(l),c.appendChild(o),c}(t.getTitle(),t.getDate(),t.getId(),t.getPriority());r.insertBefore(e,n)}))}function o(){document.querySelectorAll(".task-span").forEach((t=>{t.remove()}))}function a(t){let e="";e="task-circle"==t.srcElement.classList.value?t.srcElement.parentElement.parentElement:t.srcElement.closest(".task-form");const n=+e.id;i.splice(n,1),e.remove();for(let t=0;t<i.length;t++)i[t].setId(t);localStorage.setItem("allTasks",JSON.stringify(i)),o(),l(d)}c.addEventListener("click",(()=>{document.querySelector("#tasks").insertBefore(s(null,null,null,3,"null"),c)}));let d="All";document.querySelectorAll(".menu-item").forEach(E);const u=document.querySelector(".projects"),m=t;for(let t=0;t<m.length;t++)u.appendChild(p(m[t]));function p(e){const n=document.createElement("div");n.classList.add("menu-item");const s=document.createElement("div");s.textContent=e;const r=document.createElement("img");return r.setAttribute("src","./images/trash-2.svg"),r.setAttribute("alt","trash icon"),r.addEventListener("click",(e=>{!function(e){const n=t.indexOf(e);n>-1&&(t.splice(n,1),localStorage.setItem("projectTitles",t))}(e.srcElement.previousElementSibling.textContent),e.srcElement.closest(".menu-item").remove()})),n.appendChild(s),n.appendChild(r),E(n),n}function h(t){t.srcElement.closest(".menu-form").remove()}function E(t){t.addEventListener("click",(t=>{const e=document.querySelector(".menu-selected");null!=e&&e.classList.remove("menu-selected"),t.srcElement.classList.add("menu-selected");try{d=t.srcElement.firstChild.textContent}catch(t){console.log("Project Deleted")}l(d)}))}document.querySelector(".project-title > svg").addEventListener("click",(()=>{document.querySelector(".projects").appendChild(function(){const e=document.createElement("div");e.classList.add("menu-form");const n=document.createElement("form");n.setAttribute("action",""),n.setAttribute("method","post");const s=document.createElement("input");s.setAttribute("type","text"),s.setAttribute("id","project-title"),s.setAttribute("name","projectTitle"),s.setAttribute("maxlength","15");const r=document.createElement("div");r.classList.add("project-buttons");const i=document.createElement("button");i.classList.add("add-button"),i.setAttribute("type","button"),i.textContent="Add";const c=document.createElement("button");return c.classList.add("cancel-button"),c.setAttribute("type","button"),c.textContent="Cancel",i.addEventListener("click",(e=>{!function(e){const n=e.srcElement.closest(".menu-form"),s=n.firstChild.firstChild.value;var r;n.insertAdjacentElement("afterend",p(s)),r=s,t.push(r),localStorage.setItem("projectTitles",t),h(e)}(e)})),c.addEventListener("click",(t=>{h(t)})),r.appendChild(i),r.appendChild(c),n.appendChild(s),n.appendChild(r),e.appendChild(n),e}())}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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TCxFQUFTSixXQUFXQSxXQUFXL0UsTUx4R3JELElBQWtCakMsRUswR2RvSCxFQUFTdEIsc0JBQXNCLFdBQVlTLEVBQWVrQixJTDFHNUN6SCxFSzRHTHlILEVMM0dUL0gsRUFBY2dFLEtBQUsxRCxHQUNuQkwsYUFBYUcsUUFBUSxnQkFBaUJKLEdLNkd0Q29ILEVBQU81RCxFQUNYLENBakNRLENBQUtBLEVBQUMsSUFFVnNFLEVBQWF2RSxpQkFBaUIsU0FBVUMsSUFDcEM0RCxFQUFPNUQsRUFBQyxJQUlab0UsRUFBZWhGLFlBQVlpRixHQUMzQkQsRUFBZWhGLFlBQVlrRixHQUczQjNGLEVBQUtTLFlBQVkrRSxHQUNqQnhGLEVBQUtTLFlBQVlnRixHQUdqQkYsRUFBUzlFLFlBQVlULEdBRWR1RixDQUNYLENBdEZ3Qk0sR0FBWSxHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdG8tZG8tbGlzdC8uL3NyYy9qcy1tb2R1bGVzL3Byb2plY3RzLmpzIiwid2VicGFjazovL3RvLWRvLWxpc3QvLi9zcmMvanMtbW9kdWxlcy90YXNrLW9iamVjdC5qcyIsIndlYnBhY2s6Ly90by1kby1saXN0Ly4vc3JjL2pzLW1vZHVsZXMvdGFzay1lZGl0LWRvbS5qcyIsIndlYnBhY2s6Ly90by1kby1saXN0Ly4vc3JjL2pzLW1vZHVsZXMvdGFzay1jb250cm9sLmpzIiwid2VicGFjazovL3RvLWRvLWxpc3QvLi9zcmMvanMtbW9kdWxlcy90YXNrLWRvbS5qcyIsIndlYnBhY2s6Ly90by1kby1saXN0Ly4vc3JjL2pzLW1vZHVsZXMvcHJvamVjdHMtY29udHJvbC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBjcmVhdGUgYXJyYXkgZm9yIHByb2dyYW0gdG8gcnVuIG9mZlxubGV0IHByb2plY3RUaXRsZXMgPSBbXVxuXG4vLyBjaGVjayBpZiB0aGVyZSBpcyBhbnkgbG9jYWxzdG9yYWdlLCBpZiBub3QgY3JlYXRlIG5ldyBhcnJheSBpbiBsb2NhbHN0b3JhZ2VcbmlmICghbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3Byb2plY3RUaXRsZXMnKSkge1xuICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdwcm9qZWN0VGl0bGVzJywgW10pXG4gIH0gZWxzZSB7XG4gICAgLy8gbG9hZCBsb2NhbFN0b3JhZ2UgZGF0YSBpbnRvIG1lbW9yeVxuICAgIHByb2plY3RUaXRsZXMgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgncHJvamVjdFRpdGxlcycpLnNwbGl0KCcsJylcbiAgfVxuXG5mdW5jdGlvbiBhZGRUaXRsZSh0aXRsZSkge1xuICAgIHByb2plY3RUaXRsZXMucHVzaCh0aXRsZSlcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgncHJvamVjdFRpdGxlcycsIHByb2plY3RUaXRsZXMpXG59XG5cbmZ1bmN0aW9uIGdldFRpdGxlcygpIHtcbiAgICByZXR1cm4gcHJvamVjdFRpdGxlcztcbn1cblxuZnVuY3Rpb24gZGVsZXRlVGl0bGUodGl0bGUpIHtcbiAgICBjb25zdCBpbmRleCA9IHByb2plY3RUaXRsZXMuaW5kZXhPZih0aXRsZSk7XG4gICAgaWYgKGluZGV4ID4gLTEpIHsgLy8gb25seSBzcGxpY2UgYXJyYXkgd2hlbiBpdGVtIGlzIGZvdW5kXG4gICAgICAgIHByb2plY3RUaXRsZXMuc3BsaWNlKGluZGV4LCAxKTsgLy8gMm5kIHBhcmFtZXRlciBtZWFucyByZW1vdmUgb25lIGl0ZW0gb25seVxuICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgncHJvamVjdFRpdGxlcycsIHByb2plY3RUaXRsZXMpXG4gICAgfVxufVxuXG5leHBvcnQge2FkZFRpdGxlLCBnZXRUaXRsZXMsIGRlbGV0ZVRpdGxlfTtcbiIsIi8vIGZhY3RvcnkgZnVuY3Rpb24gdXNlZCB0byBjb25zdHJ1Y3QgdGFzayBvYmplY3RcbmV4cG9ydCBjb25zdCB0YXNrID0gKHRpdGxlLCBkYXRlLCBkZXNjcmlwdGlvbiwgcHJpb3JpdHksIHByb2plY3QsIGlkKSA9PiB7XG4gICAgbGV0IG9iaiA9IE9iamVjdC5jcmVhdGUodGFza1Byb3RvKVxuICAgIG9iai50aXRsZSA9IHRpdGxlXG4gICAgb2JqLmRlc2NyaXB0aW9uID0gZGVzY3JpcHRpb25cbiAgICBvYmouZGF0ZSA9IGRhdGVcbiAgICBvYmoucHJpb3JpdHkgPSBwcmlvcml0eVxuICAgIC8vIHZhcmlhYmxlIHVzZWQgdG8gZGV0ZXJtaW5lIHdoYXQgcHJvamVjdCB0aGUgdGFzayBpcyBpblxuICAgIG9iai5wcm9qZWN0ID0gcHJvamVjdFxuICAgIG9iai5pZCA9IGlkXG4gICAgcmV0dXJuIG9ialxufVxuXG4vL0dyZWF0IHByb3RvdHlwZSBmb3IgdGFzaygpIHRvIHN0b3JlIGFsbCB0aGUgbWV0aG9kcyBmb3IgcHJvZ3JhbSB0byBydW4gZmFzdGVyXG5jb25zdCB0YXNrUHJvdG8gPSB7XG4gICAgLy8gY3JlYXRlIGFsbCBnZXR0ZXJzIGFuZCBzZXR0ZXJzIChvbmx5IGZvciBtZW1vcnkgdXNlKVxuICAgIGdldFRpdGxlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy50aXRsZVxuICAgIH0sXG4gICAgc2V0VGl0bGUodGl0bGUpIHtcbiAgICAgICAgdGhpcy50aXRsZSA9IHRpdGxlXG4gICAgfSxcbiAgICBnZXREZXNjcmlwdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGVzY3JpcHRpb25cbiAgICB9LFxuICAgIHNldERlc2NyaXB0aW9uKGRlc2NyaXB0aW9uKSB7XG4gICAgICAgIHRoaXMuZGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvblxuICAgIH0sXG4gICAgZ2V0RGF0ZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGF0ZVxuICAgIH0sXG4gICAgc2V0RGF0ZShkYXRlKSB7XG4gICAgICAgIHRoaXMuZGF0ZSA9IGRhdGVcbiAgICB9LFxuICAgIGdldFByaW9yaXR5KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcmlvcml0eVxuICAgIH0sXG4gICAgc2V0UHJpb3JpdHkocHJpb3JpdHkpIHtcbiAgICAgICAgdGhpcy5wcmlvcml0eSA9IHByaW9yaXR5XG4gICAgfSxcbiAgICBnZXRQcm9qZWN0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcm9qZWN0XG4gICAgfSxcbiAgICBzZXRQcm9qZWN0KHByb2plY3QpIHtcbiAgICAgICAgdGhpcy5wcm9qZWN0ID0gcHJvamVjdFxuICAgIH0sXG4gICAgZ2V0SWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmlkXG4gICAgfSxcbiAgICBzZXRJZChpZCkge1xuICAgICAgICB0aGlzLmlkID0gaWRcbiAgICB9LFxufVxuXG4iLCJpbXBvcnQgeyBzYXZlIH0gZnJvbSAnLi90YXNrLWNvbnRyb2wuanMnXG5pbXBvcnQgeyBkZWxUYXNrIH0gZnJvbSAnLi90YXNrLWNvbnRyb2wuanMnXG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGNyZWF0ZVRhc2tFZGl0ICh0aXRsZSwgZGF0ZSwgZGVzY3JpcHRpb24sIHByaW9yaXR5LCBpZCkge1xuICAgIC8vY3JlYXRlIGRpdiB0byBob2xkIGFsbCB0aGUgZWxlbWVudHNcbiAgICBjb25zdCB0YXNrRm9ybSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG4gICAgdGFza0Zvcm0uY2xhc3NMaXN0LmFkZCgndGFzay1zcGFuJylcbiAgICB0YXNrRm9ybS5jbGFzc0xpc3QuYWRkKCd0YXNrLWZvcm0nKVxuICAgIHRhc2tGb3JtLmlkID0gaWRcblxuICAgIC8vY3JlYXRlIHRoZSBmb3JtIFxuICAgIGNvbnN0IGZvcm0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdmb3JtJylcbiAgICBmb3JtLnNldEF0dHJpYnV0ZSgnYWN0aW9uJywgJycpXG4gICAgZm9ybS5zZXRBdHRyaWJ1dGUoJ21ldGhvZCcsICdwb3N0JylcblxuICAgIC8vc3RhcnQgYnkgY3JlYXRpbmcgZWxlbWVudHMgZm9yIHRoZSB0b3Agb2YgdGhlIGZvcm1cbiAgICAvL3RoZSB0aXRsZSBhbmQgZGF0ZSBhcmUgaW5sY3VkZWQgaGVyZVxuICAgIGNvbnN0IHRvcEVkaXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuICAgIHRvcEVkaXQuY2xhc3NMaXN0LmFkZCgndG9wLWZvcm0tdGFzaycpXG5cbiAgICAvL2lucHV0IGZvciB0aGUgdGl0bGVcbiAgICBjb25zdCBlZGl0VGl0bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpXG4gICAgZWRpdFRpdGxlLnNldEF0dHJpYnV0ZSgndHlwZScsICd0ZXh0JylcbiAgICBlZGl0VGl0bGUuc2V0QXR0cmlidXRlKCdpZCcsICd0aXRsZS1lZGl0JylcbiAgICBlZGl0VGl0bGUuc2V0QXR0cmlidXRlKCdwbGFjZWhvbGRlcicsICdUaXRsZScpXG4gICAgZWRpdFRpdGxlLnNldEF0dHJpYnV0ZSgnbmFtZScsICd0aXRsZS1lZGl0JylcbiAgICBlZGl0VGl0bGUuc2V0QXR0cmlidXRlKCdtYXhsZW5ndGgnLCAnMjAnKVxuICAgIGVkaXRUaXRsZS52YWx1ZSA9IHRpdGxlIFxuXG4gICAgLy9pbnB1dCBmb3IgdGhlIGRhdGVcbiAgICBjb25zdCBkYXRlRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcbiAgICBjb25zdCBkYXRlTGFiZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsYWJlbCcpXG4gICAgZGF0ZUxhYmVsLnRleHRDb250ZW50ID0gJ0RhdGU6ICdcbiAgICBkYXRlTGFiZWwuc2V0QXR0cmlidXRlKCdmb3InLCAnZGF0ZScpXG4gICAgIFxuICAgIGNvbnN0IGlucHV0RGF0ZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0JylcbiAgICBpbnB1dERhdGUuc2V0QXR0cmlidXRlKCd0eXBlJywgJ2RhdGUnKVxuICAgIGlucHV0RGF0ZS5zZXRBdHRyaWJ1dGUoJ2lkJywgJ2RhdGUnKVxuICAgIGlucHV0RGF0ZS5zZXRBdHRyaWJ1dGUoJ25hbWUnLCAnZGF0ZScpXG4gICAgaW5wdXREYXRlLnZhbHVlID0gZGF0ZSBcblxuICAgIC8vYXBwZW5kIHRoZSB0b3AgdG9nZXRoZXIgYW5kIGFkZCBpdCB0byB0aGUgZnVsbCBmb3JtXG4gICAgZGF0ZURpdi5hcHBlbmRDaGlsZChkYXRlTGFiZWwpXG4gICAgZGF0ZURpdi5hcHBlbmRDaGlsZChpbnB1dERhdGUpXG5cbiAgICB0b3BFZGl0LmFwcGVuZENoaWxkKGVkaXRUaXRsZSlcbiAgICB0b3BFZGl0LmFwcGVuZENoaWxkKGRhdGVEaXYpXG5cbiAgICBmb3JtLmFwcGVuZENoaWxkKHRvcEVkaXQpXG5cbiAgICAvL2NyZWF0ZSB0aGUgdGV4dGFyZWFcbiAgICBjb25zdCB0ZXh0QXJlYURpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG4gICAgdGV4dEFyZWFEaXYuY2xhc3NMaXN0LmFkZCgndGV4dGFyZWEtZGl2JylcblxuICAgIGNvbnN0IHRleHRBcmVhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGV4dGFyZWEnKVxuICAgIHRleHRBcmVhLnNldEF0dHJpYnV0ZSgncGxhY2Vob2xkZXInLCAnRGVzY3JpcHRpb24nKVxuICAgIHRleHRBcmVhLnZhbHVlID0gZGVzY3JpcHRpb24gXG5cbiAgICB0ZXh0QXJlYURpdi5hcHBlbmRDaGlsZCh0ZXh0QXJlYSlcbiAgICBmb3JtLmFwcGVuZENoaWxkKHRleHRBcmVhRGl2KVxuXG4gICAgLy9jcmVhdGUgdGhlIGJvdHRvbSBvZiB0aGUgZm9ybVxuICAgIGNvbnN0IGxvd2VyRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcbiAgICBsb3dlckRpdi5jbGFzc0xpc3QuYWRkKCdsb3dlci1mb3JtLXRhc2snKVxuXG4gICAgY29uc3QgZW5jb21wYXNEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuXG4gICAgY29uc3QgcHJpb3JpdHlMYWJlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xhYmVsJylcbiAgICBwcmlvcml0eUxhYmVsLnRleHRDb250ZW50ID0gJ1ByaW9yaXR5OiAnXG4gICAgcHJpb3JpdHlMYWJlbC5zZXRBdHRyaWJ1dGUoJ2ZvcicsICdwcmlvcml0eScpXG5cbiAgICBjb25zdCBwcmlvcml0eVNlbGVjdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NlbGVjdCcpXG4gICAgcHJpb3JpdHlTZWxlY3Quc2V0QXR0cmlidXRlKCduYW1lJywgJ3ByaW9yaXR5JylcbiAgICBwcmlvcml0eVNlbGVjdC5zZXRBdHRyaWJ1dGUoJ2lkJywgJ3ByaW9yaXR5JylcblxuICAgIC8vdXNlIGEgbG9vcCB0byBhZGQgMyBvcHRpb25zIHRvIHRoZSBET01cbiAgICBmb3IgKGxldCBpID0gMzsgaSA+PSAxOyBpLS0pIHtcbiAgICAgICAgLy91c2UgYSBmdW5jdGlvbiB0byByZXR1cm4gdGhlIERPTSBvcHRpb24gZWxlbWVudFxuICAgICAgICBwcmlvcml0eVNlbGVjdC5hcHBlbmRDaGlsZChjcmVhdGVPcHRpb24oaSkpXG4gICAgfVxuICAgIC8vIGFmdGVyIGNyZWF0aW5nIG9wdGlvbnMsIGdpdmUgdmFsdWUgdG8gcHJpb3JpdHlTZWxlY3RcbiAgICBwcmlvcml0eVNlbGVjdC52YWx1ZSA9IHByaW9yaXR5IFxuXG4gICAgLy9hcHBlbmQgdGhlIHByaW9yaXR5IGVsZW1lbnRzIHRvIHRoZSBkaXZcbiAgICBlbmNvbXBhc0Rpdi5hcHBlbmRDaGlsZChwcmlvcml0eUxhYmVsKVxuICAgIGVuY29tcGFzRGl2LmFwcGVuZENoaWxkKHByaW9yaXR5U2VsZWN0KVxuXG4gICAgLy8gY3JlYXRlIHRoZSBTYXZlIGFuZCBEZWxldGUgYnV0dG9ucyBpbiB0aGVpciBvd24gZGl2XG4gICAgY29uc3QgYnV0dG9uRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcblxuICAgIGNvbnN0IGRlbEJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpXG4gICAgZGVsQnV0dG9uLnRleHRDb250ZW50ID0gJ0RlbCdcbiAgICBkZWxCdXR0b24uc2V0QXR0cmlidXRlKCd0eXBlJywgJ2J1dHRvbicpXG4gICAgZGVsQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtkZWxUYXNrKGUpfSlcblxuICAgIGNvbnN0IHNhdmVCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKVxuICAgIHNhdmVCdXR0b24udGV4dENvbnRlbnQgPSAnU2F2ZSdcbiAgICBzYXZlQnV0dG9uLnNldEF0dHJpYnV0ZSgndHlwZScsICdidXR0b24nKVxuICAgIHNhdmVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge3NhdmUoZSl9KVxuXG4gICAgYnV0dG9uRGl2LmFwcGVuZENoaWxkKGRlbEJ1dHRvbilcbiAgICBidXR0b25EaXYuYXBwZW5kQ2hpbGQoc2F2ZUJ1dHRvbilcblxuICAgIC8vIGFwcGVuZCB0aGUgbG93ZXIgZWxlbWVudHMgXG4gICAgbG93ZXJEaXYuYXBwZW5kQ2hpbGQoZW5jb21wYXNEaXYpXG4gICAgbG93ZXJEaXYuYXBwZW5kQ2hpbGQoYnV0dG9uRGl2KVxuICAgIC8vYXBwZW5kIHRoZSBsb3dlciBkaXYgdG8gdGhlIGZvcm1cbiAgICBmb3JtLmFwcGVuZENoaWxkKGxvd2VyRGl2KVxuICAgIC8vYXBwZW5kIGZvcm0gdG8gdGhlIHRhc2sgZGl2XG4gICAgdGFza0Zvcm0uYXBwZW5kQ2hpbGQoZm9ybSlcblxuICAgIHJldHVybiB0YXNrRm9ybVxufVxuXG4vLyBjcmVhdGVzIG9wdGlvbnMgZm9yIHRoZSBwcmlvcml0eSBlbGVtZW50XG5mdW5jdGlvbiBjcmVhdGVPcHRpb24gKGkpIHtcbiAgICBjb25zdCBvcHRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvcHRpb24nKVxuICAgIG9wdGlvbi50ZXh0Q29udGVudCA9IGlcbiAgICBvcHRpb24uc2V0QXR0cmlidXRlKCd2YWx1ZScsIGkpXG4gICAgcmV0dXJuIG9wdGlvblxufVxuXG4iLCJpbXBvcnQgeyB0YXNrIH0gZnJvbSAnLi90YXNrLW9iamVjdC5qcydcbmltcG9ydCBjcmVhdGVUYXNrIGZyb20gJy4vdGFzay1kb20uanMnXG5pbXBvcnQgY3JlYXRlVGFza0VkaXQgZnJvbSAnLi90YXNrLWVkaXQtZG9tLmpzJ1xuaW1wb3J0IHsgbWVudVNlbGVjdGVkIGFzIG1lbnVTZWxlY3RlZH0gZnJvbSAnLi9wcm9qZWN0cy1jb250cm9sLmpzJ1xuLy9sb2NhbFN0b3JhZ2UuY2xlYXIoKVxuLy8gY3JlYXRlIGFuIGFycmF5IHRvIHN0b3JlIGFsbCB0aGUgdGFza3NcbmxldCBhbGxUYXNrcyA9IFtdXG5cbmlmIChKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdhbGxUYXNrcycpKSAhPSBudWxsKSB7XG4gICAgYWxsVGFza3MgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdhbGxUYXNrcycpKVxuICAgIC8vIGFzc2lnbiB0aGUgcHJvdG90eXBlIGJlY2F1c2UgaXQgaXNuJ3Qgc2F2ZWQgd2l0aCBsb2NhbFN0b3JhZ2VcbiAgICBhbGxUYXNrcy5mb3JFYWNoKChpdGVtLCBpbmRleCkgPT4ge1xuICAgICAgICBhbGxUYXNrc1tpbmRleF0gPSB0YXNrKGl0ZW0udGl0bGUsIGl0ZW0uZGF0ZSwgaXRlbS5kZXNjcmlwdGlvbiwgaXRlbS5wcmlvcml0eSwgaXRlbS5wcm9qZWN0LCBpdGVtLmlkKVxuICAgIH0pXG59XG5cbi8vIHJlbmRlciB0aGUgdGFza3Mgd2hlbiBwYWdlIGlzIHJlbG9hZGVkIG9yIG9wZW5lZFxuLy8gcmVuZGVyZWQgYWZ0ZXIgdGFza3MgaGF2ZSBiZWVuIGxvYWRlZCBpbnRvIG1lbW9yeVxucmVuZGVyVGFza3MoXCJBbGxcIilcblxuLy9hZGQgZXZlbnQgbGlzdGVuZXIgdG8gK0FkZCBUYXNrIGJ1dHRvblxuY29uc3QgYWRkVGFzayA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hZGQtdGFzaycpXG5hZGRUYXNrLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgIC8vIE5lZWQgdG8gcHV0IGEgdGFzay1lZGl0IGFib3ZlICtBZGQgVGFza1xuICAgIGNvbnN0IHRhc2tzRGl2ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3Rhc2tzJylcbiAgICB0YXNrc0Rpdi5pbnNlcnRCZWZvcmUoY3JlYXRlVGFza0VkaXQobnVsbCwgbnVsbCwgbnVsbCwgMywgJ251bGwnKSwgYWRkVGFzaylcbn0pXG5cbmV4cG9ydCBmdW5jdGlvbiByZW5kZXJUYXNrcyAobWVudVNlbGVjdGVkKSB7XG4gICAgLy8gZmlyc3QgcmVtb3ZlIHRoZSBjdXJyZW50IHRhc2tzXG4gICAgcmVtb3ZlVGFza3MoKVxuXG4gICAgLy8gY3JlYXRlIGEgbmV3IGFycmF5IHRoYXQgaG9sZHMgb25seSB0aGUgcmVxdWlyZWQgdGFza3MgZnJvbSB0aGUgcHJvamVjdFxuICAgIGNvbnN0IG5ld0FycmF5ID0gYWxsVGFza3MuZmlsdGVyKGl0ZW0gPT4ge1xuICAgICAgICBpZiAobWVudVNlbGVjdGVkID09IFwiVG9kYXlcIikge1xuICAgICAgICAgICAgcmV0dXJuIGlzRHVlVG9kYXkoaXRlbS5nZXREYXRlKCkpXG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAobWVudVNlbGVjdGVkID09IFwiSW1wb3J0YW50XCIpIHtcbiAgICAgICAgICAgIHJldHVybiBpdGVtLmdldFByaW9yaXR5KCkgPT0gMTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChtZW51U2VsZWN0ZWQgPT0gXCJBbGxcIikge3JldHVybiB0cnVlfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBpdGVtLmdldFByb2plY3QoKSA9PSBtZW51U2VsZWN0ZWQ7IFxuICAgICAgICB9XG4gICAgfSk7XG4gICAgLy8gU2VsZWN0IHRoZSBhZGQgdGFzayBcbiAgICBjb25zdCBhZGRUYXNrID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFkZC10YXNrJylcbiAgICAvLyBzZWxlY3QgdGFza3MgZGl2XG4gICAgY29uc3QgdGFza3NEaXYgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjdGFza3MnKVxuICAgIC8vbG9vcCB0aHJvdWdoIHRoZSBuZXcgYXJyYXkgYW5kIHJlbmRlciB0aGUgdGFza3NcbiAgICBuZXdBcnJheS5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICAgIC8vIGFkZCBuZXcgZWxlbWVudHMgYmVmb3JlICsgQWRkIFRhc2tcbiAgICAgICAgY29uc3QgZWxlID0gY3JlYXRlVGFzayhpdGVtLmdldFRpdGxlKCksIGl0ZW0uZ2V0RGF0ZSgpLCBpdGVtLmdldElkKCksIGl0ZW0uZ2V0UHJpb3JpdHkoKSlcbiAgICAgICAgdGFza3NEaXYuaW5zZXJ0QmVmb3JlKGVsZSwgYWRkVGFzaylcbiAgICB9KVxufVxuXG4vLyB3aGVuIHJlbmRlclRhc2tzKCkgaXMgY2FsbGVkLCB1c2UgdGhpcyBmdW5jdGlvbiB0byBkZWxldGUgdGhlIGN1cnJlbnQgdGFza3NcbmZ1bmN0aW9uIHJlbW92ZVRhc2tzICgpIHtcbiAgICAvLyBjcmVhdGUgbm9kZSBsaXN0cyBvZiBhbGwgY3VycmVudCB0YXNrcyBpbiB0aGUgRE9NXG4gICAgY29uc3QgYWxsVGFza3MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcudGFzay1zcGFuJylcbiAgICAvLyByZW1vdmUgZWFjaCB0YXNrXG4gICAgYWxsVGFza3MuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgICAgICBpdGVtLnJlbW92ZSgpXG4gICAgfSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzYXZlIChlKSB7XG4gICAgLy8gZ2V0IHRoZSBzcmMgZWxlbWVudCBhbmQgdGhlbiB0aGUgZGl2IGNvbnRhaW5pbmcgaW5mb1xuICAgIGNvbnN0IGJ1dHRvbiA9IGUuc3JjRWxlbWVudFxuICAgIGNvbnN0IGZvcm0gPSBidXR0b24uY2xvc2VzdCgnLnRhc2stZm9ybScpXG4gICAgLy8gZ2F0aGVyIGFsbCByZXF1aXJlZCBpbmZvIHRvIGJ1aWxkIGEgbmV3IHRhc2sgb2JqZWN0XG4gICAgY29uc3QgdGl0bGUgPSBmb3JtLnF1ZXJ5U2VsZWN0b3IoJyN0aXRsZS1lZGl0JykudmFsdWVcbiAgICBjb25zdCBkYXRlID0gZm9ybS5xdWVyeVNlbGVjdG9yKCcjZGF0ZScpLnZhbHVlXG4gICAgY29uc3QgZGVzY3JpcHRpb24gPSBmb3JtLnF1ZXJ5U2VsZWN0b3IoJ3RleHRhcmVhJykudmFsdWVcbiAgICBjb25zdCBwcmlvcml0eSA9IGZvcm0ucXVlcnlTZWxlY3RvcignI3ByaW9yaXR5JykudmFsdWVcbiAgICAvLyBnZXQgaWQgaW5kZXggb2YgZm9ybVxuICAgIGxldCBpZCA9IGZvcm0uaWRcbiAgICBpZiAoZm9ybS5pZCA9PSAnbnVsbCcpIHtcbiAgICAgICAgaWQgPSBhbGxUYXNrcy5sZW5ndGhcbiAgICAgICAgYWxsVGFza3MucHVzaCh0YXNrKHRpdGxlLCBkYXRlLCBkZXNjcmlwdGlvbiwgcHJpb3JpdHksIG1lbnVTZWxlY3RlZCwgaWQpKVxuICAgIH1cbiAgICAvLyBpZiBub3QgYSBuZXcgdGFzaywgbWFrZSBjaGFuZ2VzIHRvIGRhdGFcbiAgICBlbHNlIHtcbiAgICAgICAgYWxsVGFza3NbK2lkXS5zZXRUaXRsZSh0aXRsZSlcbiAgICAgICAgYWxsVGFza3NbK2lkXS5zZXREYXRlKGRhdGUpXG4gICAgICAgIGFsbFRhc2tzWytpZF0uc2V0RGVzY3JpcHRpb24oZGVzY3JpcHRpb24pXG4gICAgICAgIGFsbFRhc2tzWytpZF0uc2V0UHJpb3JpdHkocHJpb3JpdHkpXG4gICAgfVxuICAgIC8vIHJlbmRlciB0aGUgbmV3IHRhc2tzXG4gICAgLy8gb3RoZXIgdGFzayBmb3JtIG9uIHBhZ2Ugd2lsbCBiZSByZW1vdmVkXG4gICAgcmVuZGVyVGFza3MobWVudVNlbGVjdGVkKVxuICAgIC8vIHJlbW92ZSB0aGUgZm9ybVxuICAgIGZvcm0ucmVtb3ZlKClcbiAgICAvLyBzYXZlIHRoZSBkYXRhIHRvIGxvY2FsU3RvcmFnZVxuICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdhbGxUYXNrcycsIEpTT04uc3RyaW5naWZ5KGFsbFRhc2tzKSlcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGRlbFRhc2soZSkge1xuICAgIC8vIGRlY2xhcmUgdGhlIHBhcmVudCB2YWx1ZVxuICAgIGxldCBwYXJlbnQgPSAnJ1xuICAgIC8vIGNoZWNrIGlmIHRhc2sgaXMgYmVpbmcgY29tcGxldGVkIG9yIGRlbGV0ZWQgYW5kIHNhdmVcbiAgICAvLyB0aGUgdGFzayBET00gZWxlbWVudCB0byBnZXQgaWQgbGF0ZXJcbiAgICBpZiAoZS5zcmNFbGVtZW50LmNsYXNzTGlzdC52YWx1ZSA9PSAndGFzay1jaXJjbGUnKXtcbiAgICAgICAgcGFyZW50ID0gZS5zcmNFbGVtZW50LnBhcmVudEVsZW1lbnQucGFyZW50RWxlbWVudFxuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgcGFyZW50ID0gZS5zcmNFbGVtZW50LmNsb3Nlc3QoJy50YXNrLWZvcm0nKVxuICAgIH1cbiAgICAvLyB1c2UgdGhlIGZ1bmN0aW9uIHRvIGZpbmQgdGhlIGluZGV4IG9mIHRoZSBhcnJheSB3aGVyZSB0aGUgdGFzayBpcyBzYXZlZFxuICAgIGNvbnN0IGkgPSArKHBhcmVudC5pZClcbiAgICAvLyBkZWxldGVzIHRoZSBvYmplY3QgZnJvbSB0aGUgYXJyYXlcbiAgICBhbGxUYXNrcy5zcGxpY2UoaSwgMSlcbiAgICAvLyByZW1vdmUgdGhlIGVsZW1lbnQgZnJvbSB0aGUgRE9NXG4gICAgcGFyZW50LnJlbW92ZSgpXG4gICAgLy8gcmUtYXNzaWduIHRoZSBpZCdzIGZvciBlYWNoIHRhc2tcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGFsbFRhc2tzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGFsbFRhc2tzW2ldLnNldElkKGkpXG4gICAgfVxuICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdhbGxUYXNrcycsIEpTT04uc3RyaW5naWZ5KGFsbFRhc2tzKSlcbiAgICByZW1vdmVUYXNrcygpXG4gICAgcmVuZGVyVGFza3MobWVudVNlbGVjdGVkKVxufVxuXG4vLyB3aWxsIG9wZW4gYW4gZWRpdCBmb3JtIGZvciB0aGUgdGFza1xuZXhwb3J0IGZ1bmN0aW9uIGVkaXRUYXNrKGUpIHtcbiAgICAvLyBnZXQgdGhlIHBhcmVudCBlbGVtZW50XG4gICAgY29uc3QgcGFyZW50ID0gZS5zcmNFbGVtZW50LnBhcmVudEVsZW1lbnQucGFyZW50RWxlbWVudFxuICAgIC8vIGZpbmQgdGhlIHRhc2sgaW4gdGhlIGFsbFRhc2tzIGFycmF5XG4gICAgY29uc3QgaSA9ICsocGFyZW50LmlkKVxuICAgIC8vIG9wZW4gdGhlIGVkaXQgd2luZG93IGJlbG93IHRoZSB0YXNrcyB0aGVuIGRlbGV0ZSB0aGUgdGFza1xuICAgIC8vIGxlYXZlIGVkaXQgbWVudSBvcGVuXG4gICAgcGFyZW50Lmluc2VydEFkamFjZW50RWxlbWVudCgnYWZ0ZXJlbmQnLCBcbiAgICBjcmVhdGVUYXNrRWRpdChhbGxUYXNrc1tpXS5nZXRUaXRsZSgpLCBhbGxUYXNrc1tpXS5nZXREYXRlKCksIFxuICAgIGFsbFRhc2tzW2ldLmdldERlc2NyaXB0aW9uKCksIGFsbFRhc2tzW2ldLmdldFByaW9yaXR5KCksIGFsbFRhc2tzW2ldLmdldElkKCkpKVxuICAgIHBhcmVudC5yZW1vdmUoKVxufVxuXG4vLyBmdW5jdGluIHJldHVybnMgdHJ1ZSBpZiB0aGUgZHVlIGRhdGUgaXMgdG9kYXkgb3IgZnJvbSB0aGUgcGFzdFxuZnVuY3Rpb24gaXNEdWVUb2RheSAoZGF0ZSkge1xuICAgIC8vIGlmIHRoZXJlIGlzIG5vIGRhdGUsIHJldHVybiBmYWxzZVxuICAgIGlmIChkYXRlID09ICcnKSB7cmV0dXJuIGZhbHNlfVxuICAgIC8vIGNyZWF0ZSB0b2RheSdzIGRhdGVcbiAgICBsZXQgdG9kYXkgPSBuZXcgRGF0ZSgpXG4gICAgLy8gc3BsaXQgdGhlIGRhdGUgZnJvbSB0aGUgdGFzayBpbnRvIGEgbmV3IGFycmF5XG4gICAgY29uc3QgY3VycmVudERhdGVzID0gZGF0ZS5zcGxpdCgnLScpXG4gICAgLy8gaWYgdGFzayBmcm9tIGEgcGFzdCB5ZWFyIHJldHVybiB0cnVlXG4gICAgaWYgKGN1cnJlbnREYXRlc1swXSA8IHRvZGF5LmdldEZ1bGxZZWFyKCkpIHJldHVybiB0cnVlXG4gICAgLy8gaWYgdGhlIHllYXIgaXMgdGhlIHNhbWUgdGhlbiBjaGVjayBtb250aCBhbmQgZGF5XG4gICAgLy8gaWYgbm90LCB0aGUgeWVhciBtdXN0IGJlIGluIHRoZSBmdXR1cmVcbiAgICBpZiAoY3VycmVudERhdGVzWzBdID09IHRvZGF5LmdldEZ1bGxZZWFyKCkpIHtcbiAgICAgICAgLy8gaWYgbW9udGggaXMgbW9udGggaXMgbGVzcyB0aGFuIGN1cnJlbnQgcmV0dXJuIHRydWVcbiAgICAgICAgaWYgKGN1cnJlbnREYXRlc1sxXSA8IHRvZGF5LmdldE1vbnRoKCkgKyAxKSByZXR1cm4gdHJ1ZVxuICAgICAgICAvLyBpZiBpbiBjdXJyZW50IG1vbnRoIHRoZW4gY2hlY2sgdGhlIGRheVxuICAgICAgICBpZiAoK2N1cnJlbnREYXRlc1sxXSA9PSB0b2RheS5nZXRNb250aCgpICsgMSkge1xuICAgICAgICAgICAgLy8gaWYgZGF5IGlzIGxlc3MgdGhhbiBvciBlcXVhbCB0byBjdXJyZW50IGRheSByZXR1cm4gdHJ1ZVxuICAgICAgICAgICAgaWYgKGN1cnJlbnREYXRlc1syXSA8PSB0b2RheS5nZXREYXRlKCkpIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGZhbHNlXG59IiwiaW1wb3J0IHsgZGVsVGFzaywgZWRpdFRhc2sgfSBmcm9tIFwiLi90YXNrLWNvbnRyb2wuanNcIlxuXG4vLyBmdW5jdGlvbiB0aGF0IHJldHVybnMgYSB0YXNrIGZvciB0aGUgRE9NXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBjcmVhdGVUYXNrICh0aXRsZSwgZGF0ZSwgaWQsIHByaW9yaXR5KSB7XG4gICAgLy9jcmVhdGUgZGVmYXVsdCBkaXYgdG8gaG9sZCBhbGwgdGhlIGluZm9cbiAgICBjb25zdCB0YXNrRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcbiAgICB0YXNrRGl2LmNsYXNzTGlzdC5hZGQoJ3Rhc2snKVxuICAgIHRhc2tEaXYuY2xhc3NMaXN0LmFkZCgndGFzay1zcGFuJylcbiAgICB0YXNrRGl2LmlkID0gaWRcblxuICAgIC8vY3JlYXRlIHR3byBoYWx2ZXMgZm9yIHRoZSBkaXYgXG4gICAgY29uc3QgdGFza1N0YXJ0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcbiAgICBjb25zdCB0YXNrRW5kID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcbiAgICB0YXNrU3RhcnQuY2xhc3NMaXN0LmFkZCgndGFzay1zdGFydCcpXG4gICAgdGFza0VuZC5jbGFzc0xpc3QuYWRkKCd0YXNrLWVuZCcpXG5cbiAgICAvL2NyZWF0ZSBidXR0b24gdG8gY29tcGxldGUgdGFza1xuICAgIGNvbnN0IGNoZWNrQnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpXG4gICAgY2hlY2tCdXR0b24uY2xhc3NMaXN0LmFkZCgndGFzay1jaXJjbGUnKVxuICAgIGlmIChwcmlvcml0eSA9PSAxKXtcbiAgICAgICAgY2hlY2tCdXR0b24uc3R5bGUuY3NzVGV4dCA9ICdib3gtc2hhZG93OiAwIDAgNXB4IHJnYigyNTUsIDYwLCAyMCksIGluc2V0IDAgMCA1cHggcmdiKDI1NSwgNjAsIDIwKSdcbiAgICB9XG4gICAgZWxzZSBpZiAocHJpb3JpdHkgPT0gMil7XG4gICAgICAgIGNoZWNrQnV0dG9uLnN0eWxlLmNzc1RleHQgPSAnYm94LVNoYWRvdzogMCAwIDVweCAjQzlCNDAwLCBpbnNldCAwIDAgNXB4ICNDOUI0MDAnXG4gICAgfVxuICAgIGNoZWNrQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtkZWxUYXNrKGUpfSlcblxuICAgIC8vY3JlYXRlIGRpdiB0byBob2xkIHRpdGxlIG9mIHRhc2tcbiAgICBjb25zdCB0YXNrVGl0bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuICAgIHRhc2tUaXRsZS5jbGFzc0xpc3QuYWRkKCd0YXNrLXRpdGxlJylcbiAgICB0YXNrVGl0bGUudGV4dENvbnRlbnQgPSB0aXRsZVxuXG4gICAgLy9jcmVhdGUgZGl2IHRvIGhvbGQgdGhlIGRhdGVcbiAgICBjb25zdCB0YXNrRGF0ZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG4gICAgdGFza0RhdGUuY2xhc3NMaXN0LmFkZCgndGFzay1kYXRlJylcbiAgICB0YXNrRGF0ZS50ZXh0Q29udGVudCA9IGRhdGVcblxuICAgIC8vY3JlYXRlIHRoZSBlZGl0IGJ1dHRvbi9pbWdcbiAgICBjb25zdCBlZGl0QnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW1nJylcbiAgICBlZGl0QnV0dG9uLnNyYyA9ICdpbWFnZXMvZWRpdC5zdmcnXG4gICAgZWRpdEJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2FsdCcsICdlZGl0IGJ1dHRvbicpXG4gICAgZWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7ZWRpdFRhc2soZSl9KVxuXG4gICAgLy8gQXBwZW5kIGFsbCBlbGVtZW50cyB0b2dldGhlclxuICAgIHRhc2tFbmQuYXBwZW5kQ2hpbGQodGFza0RhdGUpXG4gICAgdGFza0VuZC5hcHBlbmRDaGlsZChlZGl0QnV0dG9uKVxuXG4gICAgdGFza1N0YXJ0LmFwcGVuZENoaWxkKGNoZWNrQnV0dG9uKVxuICAgIHRhc2tTdGFydC5hcHBlbmRDaGlsZCh0YXNrVGl0bGUpXG5cbiAgICB0YXNrRGl2LmFwcGVuZENoaWxkKHRhc2tTdGFydClcbiAgICB0YXNrRGl2LmFwcGVuZENoaWxkKHRhc2tFbmQpXG5cbiAgICByZXR1cm4gdGFza0RpdlxufSIsImltcG9ydCB7IGFkZFRpdGxlLCBnZXRUaXRsZXMsIGRlbGV0ZVRpdGxlfSBmcm9tIFwiLi9wcm9qZWN0c1wiXG5pbXBvcnQgeyByZW5kZXJUYXNrcyB9IGZyb20gXCIuL3Rhc2stY29udHJvbC5qc1wiXG5cbi8vIHZhcmlhYmxlIHVzZWQgdG8ga2VlcCB0cmFjayBvZiB3aGljaCBtZW51IGl0ZW0gaXMgc2VsZWN0ZWRcbmV4cG9ydCBsZXQgbWVudVNlbGVjdGVkID0gJ0FsbCdcblxuLy9BZGQgZXZlbnRzIHRvIHRoZSBkZWZhdWx0IG1lbnUgb3B0aW9uc1xuY29uc3QgbWVudUl0ZW1zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLm1lbnUtaXRlbScpXG5tZW51SXRlbXMuZm9yRWFjaChhZGRNZW51SXRlbUV2ZW50KVxuXG4vLyBMb2FkIGxvY2FsU3RvcmFnZSBkYXRhIGludG8gdGhlIERPTVxuY29uc3QgbWVudVRpdGxlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9qZWN0cycpXG5jb25zdCBhcnJheSA9IGdldFRpdGxlcygpXG5mb3IgKGxldCBpID0gMDsgaSA8IGFycmF5Lmxlbmd0aDsgaSsrKSB7XG4gICAgbWVudVRpdGxlcy5hcHBlbmRDaGlsZChjcmVhdGVNZW51SXRlbShhcnJheVtpXSkpXG59XG5cbi8vIEV2ZW50IGxpc3RlbmVyIGZvciB0aGUgXCIrXCIgYnV0dG9uIGJlc2lkZSBwcm9qZWN0IHRpdGxlXG5jb25zdCBwbHVzQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2plY3QtdGl0bGUgPiBzdmcnKVxucGx1c0J1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAvL0NhbGxzIGZ1bmN0aW9uIHRvIGFkZCB0aGUgcHJvamVjdCBmb3JtIHRvIHRoZSBET01cbiAgICBjb25zdCBwcm9qZWN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2plY3RzJylcbiAgICBwcm9qZWN0LmFwcGVuZENoaWxkKGNyZWF0ZUZvcm0oKSlcblxufSlcblxuLy8gUmV0dXJucyB0aGUgRE9NIGVsZW1lbnQgb2YgYSBtZW51LWl0ZW0gXG4vLyBhIHNpbXBsZSBwcm9qZWN0IGlzIGFkZGVkIHRvIHRoZSBsaXN0IG9uIHRoZSBET01cbmZ1bmN0aW9uIGNyZWF0ZU1lbnVJdGVtKHRpdGxlKSB7XG4gICAgLy8gIGNyZWF0ZSB0aGUgbWVudS1pdGVtIGRpdiB0byBob2xkIHRoZSBlbGVtZW50c1xuICAgIGNvbnN0IGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG4gICAgZGl2LmNsYXNzTGlzdC5hZGQoJ21lbnUtaXRlbScpXG4gICAgLy8gY3JlYXRlIHRoZSB0aXRsZSBkaXZcbiAgICBjb25zdCB0aXRsZURpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG4gICAgdGl0bGVEaXYudGV4dENvbnRlbnQgPSB0aXRsZVxuICAgIC8vIGNyZWF0ZSB0aGUgdHJhc2ggYmluIGltZ1xuICAgIGNvbnN0IHRyYXNoID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW1nJylcbiAgICB0cmFzaC5zZXRBdHRyaWJ1dGUoJ3NyYycsICcuL2ltYWdlcy90cmFzaC0yLnN2ZycpXG4gICAgdHJhc2guc2V0QXR0cmlidXRlKCdhbHQnLCAndHJhc2ggaWNvbicpXG5cbiAgICAvLyBhZGQgZXZlbnRsaXN0ZW5lciB0byB0cmFzaCBpY29uXG4gICAgdHJhc2guYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xuICAgICAgICBkZWxldGVUaXRsZShlLnNyY0VsZW1lbnQucHJldmlvdXNFbGVtZW50U2libGluZy50ZXh0Q29udGVudClcbiAgICAgICAgZS5zcmNFbGVtZW50LmNsb3Nlc3QoJy5tZW51LWl0ZW0nKS5yZW1vdmUoKVxuICAgIH0pXG5cbiAgICAvLyBhcHBlbmQgdGhlIHR3byBjaGlsZHJlblxuICAgIGRpdi5hcHBlbmRDaGlsZCh0aXRsZURpdilcbiAgICBkaXYuYXBwZW5kQ2hpbGQodHJhc2gpXG5cbiAgICBhZGRNZW51SXRlbUV2ZW50KGRpdilcbiAgICBcbiAgICByZXR1cm4gZGl2XG59XG5cbi8vIHJldHVybnMgYSBmb3JtIGZvciBET00gdG8gYmUgdXNlZCB0byBjcmVhdGUgYSBuZXcgcHJvamVjdFxuZnVuY3Rpb24gY3JlYXRlRm9ybSgpIHtcbiAgICAvLyBjcmVhdGUgdGhlIGRpdiB0aGF0IGVuY29tcGFzc2VzIHRoZSBlbnRpcmUgYmxvY2tcbiAgICBjb25zdCBtZW51Rm9ybSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG4gICAgbWVudUZvcm0uY2xhc3NMaXN0LmFkZCgnbWVudS1mb3JtJylcblxuICAgIC8vIGNyZWF0ZSB0aGUgZm9ybSBhbmQgYWRkIGF0dHJpYnV0ZXNcbiAgICBjb25zdCBmb3JtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZm9ybScpXG4gICAgZm9ybS5zZXRBdHRyaWJ1dGUoJ2FjdGlvbicsIFwiXCIpXG4gICAgZm9ybS5zZXRBdHRyaWJ1dGUoJ21ldGhvZCcsICdwb3N0JylcblxuICAgIC8vIGNyZWF0ZSB0aGUgaW5wdXQgYm94IGZvciB0ZXh0XG4gICAgY29uc3QgaW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpXG4gICAgaW5wdXQuc2V0QXR0cmlidXRlKCd0eXBlJywgJ3RleHQnKVxuICAgIGlucHV0LnNldEF0dHJpYnV0ZSgnaWQnLCAncHJvamVjdC10aXRsZScpXG4gICAgaW5wdXQuc2V0QXR0cmlidXRlKCduYW1lJywgJ3Byb2plY3RUaXRsZScpXG4gICAgaW5wdXQuc2V0QXR0cmlidXRlKCdtYXhsZW5ndGgnLCAnMTUnKVxuXG4gICAgLy8gY3JlYXRlIGRpdiB0byBlbmNvbXBhc3MgYnV0dG9uc1xuICAgIGNvbnN0IHByb2plY3RCdXR0b25zID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcbiAgICBwcm9qZWN0QnV0dG9ucy5jbGFzc0xpc3QuYWRkKCdwcm9qZWN0LWJ1dHRvbnMnKVxuXG4gICAgLy9jcmVhdGUgdGhlIGJ1dHRvbnNcbiAgICBjb25zdCBhZGRCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKVxuICAgIGFkZEJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdhZGQtYnV0dG9uJylcbiAgICBhZGRCdXR0b24uc2V0QXR0cmlidXRlKCd0eXBlJywgJ2J1dHRvbicpXG4gICAgYWRkQnV0dG9uLnRleHRDb250ZW50ID0gXCJBZGRcIlxuXG4gICAgY29uc3QgY2FuY2VsQnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJylcbiAgICBjYW5jZWxCdXR0b24uY2xhc3NMaXN0LmFkZCgnY2FuY2VsLWJ1dHRvbicpXG4gICAgY2FuY2VsQnV0dG9uLnNldEF0dHJpYnV0ZSgndHlwZScsICdidXR0b24nKVxuICAgIGNhbmNlbEJ1dHRvbi50ZXh0Q29udGVudCA9IFwiQ2FuY2VsXCJcblxuICAgIC8vIGFkZCBldmVudGxpc3RlbmVyc1xuICAgIGFkZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XG4gICAgICAgIHNhdmUoZSlcbiAgICB9KVxuICAgIGNhbmNlbEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XG4gICAgICAgIGNhbmNlbChlKVxuICAgIH0pXG5cbiAgICAvLyBBcHBlbmQgdGhlIGJ1dHRvbnMgdG8gcHJvamVjdEJ1dHRvbnNcbiAgICBwcm9qZWN0QnV0dG9ucy5hcHBlbmRDaGlsZChhZGRCdXR0b24pXG4gICAgcHJvamVjdEJ1dHRvbnMuYXBwZW5kQ2hpbGQoY2FuY2VsQnV0dG9uKVxuXG4gICAgLy8gQXBwZW5kIGlucHV0IHRvIGZvcm0gdGhlbiBwcm9qZWN0QnV0dG9ucyB0byBmb3JtXG4gICAgZm9ybS5hcHBlbmRDaGlsZChpbnB1dClcbiAgICBmb3JtLmFwcGVuZENoaWxkKHByb2plY3RCdXR0b25zKVxuXG4gICAgLy8gYXBwZW5kIGZvcm0gdG8gdGhlIG1haW4gZGl2IChtZW51Rm9ybSlcbiAgICBtZW51Rm9ybS5hcHBlbmRDaGlsZChmb3JtKVxuXG4gICAgcmV0dXJuIG1lbnVGb3JtXG59XG5cbmZ1bmN0aW9uIHNhdmUoZSkge1xuICAgIC8vIHNlbGVjdCB0aGUgbWVudS1mb3JtIHBhcmVudCBub2RlXG4gICAgY29uc3QgbWVudUZvcm0gPSBlLnNyY0VsZW1lbnQuY2xvc2VzdCgnLm1lbnUtZm9ybScpXG4gICAgLy8gc2VsZWN0IHRoZSBjaGlsZCBvZiBtZW51LWZvcm0gYW5kIHRoZSBjaGlsZCBvZiB0aGF0IHRvIGFxdWlyZSB0aGUgaW5wdXQgbm9kZS5cbiAgICAvLyBUYWtlIHRoZSB2YWx1ZSBvZiB0aGUgaW5wdXQgbm9kZVxuICAgIGNvbnN0IGlucHV0VGV4dCA9IG1lbnVGb3JtLmZpcnN0Q2hpbGQuZmlyc3RDaGlsZC52YWx1ZVxuICAgIC8vIGluc2VydCBhIG5ldyBtZW51IGl0ZW0gYWZ0ZXIgdGhlIGZvcm1cbiAgICBtZW51Rm9ybS5pbnNlcnRBZGphY2VudEVsZW1lbnQoJ2FmdGVyZW5kJywgY3JlYXRlTWVudUl0ZW0oaW5wdXRUZXh0KSlcbiAgICAvLyBhZGQgdGhlIHRpdGxlIHRvIHRoZSBhcnJheSBcbiAgICBhZGRUaXRsZShpbnB1dFRleHQpXG5cbiAgICAvLyB3aGVuIGV2ZXJ5dGhpbmcgaXMgZG9uZSwgZGVsZXRlIHRoZSBmb3JtXG4gICAgY2FuY2VsKGUpXG59XG5cbi8vIGZ1bmN0aW9uIHVzZWQgdG8gZGVsZXRlIG1lbnUtZm9ybVxuZnVuY3Rpb24gY2FuY2VsKGUpIHtcbiAgICAvLyBmaW5kIHRoZSBjbG9zZXN0IG1lbnUgZm9ybSBhbmQgcmVtb3ZlIGl0XG4gICAgZS5zcmNFbGVtZW50LmNsb3Nlc3QoJy5tZW51LWZvcm0nKS5yZW1vdmUoKVxufVxuXG4vLyBhZGQgZXZlbnQgbGlzdGVuZXIgZm9yIGEgbWVudS1pdGVtXG5mdW5jdGlvbiBhZGRNZW51SXRlbUV2ZW50IChpdGVtKSB7XG4gICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XG4gICAgICAgIC8vIHJlbW92ZXMgdGhlIGNsYXNzIHRoYXQgaXMgaGlnaGxpZ2h0aW5nIHRoZSBjdXJyZW50bHkgc2VsZWN0ZWQgaXRlbVxuICAgICAgICBjb25zdCBjdXJyZW50U2VsZWN0ZWQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubWVudS1zZWxlY3RlZCcpXG4gICAgICAgIC8vIG1ha2Ugc3VyZSBjdXJyZW50U2VsZWN0ZWQgaXNuJ3QgbnVsbCB0byBwcmV2ZW50IGFuIGVycm9yXG4gICAgICAgIC8vIGN1cnJlbnRTZWxlY3RlZCB3aWxsIGJlIG51bGwgd2hlbiB0aGUgdHJhc2ggaWNvbiBpcyBjbGlja2VkIHRvIGRlbGV0ZVxuICAgICAgICBpZiAoY3VycmVudFNlbGVjdGVkICE9IG51bGwpe1xuICAgICAgICAgICAgY3VycmVudFNlbGVjdGVkLmNsYXNzTGlzdC5yZW1vdmUoJ21lbnUtc2VsZWN0ZWQnKVxuICAgICAgICB9XG4gICAgICAgIC8vYWRkIHRoZSBtZW51LXNlbGVjdGVkIGNsYXNzIHRvIHRoZSBpdGVtIHRoYXQgd2FzIHNlbGVjdGVkXG4gICAgICAgIGUuc3JjRWxlbWVudC5jbGFzc0xpc3QuYWRkKCdtZW51LXNlbGVjdGVkJylcbiAgICAgICAgLy8gY2FsbCBmdW5jdGlvbiB0byByZW5kZXIgdGhlIHRhc2tzXG4gICAgICAgIC8vIGlmIHRleHRDb250ZW50IHJlYWRpbmcgbnVsbCBlcnJvciBhcHBlYXJzLCBjYXRjaCB0aGUgZXJyb3JcbiAgICAgICAgLy8gYW5kIGNvbmZpcm0gcHJvamVjdCBkZWxldGlvblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgbWVudVNlbGVjdGVkID0gZS5zcmNFbGVtZW50LmZpcnN0Q2hpbGQudGV4dENvbnRlbnRcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyKXtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdQcm9qZWN0IERlbGV0ZWQnKVxuICAgICAgICB9XG4gICAgICAgIHJlbmRlclRhc2tzKG1lbnVTZWxlY3RlZClcbiAgICB9KVxufVxuIl0sIm5hbWVzIjpbInByb2plY3RUaXRsZXMiLCJsb2NhbFN0b3JhZ2UiLCJnZXRJdGVtIiwic3BsaXQiLCJzZXRJdGVtIiwidGFzayIsInRpdGxlIiwiZGF0ZSIsImRlc2NyaXB0aW9uIiwicHJpb3JpdHkiLCJwcm9qZWN0IiwiaWQiLCJvYmoiLCJPYmplY3QiLCJjcmVhdGUiLCJ0YXNrUHJvdG8iLCJnZXRUaXRsZSIsInRoaXMiLCJzZXRUaXRsZSIsImdldERlc2NyaXB0aW9uIiwic2V0RGVzY3JpcHRpb24iLCJnZXREYXRlIiwic2V0RGF0ZSIsImdldFByaW9yaXR5Iiwic2V0UHJpb3JpdHkiLCJnZXRQcm9qZWN0Iiwic2V0UHJvamVjdCIsImdldElkIiwic2V0SWQiLCJjcmVhdGVUYXNrRWRpdCIsInRhc2tGb3JtIiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50IiwiY2xhc3NMaXN0IiwiYWRkIiwiZm9ybSIsInNldEF0dHJpYnV0ZSIsInRvcEVkaXQiLCJlZGl0VGl0bGUiLCJ2YWx1ZSIsImRhdGVEaXYiLCJkYXRlTGFiZWwiLCJ0ZXh0Q29udGVudCIsImlucHV0RGF0ZSIsImFwcGVuZENoaWxkIiwidGV4dEFyZWFEaXYiLCJ0ZXh0QXJlYSIsImxvd2VyRGl2IiwiZW5jb21wYXNEaXYiLCJwcmlvcml0eUxhYmVsIiwicHJpb3JpdHlTZWxlY3QiLCJpIiwiY3JlYXRlT3B0aW9uIiwiYnV0dG9uRGl2IiwiZGVsQnV0dG9uIiwiYWRkRXZlbnRMaXN0ZW5lciIsImUiLCJkZWxUYXNrIiwic2F2ZUJ1dHRvbiIsInNyY0VsZW1lbnQiLCJjbG9zZXN0IiwicXVlcnlTZWxlY3RvciIsImFsbFRhc2tzIiwibGVuZ3RoIiwicHVzaCIsIm1lbnVTZWxlY3RlZCIsInJlbmRlclRhc2tzIiwicmVtb3ZlIiwiSlNPTiIsInN0cmluZ2lmeSIsInNhdmUiLCJvcHRpb24iLCJwYXJzZSIsImZvckVhY2giLCJpdGVtIiwiaW5kZXgiLCJhZGRUYXNrIiwicmVtb3ZlVGFza3MiLCJuZXdBcnJheSIsImZpbHRlciIsInRvZGF5IiwiRGF0ZSIsImN1cnJlbnREYXRlcyIsImdldEZ1bGxZZWFyIiwiZ2V0TW9udGgiLCJpc0R1ZVRvZGF5IiwidGFza3NEaXYiLCJlbGUiLCJ0YXNrRGl2IiwidGFza1N0YXJ0IiwidGFza0VuZCIsImNoZWNrQnV0dG9uIiwic3R5bGUiLCJjc3NUZXh0IiwidGFza1RpdGxlIiwidGFza0RhdGUiLCJlZGl0QnV0dG9uIiwic3JjIiwicGFyZW50IiwicGFyZW50RWxlbWVudCIsImluc2VydEFkamFjZW50RWxlbWVudCIsImVkaXRUYXNrIiwiY3JlYXRlVGFzayIsImluc2VydEJlZm9yZSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJzcGxpY2UiLCJhZGRNZW51SXRlbUV2ZW50IiwibWVudVRpdGxlcyIsImFycmF5IiwiY3JlYXRlTWVudUl0ZW0iLCJkaXYiLCJ0aXRsZURpdiIsInRyYXNoIiwiaW5kZXhPZiIsImRlbGV0ZVRpdGxlIiwicHJldmlvdXNFbGVtZW50U2libGluZyIsImNhbmNlbCIsImN1cnJlbnRTZWxlY3RlZCIsImZpcnN0Q2hpbGQiLCJlcnIiLCJjb25zb2xlIiwibG9nIiwibWVudUZvcm0iLCJpbnB1dCIsInByb2plY3RCdXR0b25zIiwiYWRkQnV0dG9uIiwiY2FuY2VsQnV0dG9uIiwiaW5wdXRUZXh0IiwiY3JlYXRlRm9ybSJdLCJzb3VyY2VSb290IjoiIn0=