(()=>{"use strict";let t=[];localStorage.getItem("projectTitles")?t=localStorage.getItem("projectTitles").split(","):localStorage.setItem("projectTitles",[]);const e={getTitle(){return this.title},setTitle(t){this.title=t},getDescription(){return this.description},setDescription(t){this.description=t},getDate(){return this.date},setDate(t){this.date=t},getPriority(){return this.priority},setPriority(t){this.priority=t},getProject(){return this.project},setProject(t){this.project=t}};function n(t,e){const n=document.createElement("div");n.classList.add("task"),n.classList.add("task-span");const c=document.createElement("div"),s=document.createElement("div");c.classList.add("task-start"),s.classList.add("task-end");const i=document.createElement("span");i.classList.add("task-circle"),i.addEventListener("click",(t=>{!function(t){const e=t.srcElement.parentElement.parentElement,n=e.querySelector(".task-title"),c=e.querySelector(".task-date"),s=function(t,e){const n=[];for(let e=0;e<r.length;e++)r[e].getTitle()===t&&n.push(e);const c=[];for(let t=0;t<n.length;t++)r[n[t]].getDate()==e&&c.push(n[t]);if("All"==o)return c[0];for(let t=0;t<c.length;t++)if(r[c[0]].getProject()===o)return t}(n.textContent,c.textContent);r.splice(s,1),e.remove()}(t)}));const l=document.createElement("div");l.classList.add("task-title"),l.textContent=t;const d=document.createElement("div");d.classList.add("task-date"),d.textContent=e;const a=document.createElement("img");return a.src="images/edit.svg",a.setAttribute("alt","edit button"),s.appendChild(d),s.appendChild(a),c.appendChild(i),c.appendChild(l),n.appendChild(c),n.appendChild(s),n}function c(t){const e=document.createElement("option");return e.textContent=t,e.setAttribute("value",t),e}let r=[];const s=document.querySelector(".add-task");function i(t){document.querySelectorAll(".task-span").forEach((t=>{t.remove()}));const e=r.filter((e=>{if("Today"!=t)return"Important"==t?1==e.getPriority:"All"==t||e.getProject()==t})),c=document.querySelector(".add-task"),s=document.querySelector("#tasks");e.forEach((t=>{const e=n(t.getTitle(),t.getDate());s.insertBefore(e,c)}))}s.addEventListener("click",(()=>{document.querySelector("#tasks").insertBefore(function(t,n,s,l){const d=document.createElement("div");d.classList.add("task-span"),d.classList.add("task-form");const a=document.createElement("form");a.setAttribute("action",""),a.setAttribute("method","post");const u=document.createElement("div");u.classList.add("top-form-task");const m=document.createElement("input");m.setAttribute("type","text"),m.setAttribute("id","title-edit"),m.setAttribute("placeholder","Title"),m.setAttribute("name","title-edit"),m.setAttribute("maxlength","20"),m.value=t;const p=document.createElement("div"),h=document.createElement("label");h.textContent="Date: ",h.setAttribute("for","date");const E=document.createElement("input");E.setAttribute("type","date"),E.setAttribute("id","date"),E.setAttribute("name","date"),E.value=n,p.appendChild(h),p.appendChild(E),u.appendChild(m),u.appendChild(p),a.appendChild(u);const C=document.createElement("div");C.classList.add("textarea-div");const v=document.createElement("textarea");v.setAttribute("placeholder","Description"),v.value=s,C.appendChild(v),a.appendChild(C);const b=document.createElement("div");b.classList.add("lower-form-task");const f=document.createElement("div"),A=document.createElement("label");A.textContent="Priority: ",A.setAttribute("for","priority");const y=document.createElement("select");y.setAttribute("name","priority"),y.setAttribute("id","priority"),y.value=l;for(let t=1;t<=3;t++)y.appendChild(c(t));f.appendChild(A),f.appendChild(y);const g=document.createElement("div"),L=document.createElement("button");L.textContent="Del",L.setAttribute("type","button");const k=document.createElement("button");return k.textContent="Save",k.setAttribute("type","button"),k.addEventListener("click",(t=>{!function(t){const n=t.srcElement.closest("form"),c=n.querySelector("#title-edit").value,s=n.querySelector("#date").value,l=n.querySelector("textarea").value,d=n.querySelector("#priority").value;r.push(((t,n,c,r,s)=>{let i=Object.create(e);return i.title=t,i.description=c,i.date=n,i.priority=r,i.project=s,i})(c,s,l,d,o)),i(o),n.parentElement.remove()}(t)})),g.appendChild(L),g.appendChild(k),b.appendChild(f),b.appendChild(g),a.appendChild(b),d.appendChild(a),d}(null,null,null,3),s)}));let o="All";document.querySelectorAll(".menu-item").forEach(m);const l=document.querySelector(".projects"),d=t;for(let t=0;t<d.length;t++)l.appendChild(a(d[t]));function a(e){const n=document.createElement("div");n.classList.add("menu-item");const c=document.createElement("div");c.textContent=e;const r=document.createElement("img");return r.setAttribute("src","./images/trash-2.svg"),r.setAttribute("alt","trash icon"),r.addEventListener("click",(e=>{!function(e){const n=t.indexOf(e);n>-1&&(t.splice(n,1),localStorage.setItem("projectTitles",t))}(e.srcElement.previousElementSibling.textContent),e.srcElement.closest(".menu-item").remove()})),n.appendChild(c),n.appendChild(r),m(n),n}function u(t){t.srcElement.closest(".menu-form").remove()}function m(t){t.addEventListener("click",(t=>{const e=document.querySelector(".menu-selected");null!=e&&e.classList.remove("menu-selected"),t.srcElement.classList.add("menu-selected"),o=t.srcElement.firstChild.textContent,i(o)}))}document.querySelector(".project-title > svg").addEventListener("click",(()=>{document.querySelector(".projects").appendChild(function(){const e=document.createElement("div");e.classList.add("menu-form");const n=document.createElement("form");n.setAttribute("action",""),n.setAttribute("method","post");const c=document.createElement("input");c.setAttribute("type","text"),c.setAttribute("id","project-title"),c.setAttribute("name","projectTitle"),c.setAttribute("maxlength","15");const r=document.createElement("div");r.classList.add("project-buttons");const s=document.createElement("button");s.classList.add("add-button"),s.setAttribute("type","button"),s.textContent="Add";const i=document.createElement("button");return i.classList.add("cancel-button"),i.setAttribute("type","button"),i.textContent="Cancel",s.addEventListener("click",(e=>{!function(e){const n=e.srcElement.closest(".menu-form"),c=n.firstChild.firstChild.value;var r;n.insertAdjacentElement("afterend",a(c)),r=c,t.push(r),localStorage.setItem("projectTitles",t),u(e)}(e)})),i.addEventListener("click",(t=>{u(t)})),r.appendChild(s),r.appendChild(i),n.appendChild(c),n.appendChild(r),e.appendChild(n),e}())}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUtBLEVBQUMsSUFFVjZFLEVBQWE5RSxpQkFBaUIsU0FBVUMsSUFDcENzRSxFQUFPdEUsRUFBQyxJQUlaMkUsRUFBZXJELFlBQVlzRCxHQUMzQkQsRUFBZXJELFlBQVl1RCxHQUczQnpDLEVBQUtkLFlBQVlvRCxHQUNqQnRDLEVBQUtkLFlBQVlxRCxHQUdqQkYsRUFBU25ELFlBQVljLEdBRWRxQyxDQUNYLENBdEZ3Qk8sR0FBWSxHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdG8tZG8tbGlzdC8uL3NyYy9qcy1tb2R1bGVzL3Byb2plY3RzLmpzIiwid2VicGFjazovL3RvLWRvLWxpc3QvLi9zcmMvanMtbW9kdWxlcy90YXNrLW9iamVjdC5qcyIsIndlYnBhY2s6Ly90by1kby1saXN0Ly4vc3JjL2pzLW1vZHVsZXMvdGFzay1kb20uanMiLCJ3ZWJwYWNrOi8vdG8tZG8tbGlzdC8uL3NyYy9qcy1tb2R1bGVzL3Rhc2stY29udHJvbC5qcyIsIndlYnBhY2s6Ly90by1kby1saXN0Ly4vc3JjL2pzLW1vZHVsZXMvdGFzay1lZGl0LWRvbS5qcyIsIndlYnBhY2s6Ly90by1kby1saXN0Ly4vc3JjL2pzLW1vZHVsZXMvcHJvamVjdHMtY29udHJvbC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBjcmVhdGUgYXJyYXkgZm9yIHByb2dyYW0gdG8gcnVuIG9mZlxubGV0IHByb2plY3RUaXRsZXMgPSBbXVxuXG4vLyBjaGVjayBpZiB0aGVyZSBpcyBhbnkgbG9jYWxzdG9yYWdlLCBpZiBub3QgY3JlYXRlIG5ldyBhcnJheSBpbiBsb2NhbHN0b3JhZ2VcbmlmICghbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3Byb2plY3RUaXRsZXMnKSkge1xuICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdwcm9qZWN0VGl0bGVzJywgW10pXG4gIH0gZWxzZSB7XG4gICAgLy8gbG9hZCBsb2NhbFN0b3JhZ2UgZGF0YSBpbnRvIG1lbW9yeVxuICAgIHByb2plY3RUaXRsZXMgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgncHJvamVjdFRpdGxlcycpLnNwbGl0KCcsJylcbiAgfVxuXG5mdW5jdGlvbiBhZGRUaXRsZSh0aXRsZSkge1xuICAgIHByb2plY3RUaXRsZXMucHVzaCh0aXRsZSlcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgncHJvamVjdFRpdGxlcycsIHByb2plY3RUaXRsZXMpXG59XG5cbmZ1bmN0aW9uIGdldFRpdGxlcygpIHtcbiAgICByZXR1cm4gcHJvamVjdFRpdGxlcztcbn1cblxuZnVuY3Rpb24gZGVsZXRlVGl0bGUodGl0bGUpIHtcbiAgICBjb25zdCBpbmRleCA9IHByb2plY3RUaXRsZXMuaW5kZXhPZih0aXRsZSk7XG4gICAgaWYgKGluZGV4ID4gLTEpIHsgLy8gb25seSBzcGxpY2UgYXJyYXkgd2hlbiBpdGVtIGlzIGZvdW5kXG4gICAgICAgIHByb2plY3RUaXRsZXMuc3BsaWNlKGluZGV4LCAxKTsgLy8gMm5kIHBhcmFtZXRlciBtZWFucyByZW1vdmUgb25lIGl0ZW0gb25seVxuICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgncHJvamVjdFRpdGxlcycsIHByb2plY3RUaXRsZXMpXG4gICAgfVxufVxuXG5leHBvcnQge2FkZFRpdGxlLCBnZXRUaXRsZXMsIGRlbGV0ZVRpdGxlfTtcbiIsIi8vIGZhY3RvcnkgZnVuY3Rpb24gdXNlZCB0byBjb25zdHJ1Y3QgdGFzayBvYmplY3RcbmV4cG9ydCBjb25zdCB0YXNrID0gKHRpdGxlLCBkYXRlLCBkZXNjcmlwdGlvbiwgcHJpb3JpdHksIHByb2plY3QpID0+IHtcbiAgICBsZXQgb2JqID0gT2JqZWN0LmNyZWF0ZSh0YXNrUHJvdG8pXG4gICAgb2JqLnRpdGxlID0gdGl0bGVcbiAgICBvYmouZGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvblxuICAgIG9iai5kYXRlID0gZGF0ZVxuICAgIG9iai5wcmlvcml0eSA9IHByaW9yaXR5XG4gICAgLy8gdmFyaWFibGUgdXNlZCB0byBkZXRlcm1pbmUgd2hhdCBwcm9qZWN0IHRoZSB0YXNrIGlzIGluXG4gICAgb2JqLnByb2plY3QgPSBwcm9qZWN0XG4gICAgcmV0dXJuIG9ialxufVxuXG4vL0dyZWF0IHByb3RvdHlwZSBmb3IgdGFzaygpIHRvIHN0b3JlIGFsbCB0aGUgbWV0aG9kcyBmb3IgcHJvZ3JhbSB0byBydW4gZmFzdGVyXG5jb25zdCB0YXNrUHJvdG8gPSB7XG4gICAgLy8gY3JlYXRlIGFsbCBnZXR0ZXJzIGFuZCBzZXR0ZXJzIChvbmx5IGZvciBtZW1vcnkgdXNlKVxuICAgIGdldFRpdGxlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy50aXRsZVxuICAgIH0sXG4gICAgc2V0VGl0bGUodGl0bGUpIHtcbiAgICAgICAgdGhpcy50aXRsZSA9IHRpdGxlXG4gICAgfSxcbiAgICBnZXREZXNjcmlwdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGVzY3JpcHRpb25cbiAgICB9LFxuICAgIHNldERlc2NyaXB0aW9uKGRlc2NyaXB0aW9uKSB7XG4gICAgICAgIHRoaXMuZGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvblxuICAgIH0sXG4gICAgZ2V0RGF0ZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGF0ZVxuICAgIH0sXG4gICAgc2V0RGF0ZShkYXRlKSB7XG4gICAgICAgIHRoaXMuZGF0ZSA9IGRhdGVcbiAgICB9LFxuICAgIGdldFByaW9yaXR5KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcmlvcml0eVxuICAgIH0sXG4gICAgc2V0UHJpb3JpdHkocHJpb3JpdHkpIHtcbiAgICAgICAgdGhpcy5wcmlvcml0eSA9IHByaW9yaXR5XG4gICAgfSxcbiAgICBnZXRQcm9qZWN0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcm9qZWN0XG4gICAgfSxcbiAgICBzZXRQcm9qZWN0KHByb2plY3QpIHtcbiAgICAgICAgdGhpcy5wcm9qZWN0ID0gcHJvamVjdFxuICAgIH1cbn1cblxuIiwiaW1wb3J0IHsgZGVsVGFzayB9IGZyb20gXCIuL3Rhc2stY29udHJvbC5qc1wiXG5cbi8vIGZ1bmN0aW9uIHRoYXQgcmV0dXJucyBhIHRhc2sgZm9yIHRoZSBET01cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGNyZWF0ZVRhc2sgKHRpdGxlLCBkYXRlKSB7XG4gICAgLy9jcmVhdGUgZGVmYXVsdCBkaXYgdG8gaG9sZCBhbGwgdGhlIGluZm9cbiAgICBjb25zdCB0YXNrRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcbiAgICB0YXNrRGl2LmNsYXNzTGlzdC5hZGQoJ3Rhc2snKVxuICAgIHRhc2tEaXYuY2xhc3NMaXN0LmFkZCgndGFzay1zcGFuJylcblxuICAgIC8vY3JlYXRlIHR3byBoYWx2ZXMgZm9yIHRoZSBkaXYgXG4gICAgY29uc3QgdGFza1N0YXJ0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcbiAgICBjb25zdCB0YXNrRW5kID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcbiAgICB0YXNrU3RhcnQuY2xhc3NMaXN0LmFkZCgndGFzay1zdGFydCcpXG4gICAgdGFza0VuZC5jbGFzc0xpc3QuYWRkKCd0YXNrLWVuZCcpXG5cbiAgICAvL2NyZWF0ZSBidXR0b24gdG8gY29tcGxldGUgdGFza1xuICAgIGNvbnN0IGNoZWNrQnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpXG4gICAgY2hlY2tCdXR0b24uY2xhc3NMaXN0LmFkZCgndGFzay1jaXJjbGUnKVxuICAgIGNoZWNrQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtkZWxUYXNrKGUpfSlcblxuICAgIC8vY3JlYXRlIGRpdiB0byBob2xkIHRpdGxlIG9mIHRhc2tcbiAgICBjb25zdCB0YXNrVGl0bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuICAgIHRhc2tUaXRsZS5jbGFzc0xpc3QuYWRkKCd0YXNrLXRpdGxlJylcbiAgICB0YXNrVGl0bGUudGV4dENvbnRlbnQgPSB0aXRsZVxuXG4gICAgLy9jcmVhdGUgZGl2IHRvIGhvbGQgdGhlIGRhdGVcbiAgICBjb25zdCB0YXNrRGF0ZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG4gICAgdGFza0RhdGUuY2xhc3NMaXN0LmFkZCgndGFzay1kYXRlJylcbiAgICB0YXNrRGF0ZS50ZXh0Q29udGVudCA9IGRhdGVcblxuICAgIC8vY3JlYXRlIHRoZSBlZGl0IGJ1dHRvbi9pbWdcbiAgICBjb25zdCBlZGl0QnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW1nJylcbiAgICBlZGl0QnV0dG9uLnNyYyA9ICdpbWFnZXMvZWRpdC5zdmcnXG4gICAgZWRpdEJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2FsdCcsICdlZGl0IGJ1dHRvbicpXG5cbiAgICAvLyBBcHBlbmQgYWxsIGVsZW1lbnRzIHRvZ2V0aGVyXG4gICAgdGFza0VuZC5hcHBlbmRDaGlsZCh0YXNrRGF0ZSlcbiAgICB0YXNrRW5kLmFwcGVuZENoaWxkKGVkaXRCdXR0b24pXG5cbiAgICB0YXNrU3RhcnQuYXBwZW5kQ2hpbGQoY2hlY2tCdXR0b24pXG4gICAgdGFza1N0YXJ0LmFwcGVuZENoaWxkKHRhc2tUaXRsZSlcblxuICAgIHRhc2tEaXYuYXBwZW5kQ2hpbGQodGFza1N0YXJ0KVxuICAgIHRhc2tEaXYuYXBwZW5kQ2hpbGQodGFza0VuZClcblxuICAgIHJldHVybiB0YXNrRGl2XG59IiwiaW1wb3J0IHsgdGFzayB9IGZyb20gJy4vdGFzay1vYmplY3QuanMnXG5pbXBvcnQgY3JlYXRlVGFzayBmcm9tICcuL3Rhc2stZG9tLmpzJ1xuaW1wb3J0IGNyZWF0ZVRhc2tFZGl0IGZyb20gJy4vdGFzay1lZGl0LWRvbS5qcydcbmltcG9ydCB7IG1lbnVTZWxlY3RlZCBhcyBtZW51U2VsZWN0ZWR9IGZyb20gJy4vcHJvamVjdHMtY29udHJvbC5qcydcblxuLy8gY3JlYXRlIGFuIGFycmF5IHRvIHN0b3JlIGFsbCB0aGUgdGFza3NcbmxldCBhbGxUYXNrcyA9IFtdXG5cbi8vYWRkIGV2ZW50IGxpc3RlbmVyIHRvICtBZGQgVGFzayBidXR0b25cbmNvbnN0IGFkZFRhc2sgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYWRkLXRhc2snKVxuYWRkVGFzay5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAvLyBOZWVkIHRvIHB1dCBhIHRhc2stZWRpdCBhYm92ZSArQWRkIFRhc2tcbiAgICBjb25zdCB0YXNrc0RpdiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyN0YXNrcycpXG4gICAgdGFza3NEaXYuaW5zZXJ0QmVmb3JlKGNyZWF0ZVRhc2tFZGl0KG51bGwsIG51bGwsIG51bGwsIDMpLCBhZGRUYXNrKVxufSlcblxuZXhwb3J0IGZ1bmN0aW9uIHJlbmRlclRhc2tzIChtZW51U2VsZWN0ZWQpIHtcbiAgICAvLyBmaXJzdCByZW1vdmUgdGhlIGN1cnJlbnQgdGFza3NcbiAgICByZW1vdmVUYXNrcygpXG5cbiAgICAvLyBjcmVhdGUgYSBuZXcgYXJyYXkgdGhhdCBob2xkcyBvbmx5IHRoZSByZXF1aXJlZCB0YXNrcyBmcm9tIHRoZSBwcm9qZWN0XG4gICAgY29uc3QgbmV3QXJyYXkgPSBhbGxUYXNrcy5maWx0ZXIoaXRlbSA9PiB7XG4gICAgICAgIGlmIChtZW51U2VsZWN0ZWQgPT0gXCJUb2RheVwiKSB7XG4gICAgICAgICAgICAvLyBUTyBET1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKG1lbnVTZWxlY3RlZCA9PSBcIkltcG9ydGFudFwiKSB7XG4gICAgICAgICAgICByZXR1cm4gaXRlbS5nZXRQcmlvcml0eSA9PSAxO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKG1lbnVTZWxlY3RlZCA9PSBcIkFsbFwiKSB7cmV0dXJuIHRydWV9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGl0ZW0uZ2V0UHJvamVjdCgpID09IG1lbnVTZWxlY3RlZDsgXG4gICAgICAgIH1cbiAgICB9KTtcbiAgICAvLyBTZWxlY3QgdGhlIGFkZCB0YXNrIFxuICAgIGNvbnN0IGFkZFRhc2sgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYWRkLXRhc2snKVxuICAgIC8vIHNlbGVjdCB0YXNrcyBkaXZcbiAgICBjb25zdCB0YXNrc0RpdiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyN0YXNrcycpXG4gICAgLy9sb29wIHRocm91Z2ggdGhlIG5ldyBhcnJheSBhbmQgcmVuZGVyIHRoZSB0YXNrc1xuICAgIG5ld0FycmF5LmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgICAgLy8gYWRkIG5ldyBlbGVtZW50cyBiZWZvcmUgKyBBZGQgVGFza1xuICAgICAgICBjb25zdCBlbGUgPSBjcmVhdGVUYXNrKGl0ZW0uZ2V0VGl0bGUoKSwgaXRlbS5nZXREYXRlKCkpXG4gICAgICAgIHRhc2tzRGl2Lmluc2VydEJlZm9yZShlbGUsIGFkZFRhc2spXG4gICAgfSlcbn1cblxuLy8gd2hlbiByZW5kZXJUYXNrcygpIGlzIGNhbGxlZCwgdXNlIHRoaXMgZnVuY3Rpb24gdG8gZGVsZXRlIHRoZSBjdXJyZW50IHRhc2tzXG5mdW5jdGlvbiByZW1vdmVUYXNrcyAoKSB7XG4gICAgLy8gY3JlYXRlIG5vZGUgbGlzdHMgb2YgYWxsIGN1cnJlbnQgdGFza3MgaW4gdGhlIERPTVxuICAgIGNvbnN0IGFsbFRhc2tzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnRhc2stc3BhbicpXG4gICAgLy8gcmVtb3ZlIGVhY2ggdGFza1xuICAgIGFsbFRhc2tzLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgICAgaXRlbS5yZW1vdmUoKVxuICAgIH0pO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gc2F2ZSAoZSkge1xuICAgIC8vIGdldCB0aGUgc3JjIGVsZW1lbnQgYW5kIHRoZW4gdGhlIGZvcm0gbm9kZVxuICAgIGNvbnN0IGJ1dHRvbiA9IGUuc3JjRWxlbWVudFxuICAgIGNvbnN0IGZvcm0gPSBidXR0b24uY2xvc2VzdCgnZm9ybScpXG4gICAgLy8gZ2F0aGVyIGFsbCByZXF1aXJlZCBpbmZvIHRvIGJ1aWxkIGEgbmV3IHRhc2sgb2JqZWN0XG4gICAgY29uc3QgdGl0bGUgPSBmb3JtLnF1ZXJ5U2VsZWN0b3IoJyN0aXRsZS1lZGl0JykudmFsdWVcbiAgICBjb25zdCBkYXRlID0gZm9ybS5xdWVyeVNlbGVjdG9yKCcjZGF0ZScpLnZhbHVlXG4gICAgY29uc3QgZGVzY3JpcHRpb24gPSBmb3JtLnF1ZXJ5U2VsZWN0b3IoJ3RleHRhcmVhJykudmFsdWVcbiAgICBjb25zdCBwcmlvcml0eSA9IGZvcm0ucXVlcnlTZWxlY3RvcignI3ByaW9yaXR5JykudmFsdWVcbiAgICBhbGxUYXNrcy5wdXNoKHRhc2sodGl0bGUsIGRhdGUsIGRlc2NyaXB0aW9uLCBwcmlvcml0eSwgbWVudVNlbGVjdGVkKSlcbiAgICAvLyByZW5kZXIgdGhlIG5ldyB0YXNrc1xuICAgIC8vIG90aGVyIHRhc2sgZm9ybSBvbiBwYWdlIHdpbGwgYmUgcmVtb3ZlZFxuICAgIHJlbmRlclRhc2tzKG1lbnVTZWxlY3RlZClcbiAgICAvLyByZW1vdmUgdGhlIGZvcm1cbiAgICBmb3JtLnBhcmVudEVsZW1lbnQucmVtb3ZlKClcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGRlbFRhc2soZSkge1xuICAgIC8vIGdldCB0aGUgcGFyZW50IGVsZW1lbnRcbiAgICBjb25zdCBwYXJlbnQgPSBlLnNyY0VsZW1lbnQucGFyZW50RWxlbWVudC5wYXJlbnRFbGVtZW50XG4gICAgLy8gZ2V0IHRoZSB0aXRsZSBhbmQgZGF0ZVxuICAgIGNvbnN0IHRpdGxlID0gcGFyZW50LnF1ZXJ5U2VsZWN0b3IoJy50YXNrLXRpdGxlJylcbiAgICBjb25zdCBkYXRlID0gcGFyZW50LnF1ZXJ5U2VsZWN0b3IoJy50YXNrLWRhdGUnKVxuICAgIC8vIHVzZSB0aGUgZnVuY3Rpb24gdG8gZmluZCB0aGUgaW5kZXggb2YgdGhlIGFycmF5IHdoZXJlIHRoZSB0YXNrIGlzIHNhdmVkXG4gICAgY29uc3QgaSA9IHRhc2tTZWFyY2godGl0bGUudGV4dENvbnRlbnQsIGRhdGUudGV4dENvbnRlbnQpXG4gICAgLy8gZGVsZXRlcyB0aGUgb2JqZWN0IGZyb20gdGhlIGFycmF5XG4gICAgYWxsVGFza3Muc3BsaWNlKGksIDEpXG4gICAgLy8gcmVtb3ZlIHRoZSBlbGVtZW50IGZyb20gdGhlIERPTVxuICAgIHBhcmVudC5yZW1vdmUoKVxufVxuXG4vLyB0aGlzIGZ1bmN0aW9uIHVzZXMgdGhlIHRpdGxlIGFuZCBkYXRlIG9mIGEgdGFzayB0byBmaW5kIGl0cyBcbi8vIGluZGV4IGluIHRoZSBhcnJheSBhbmQgcmV0dXJucyBpdFxuZnVuY3Rpb24gdGFza1NlYXJjaCAodGl0bGUsIGRhdGUpIHtcbiAgICAvLyBjcmVhdGUgYSBuZXcgYXJyYXkgdGhhdCBzdG9yZXMgYWxsIGluZGV4ZXMgd2l0aCBzYW1lIHRpdGxlXG4gICAgY29uc3QgZmlyc3RTb3J0ID0gW11cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGFsbFRhc2tzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmIChhbGxUYXNrc1tpXS5nZXRUaXRsZSgpID09PSB0aXRsZSkge1xuICAgICAgICAgICAgZmlyc3RTb3J0LnB1c2goaSlcbiAgICAgICAgfVxuICAgIH1cbiAgICAvLyByZXBlYXQgcHJvY2VzcyB0byBuYXJyb3cgZG93biBpbmRleGVzIGJhc2VkIG9mZiBvZiBkYXRlXG4gICAgY29uc3Qgc2Vjb25kU29ydCA9IFtdXG4gICAgLy8gaGF2ZSB0byBzb3J0IHRocm91Z2ggZmlyc3RTb3J0W10gdG8gZmluZCBhbGwgdGhlIGluZGV4ZXNcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGZpcnN0U29ydC5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAoYWxsVGFza3NbZmlyc3RTb3J0W2ldXS5nZXREYXRlKCkgPT0gZGF0ZSkge1xuICAgICAgICAgICAgLy8gYXBwZW5kIHRob3NlIGluZGV4ZXMgdG8gc2Vjb25kU29ydFtdXG4gICAgICAgICAgICBzZWNvbmRTb3J0LnB1c2goZmlyc3RTb3J0W2ldKVxuICAgICAgICB9XG4gICAgfVxuICAgIC8vIHVzaW5nIHNlY29uZFNvcnQgZmluZCB0aGUgdGFzayB3aXRoIGEgUHJvamVjdCB0aGF0IG1hdGNoZXMgbWVudSBzZWxlY3RlZFxuICAgIC8vIHJldHVybiB0aGUgaW5kZXhcbiAgICBpZiAobWVudVNlbGVjdGVkICE9ICdBbGwnKSB7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2Vjb25kU29ydC5sZW5ndGg7IGkrKyl7XG4gICAgICAgICAgICBpZiAoYWxsVGFza3Nbc2Vjb25kU29ydFswXV0uZ2V0UHJvamVjdCgpID09PSBtZW51U2VsZWN0ZWQpe1xuICAgICAgICAgICAgICAgIHJldHVybiBpXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgLy8gaWYgdGhlcmUgYXJlIG11bHRpcGxlcyBpbiAnQWxsJywgcmV0dXJuIHRoZSBpbmRleCB0byB0aGUgZmlyc3QgdGFza1xuICAgIGVsc2Uge1xuICAgICAgICByZXR1cm4gc2Vjb25kU29ydFswXVxuICAgIH1cblxufSIsImltcG9ydCB7IHNhdmUgfSBmcm9tICcuL3Rhc2stY29udHJvbC5qcydcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gY3JlYXRlVGFza0VkaXQgKHRpdGxlLCBkYXRlLCBkZXNjcmlwdGlvbiwgcHJpb3JpdHkpIHtcbiAgICAvL2NyZWF0ZSBkaXYgdG8gaG9sZCBhbGwgdGhlIGVsZW1lbnRzXG4gICAgY29uc3QgdGFza0Zvcm0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuICAgIHRhc2tGb3JtLmNsYXNzTGlzdC5hZGQoJ3Rhc2stc3BhbicpXG4gICAgdGFza0Zvcm0uY2xhc3NMaXN0LmFkZCgndGFzay1mb3JtJylcblxuICAgIC8vY3JlYXRlIHRoZSBmb3JtIFxuICAgIGNvbnN0IGZvcm0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdmb3JtJylcbiAgICBmb3JtLnNldEF0dHJpYnV0ZSgnYWN0aW9uJywgJycpXG4gICAgZm9ybS5zZXRBdHRyaWJ1dGUoJ21ldGhvZCcsICdwb3N0JylcblxuICAgIC8vc3RhcnQgYnkgY3JlYXRpbmcgZWxlbWVudHMgZm9yIHRoZSB0b3Agb2YgdGhlIGZvcm1cbiAgICAvL3RoZSB0aXRsZSBhbmQgZGF0ZSBhcmUgaW5sY3VkZWQgaGVyZVxuICAgIGNvbnN0IHRvcEVkaXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuICAgIHRvcEVkaXQuY2xhc3NMaXN0LmFkZCgndG9wLWZvcm0tdGFzaycpXG5cbiAgICAvL2lucHV0IGZvciB0aGUgdGl0bGVcbiAgICBjb25zdCBlZGl0VGl0bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpXG4gICAgZWRpdFRpdGxlLnNldEF0dHJpYnV0ZSgndHlwZScsICd0ZXh0JylcbiAgICBlZGl0VGl0bGUuc2V0QXR0cmlidXRlKCdpZCcsICd0aXRsZS1lZGl0JylcbiAgICBlZGl0VGl0bGUuc2V0QXR0cmlidXRlKCdwbGFjZWhvbGRlcicsICdUaXRsZScpXG4gICAgZWRpdFRpdGxlLnNldEF0dHJpYnV0ZSgnbmFtZScsICd0aXRsZS1lZGl0JylcbiAgICBlZGl0VGl0bGUuc2V0QXR0cmlidXRlKCdtYXhsZW5ndGgnLCAnMjAnKVxuICAgIGVkaXRUaXRsZS52YWx1ZSA9IHRpdGxlIC8vVE8gRE9cblxuICAgIC8vaW5wdXQgZm9yIHRoZSBkYXRlXG4gICAgY29uc3QgZGF0ZURpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG4gICAgY29uc3QgZGF0ZUxhYmVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGFiZWwnKVxuICAgIGRhdGVMYWJlbC50ZXh0Q29udGVudCA9ICdEYXRlOiAnXG4gICAgZGF0ZUxhYmVsLnNldEF0dHJpYnV0ZSgnZm9yJywgJ2RhdGUnKVxuICAgICBcbiAgICBjb25zdCBpbnB1dERhdGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpXG4gICAgaW5wdXREYXRlLnNldEF0dHJpYnV0ZSgndHlwZScsICdkYXRlJylcbiAgICBpbnB1dERhdGUuc2V0QXR0cmlidXRlKCdpZCcsICdkYXRlJylcbiAgICBpbnB1dERhdGUuc2V0QXR0cmlidXRlKCduYW1lJywgJ2RhdGUnKVxuICAgIGlucHV0RGF0ZS52YWx1ZSA9IGRhdGUgLy9UTyBET1xuXG4gICAgLy9hcHBlbmQgdGhlIHRvcCB0b2dldGhlciBhbmQgYWRkIGl0IHRvIHRoZSBmdWxsIGZvcm1cbiAgICBkYXRlRGl2LmFwcGVuZENoaWxkKGRhdGVMYWJlbClcbiAgICBkYXRlRGl2LmFwcGVuZENoaWxkKGlucHV0RGF0ZSlcblxuICAgIHRvcEVkaXQuYXBwZW5kQ2hpbGQoZWRpdFRpdGxlKVxuICAgIHRvcEVkaXQuYXBwZW5kQ2hpbGQoZGF0ZURpdilcblxuICAgIGZvcm0uYXBwZW5kQ2hpbGQodG9wRWRpdClcblxuICAgIC8vY3JlYXRlIHRoZSB0ZXh0YXJlYVxuICAgIGNvbnN0IHRleHRBcmVhRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcbiAgICB0ZXh0QXJlYURpdi5jbGFzc0xpc3QuYWRkKCd0ZXh0YXJlYS1kaXYnKVxuXG4gICAgY29uc3QgdGV4dEFyZWEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZXh0YXJlYScpXG4gICAgdGV4dEFyZWEuc2V0QXR0cmlidXRlKCdwbGFjZWhvbGRlcicsICdEZXNjcmlwdGlvbicpXG4gICAgdGV4dEFyZWEudmFsdWUgPSBkZXNjcmlwdGlvbiAvL1RPIERPIFxuXG4gICAgdGV4dEFyZWFEaXYuYXBwZW5kQ2hpbGQodGV4dEFyZWEpXG4gICAgZm9ybS5hcHBlbmRDaGlsZCh0ZXh0QXJlYURpdilcblxuICAgIC8vY3JlYXRlIHRoZSBib3R0b20gb2YgdGhlIGZvcm1cbiAgICBjb25zdCBsb3dlckRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG4gICAgbG93ZXJEaXYuY2xhc3NMaXN0LmFkZCgnbG93ZXItZm9ybS10YXNrJylcblxuICAgIGNvbnN0IGVuY29tcGFzRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcblxuICAgIGNvbnN0IHByaW9yaXR5TGFiZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsYWJlbCcpXG4gICAgcHJpb3JpdHlMYWJlbC50ZXh0Q29udGVudCA9ICdQcmlvcml0eTogJ1xuICAgIHByaW9yaXR5TGFiZWwuc2V0QXR0cmlidXRlKCdmb3InLCAncHJpb3JpdHknKVxuXG4gICAgY29uc3QgcHJpb3JpdHlTZWxlY3QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzZWxlY3QnKVxuICAgIHByaW9yaXR5U2VsZWN0LnNldEF0dHJpYnV0ZSgnbmFtZScsICdwcmlvcml0eScpXG4gICAgcHJpb3JpdHlTZWxlY3Quc2V0QXR0cmlidXRlKCdpZCcsICdwcmlvcml0eScpXG4gICAgcHJpb3JpdHlTZWxlY3QudmFsdWUgPSBwcmlvcml0eSAvL1RPIERPXG5cbiAgICAvL3VzZSBhIGxvb3AgdG8gYWRkIDMgb3B0aW9ucyB0byB0aGUgRE9NXG4gICAgZm9yIChsZXQgaSA9IDE7IGkgPD0gMzsgaSsrKSB7XG4gICAgICAgIC8vdXNlIGEgZnVuY3Rpb24gdG8gcmV0dXJuIHRoZSBET00gb3B0aW9uIGVsZW1lbnRcbiAgICAgICAgcHJpb3JpdHlTZWxlY3QuYXBwZW5kQ2hpbGQoY3JlYXRlT3B0aW9uKGkpKVxuICAgIH1cblxuICAgIC8vYXBwZW5kIHRoZSBwcmlvcml0eSBlbGVtZW50cyB0byB0aGUgZGl2XG4gICAgZW5jb21wYXNEaXYuYXBwZW5kQ2hpbGQocHJpb3JpdHlMYWJlbClcbiAgICBlbmNvbXBhc0Rpdi5hcHBlbmRDaGlsZChwcmlvcml0eVNlbGVjdClcblxuICAgIC8vIGNyZWF0ZSB0aGUgU2F2ZSBhbmQgRGVsZXRlIGJ1dHRvbnMgaW4gdGhlaXIgb3duIGRpdlxuICAgIGNvbnN0IGJ1dHRvbkRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG5cbiAgICBjb25zdCBkZWxCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKVxuICAgIGRlbEJ1dHRvbi50ZXh0Q29udGVudCA9ICdEZWwnXG4gICAgZGVsQnV0dG9uLnNldEF0dHJpYnV0ZSgndHlwZScsICdidXR0b24nKVxuXG4gICAgY29uc3Qgc2F2ZUJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpXG4gICAgc2F2ZUJ1dHRvbi50ZXh0Q29udGVudCA9ICdTYXZlJ1xuICAgIHNhdmVCdXR0b24uc2V0QXR0cmlidXRlKCd0eXBlJywgJ2J1dHRvbicpXG4gICAgc2F2ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7c2F2ZShlKX0pXG5cbiAgICBidXR0b25EaXYuYXBwZW5kQ2hpbGQoZGVsQnV0dG9uKVxuICAgIGJ1dHRvbkRpdi5hcHBlbmRDaGlsZChzYXZlQnV0dG9uKVxuXG4gICAgLy8gYXBwZW5kIHRoZSBsb3dlciBlbGVtZW50cyBcbiAgICBsb3dlckRpdi5hcHBlbmRDaGlsZChlbmNvbXBhc0RpdilcbiAgICBsb3dlckRpdi5hcHBlbmRDaGlsZChidXR0b25EaXYpXG4gICAgLy9hcHBlbmQgdGhlIGxvd2VyIGRpdiB0byB0aGUgZm9ybVxuICAgIGZvcm0uYXBwZW5kQ2hpbGQobG93ZXJEaXYpXG4gICAgLy9hcHBlbmQgZm9ybSB0byB0aGUgdGFzayBkaXZcbiAgICB0YXNrRm9ybS5hcHBlbmRDaGlsZChmb3JtKVxuXG4gICAgcmV0dXJuIHRhc2tGb3JtXG59XG5cbi8vIGNyZWF0ZXMgb3B0aW9ucyBmb3IgdGhlIHByaW9yaXR5IGVsZW1lbnRcbmZ1bmN0aW9uIGNyZWF0ZU9wdGlvbiAoaSkge1xuICAgIGNvbnN0IG9wdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ29wdGlvbicpXG4gICAgb3B0aW9uLnRleHRDb250ZW50ID0gaVxuICAgIG9wdGlvbi5zZXRBdHRyaWJ1dGUoJ3ZhbHVlJywgaSlcbiAgICByZXR1cm4gb3B0aW9uXG59XG5cbiIsImltcG9ydCB7IGFkZFRpdGxlLCBnZXRUaXRsZXMsIGRlbGV0ZVRpdGxlfSBmcm9tIFwiLi9wcm9qZWN0c1wiXG5pbXBvcnQgeyByZW5kZXJUYXNrcyB9IGZyb20gXCIuL3Rhc2stY29udHJvbC5qc1wiXG5cbi8vIHZhcmlhYmxlIHVzZWQgdG8ga2VlcCB0cmFjayBvZiB3aGljaCBtZW51IGl0ZW0gaXMgc2VsZWN0ZWRcbmV4cG9ydCBsZXQgbWVudVNlbGVjdGVkID0gJ0FsbCdcblxuLy9BZGQgZXZlbnRzIHRvIHRoZSBkZWZhdWx0IG1lbnUgb3B0aW9uc1xuY29uc3QgbWVudUl0ZW1zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLm1lbnUtaXRlbScpXG5tZW51SXRlbXMuZm9yRWFjaChhZGRNZW51SXRlbUV2ZW50KVxuXG4vLyBMb2FkIGxvY2FsU3RvcmFnZSBkYXRhIGludG8gdGhlIERPTVxuY29uc3QgbWVudVRpdGxlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9qZWN0cycpXG5jb25zdCBhcnJheSA9IGdldFRpdGxlcygpXG5mb3IgKGxldCBpID0gMDsgaSA8IGFycmF5Lmxlbmd0aDsgaSsrKSB7XG4gICAgbWVudVRpdGxlcy5hcHBlbmRDaGlsZChjcmVhdGVNZW51SXRlbShhcnJheVtpXSkpXG59XG5cbi8vIEV2ZW50IGxpc3RlbmVyIGZvciB0aGUgXCIrXCIgYnV0dG9uIGJlc2lkZSBwcm9qZWN0IHRpdGxlXG5jb25zdCBwbHVzQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2plY3QtdGl0bGUgPiBzdmcnKVxucGx1c0J1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAvL0NhbGxzIGZ1bmN0aW9uIHRvIGFkZCB0aGUgcHJvamVjdCBmb3JtIHRvIHRoZSBET01cbiAgICBjb25zdCBwcm9qZWN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2plY3RzJylcbiAgICBwcm9qZWN0LmFwcGVuZENoaWxkKGNyZWF0ZUZvcm0oKSlcblxufSlcblxuLy8gUmV0dXJucyB0aGUgRE9NIGVsZW1lbnQgb2YgYSBtZW51LWl0ZW0gXG4vLyBhIHNpbXBsZSBwcm9qZWN0IGlzIGFkZGVkIHRvIHRoZSBsaXN0IG9uIHRoZSBET01cbmZ1bmN0aW9uIGNyZWF0ZU1lbnVJdGVtKHRpdGxlKSB7XG4gICAgLy8gIGNyZWF0ZSB0aGUgbWVudS1pdGVtIGRpdiB0byBob2xkIHRoZSBlbGVtZW50c1xuICAgIGNvbnN0IGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG4gICAgZGl2LmNsYXNzTGlzdC5hZGQoJ21lbnUtaXRlbScpXG4gICAgLy8gY3JlYXRlIHRoZSB0aXRsZSBkaXZcbiAgICBjb25zdCB0aXRsZURpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG4gICAgdGl0bGVEaXYudGV4dENvbnRlbnQgPSB0aXRsZVxuICAgIC8vIGNyZWF0ZSB0aGUgdHJhc2ggYmluIGltZ1xuICAgIGNvbnN0IHRyYXNoID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW1nJylcbiAgICB0cmFzaC5zZXRBdHRyaWJ1dGUoJ3NyYycsICcuL2ltYWdlcy90cmFzaC0yLnN2ZycpXG4gICAgdHJhc2guc2V0QXR0cmlidXRlKCdhbHQnLCAndHJhc2ggaWNvbicpXG5cbiAgICAvLyBhZGQgZXZlbnRsaXN0ZW5lciB0byB0cmFzaCBpY29uXG4gICAgdHJhc2guYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xuICAgICAgICBkZWxldGVUaXRsZShlLnNyY0VsZW1lbnQucHJldmlvdXNFbGVtZW50U2libGluZy50ZXh0Q29udGVudClcbiAgICAgICAgZS5zcmNFbGVtZW50LmNsb3Nlc3QoJy5tZW51LWl0ZW0nKS5yZW1vdmUoKVxuICAgIH0pXG5cbiAgICAvLyBhcHBlbmQgdGhlIHR3byBjaGlsZHJlblxuICAgIGRpdi5hcHBlbmRDaGlsZCh0aXRsZURpdilcbiAgICBkaXYuYXBwZW5kQ2hpbGQodHJhc2gpXG5cbiAgICBhZGRNZW51SXRlbUV2ZW50KGRpdilcbiAgICBcbiAgICByZXR1cm4gZGl2XG59XG5cbi8vIHJldHVybnMgYSBmb3JtIGZvciBET00gdG8gYmUgdXNlZCB0byBjcmVhdGUgYSBuZXcgcHJvamVjdFxuZnVuY3Rpb24gY3JlYXRlRm9ybSgpIHtcbiAgICAvLyBjcmVhdGUgdGhlIGRpdiB0aGF0IGVuY29tcGFzc2VzIHRoZSBlbnRpcmUgYmxvY2tcbiAgICBjb25zdCBtZW51Rm9ybSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG4gICAgbWVudUZvcm0uY2xhc3NMaXN0LmFkZCgnbWVudS1mb3JtJylcblxuICAgIC8vIGNyZWF0ZSB0aGUgZm9ybSBhbmQgYWRkIGF0dHJpYnV0ZXNcbiAgICBjb25zdCBmb3JtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZm9ybScpXG4gICAgZm9ybS5zZXRBdHRyaWJ1dGUoJ2FjdGlvbicsIFwiXCIpXG4gICAgZm9ybS5zZXRBdHRyaWJ1dGUoJ21ldGhvZCcsICdwb3N0JylcblxuICAgIC8vIGNyZWF0ZSB0aGUgaW5wdXQgYm94IGZvciB0ZXh0XG4gICAgY29uc3QgaW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpXG4gICAgaW5wdXQuc2V0QXR0cmlidXRlKCd0eXBlJywgJ3RleHQnKVxuICAgIGlucHV0LnNldEF0dHJpYnV0ZSgnaWQnLCAncHJvamVjdC10aXRsZScpXG4gICAgaW5wdXQuc2V0QXR0cmlidXRlKCduYW1lJywgJ3Byb2plY3RUaXRsZScpXG4gICAgaW5wdXQuc2V0QXR0cmlidXRlKCdtYXhsZW5ndGgnLCAnMTUnKVxuXG4gICAgLy8gY3JlYXRlIGRpdiB0byBlbmNvbXBhc3MgYnV0dG9uc1xuICAgIGNvbnN0IHByb2plY3RCdXR0b25zID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcbiAgICBwcm9qZWN0QnV0dG9ucy5jbGFzc0xpc3QuYWRkKCdwcm9qZWN0LWJ1dHRvbnMnKVxuXG4gICAgLy9jcmVhdGUgdGhlIGJ1dHRvbnNcbiAgICBjb25zdCBhZGRCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKVxuICAgIGFkZEJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdhZGQtYnV0dG9uJylcbiAgICBhZGRCdXR0b24uc2V0QXR0cmlidXRlKCd0eXBlJywgJ2J1dHRvbicpXG4gICAgYWRkQnV0dG9uLnRleHRDb250ZW50ID0gXCJBZGRcIlxuXG4gICAgY29uc3QgY2FuY2VsQnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJylcbiAgICBjYW5jZWxCdXR0b24uY2xhc3NMaXN0LmFkZCgnY2FuY2VsLWJ1dHRvbicpXG4gICAgY2FuY2VsQnV0dG9uLnNldEF0dHJpYnV0ZSgndHlwZScsICdidXR0b24nKVxuICAgIGNhbmNlbEJ1dHRvbi50ZXh0Q29udGVudCA9IFwiQ2FuY2VsXCJcblxuICAgIC8vIGFkZCBldmVudGxpc3RlbmVyc1xuICAgIGFkZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XG4gICAgICAgIHNhdmUoZSlcbiAgICB9KVxuICAgIGNhbmNlbEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XG4gICAgICAgIGNhbmNlbChlKVxuICAgIH0pXG5cbiAgICAvLyBBcHBlbmQgdGhlIGJ1dHRvbnMgdG8gcHJvamVjdEJ1dHRvbnNcbiAgICBwcm9qZWN0QnV0dG9ucy5hcHBlbmRDaGlsZChhZGRCdXR0b24pXG4gICAgcHJvamVjdEJ1dHRvbnMuYXBwZW5kQ2hpbGQoY2FuY2VsQnV0dG9uKVxuXG4gICAgLy8gQXBwZW5kIGlucHV0IHRvIGZvcm0gdGhlbiBwcm9qZWN0QnV0dG9ucyB0byBmb3JtXG4gICAgZm9ybS5hcHBlbmRDaGlsZChpbnB1dClcbiAgICBmb3JtLmFwcGVuZENoaWxkKHByb2plY3RCdXR0b25zKVxuXG4gICAgLy8gYXBwZW5kIGZvcm0gdG8gdGhlIG1haW4gZGl2IChtZW51Rm9ybSlcbiAgICBtZW51Rm9ybS5hcHBlbmRDaGlsZChmb3JtKVxuXG4gICAgcmV0dXJuIG1lbnVGb3JtXG59XG5cbmZ1bmN0aW9uIHNhdmUoZSkge1xuICAgIC8vIHNlbGVjdCB0aGUgbWVudS1mb3JtIHBhcmVudCBub2RlXG4gICAgY29uc3QgbWVudUZvcm0gPSBlLnNyY0VsZW1lbnQuY2xvc2VzdCgnLm1lbnUtZm9ybScpXG4gICAgLy8gc2VsZWN0IHRoZSBjaGlsZCBvZiBtZW51LWZvcm0gYW5kIHRoZSBjaGlsZCBvZiB0aGF0IHRvIGFxdWlyZSB0aGUgaW5wdXQgbm9kZS5cbiAgICAvLyBUYWtlIHRoZSB2YWx1ZSBvZiB0aGUgaW5wdXQgbm9kZVxuICAgIGNvbnN0IGlucHV0VGV4dCA9IG1lbnVGb3JtLmZpcnN0Q2hpbGQuZmlyc3RDaGlsZC52YWx1ZVxuICAgIC8vIGluc2VydCBhIG5ldyBtZW51IGl0ZW0gYWZ0ZXIgdGhlIGZvcm1cbiAgICBtZW51Rm9ybS5pbnNlcnRBZGphY2VudEVsZW1lbnQoJ2FmdGVyZW5kJywgY3JlYXRlTWVudUl0ZW0oaW5wdXRUZXh0KSlcbiAgICAvLyBhZGQgdGhlIHRpdGxlIHRvIHRoZSBhcnJheSBcbiAgICBhZGRUaXRsZShpbnB1dFRleHQpXG5cbiAgICAvLyB3aGVuIGV2ZXJ5dGhpbmcgaXMgZG9uZSwgZGVsZXRlIHRoZSBmb3JtXG4gICAgY2FuY2VsKGUpXG59XG5cbi8vIGZ1bmN0aW9uIHVzZWQgdG8gZGVsZXRlIG1lbnUtZm9ybVxuZnVuY3Rpb24gY2FuY2VsKGUpIHtcbiAgICAvLyBmaW5kIHRoZSBjbG9zZXN0IG1lbnUgZm9ybSBhbmQgcmVtb3ZlIGl0XG4gICAgZS5zcmNFbGVtZW50LmNsb3Nlc3QoJy5tZW51LWZvcm0nKS5yZW1vdmUoKVxufVxuXG4vLyBhZGQgZXZlbnQgbGlzdGVuZXIgZm9yIGEgbWVudS1pdGVtXG5mdW5jdGlvbiBhZGRNZW51SXRlbUV2ZW50IChpdGVtKSB7XG4gICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XG4gICAgICAgIC8vIHJlbW92ZXMgdGhlIGNsYXNzIHRoYXQgaXMgaGlnaGxpZ2h0aW5nIHRoZSBjdXJyZW50bHkgc2VsZWN0ZWQgaXRlbVxuICAgICAgICBjb25zdCBjdXJyZW50U2VsZWN0ZWQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubWVudS1zZWxlY3RlZCcpXG4gICAgICAgIC8vIG1ha2Ugc3VyZSBjdXJyZW50U2VsZWN0ZWQgaXNuJ3QgbnVsbCB0byBwcmV2ZW50IGFuIGVycm9yXG4gICAgICAgIC8vIGN1cnJlbnRTZWxlY3RlZCB3aWxsIGJlIG51bGwgd2hlbiB0aGUgdHJhc2ggaWNvbiBpcyBjbGlja2VkIHRvIGRlbGV0ZVxuICAgICAgICBpZiAoY3VycmVudFNlbGVjdGVkICE9IG51bGwpe1xuICAgICAgICAgICAgY3VycmVudFNlbGVjdGVkLmNsYXNzTGlzdC5yZW1vdmUoJ21lbnUtc2VsZWN0ZWQnKVxuICAgICAgICB9XG4gICAgICAgIC8vYWRkIHRoZSBtZW51LXNlbGVjdGVkIGNsYXNzIHRvIHRoZSBpdGVtIHRoYXQgd2FzIHNlbGVjdGVkXG4gICAgICAgIGUuc3JjRWxlbWVudC5jbGFzc0xpc3QuYWRkKCdtZW51LXNlbGVjdGVkJylcbiAgICAgICAgLy8gY2FsbCBmdW5jdGlvbiB0byByZW5kZXIgdGhlIHRhc2tzXG4gICAgICAgIG1lbnVTZWxlY3RlZCA9IGUuc3JjRWxlbWVudC5maXJzdENoaWxkLnRleHRDb250ZW50XG4gICAgICAgIHJlbmRlclRhc2tzKG1lbnVTZWxlY3RlZClcbiAgICB9KVxufVxuIl0sIm5hbWVzIjpbInByb2plY3RUaXRsZXMiLCJsb2NhbFN0b3JhZ2UiLCJnZXRJdGVtIiwic3BsaXQiLCJzZXRJdGVtIiwidGFza1Byb3RvIiwiZ2V0VGl0bGUiLCJ0aGlzIiwidGl0bGUiLCJzZXRUaXRsZSIsImdldERlc2NyaXB0aW9uIiwiZGVzY3JpcHRpb24iLCJzZXREZXNjcmlwdGlvbiIsImdldERhdGUiLCJkYXRlIiwic2V0RGF0ZSIsImdldFByaW9yaXR5IiwicHJpb3JpdHkiLCJzZXRQcmlvcml0eSIsImdldFByb2plY3QiLCJwcm9qZWN0Iiwic2V0UHJvamVjdCIsImNyZWF0ZVRhc2siLCJ0YXNrRGl2IiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50IiwiY2xhc3NMaXN0IiwiYWRkIiwidGFza1N0YXJ0IiwidGFza0VuZCIsImNoZWNrQnV0dG9uIiwiYWRkRXZlbnRMaXN0ZW5lciIsImUiLCJwYXJlbnQiLCJzcmNFbGVtZW50IiwicGFyZW50RWxlbWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJpIiwiZmlyc3RTb3J0IiwiYWxsVGFza3MiLCJsZW5ndGgiLCJwdXNoIiwic2Vjb25kU29ydCIsIm1lbnVTZWxlY3RlZCIsInRhc2tTZWFyY2giLCJ0ZXh0Q29udGVudCIsInNwbGljZSIsInJlbW92ZSIsImRlbFRhc2siLCJ0YXNrVGl0bGUiLCJ0YXNrRGF0ZSIsImVkaXRCdXR0b24iLCJzcmMiLCJzZXRBdHRyaWJ1dGUiLCJhcHBlbmRDaGlsZCIsImNyZWF0ZU9wdGlvbiIsIm9wdGlvbiIsImFkZFRhc2siLCJyZW5kZXJUYXNrcyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwiaXRlbSIsIm5ld0FycmF5IiwiZmlsdGVyIiwidGFza3NEaXYiLCJlbGUiLCJpbnNlcnRCZWZvcmUiLCJ0YXNrRm9ybSIsImZvcm0iLCJ0b3BFZGl0IiwiZWRpdFRpdGxlIiwidmFsdWUiLCJkYXRlRGl2IiwiZGF0ZUxhYmVsIiwiaW5wdXREYXRlIiwidGV4dEFyZWFEaXYiLCJ0ZXh0QXJlYSIsImxvd2VyRGl2IiwiZW5jb21wYXNEaXYiLCJwcmlvcml0eUxhYmVsIiwicHJpb3JpdHlTZWxlY3QiLCJidXR0b25EaXYiLCJkZWxCdXR0b24iLCJzYXZlQnV0dG9uIiwiY2xvc2VzdCIsIm9iaiIsIk9iamVjdCIsImNyZWF0ZSIsInRhc2siLCJzYXZlIiwiY3JlYXRlVGFza0VkaXQiLCJhZGRNZW51SXRlbUV2ZW50IiwibWVudVRpdGxlcyIsImFycmF5IiwiY3JlYXRlTWVudUl0ZW0iLCJkaXYiLCJ0aXRsZURpdiIsInRyYXNoIiwiaW5kZXgiLCJpbmRleE9mIiwiZGVsZXRlVGl0bGUiLCJwcmV2aW91c0VsZW1lbnRTaWJsaW5nIiwiY2FuY2VsIiwiY3VycmVudFNlbGVjdGVkIiwiZmlyc3RDaGlsZCIsIm1lbnVGb3JtIiwiaW5wdXQiLCJwcm9qZWN0QnV0dG9ucyIsImFkZEJ1dHRvbiIsImNhbmNlbEJ1dHRvbiIsImlucHV0VGV4dCIsImluc2VydEFkamFjZW50RWxlbWVudCIsImNyZWF0ZUZvcm0iXSwic291cmNlUm9vdCI6IiJ9